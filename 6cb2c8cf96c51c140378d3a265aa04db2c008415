{
  "version": 2,
  "session": {
    "session_id": "89548f1b-1703-4900-9fb1-e72fa0087ca5",
    "model": {
      "id": "claude-opus-4-5-20251101",
      "provider": "anthropic"
    },
    "started_at": "2026-02-01T01:19:16.668802+00:00",
    "prompt_count": 60
  },
  "prompts": [
    {
      "index": 0,
      "text": "\"Enter plan mode and put together a list of the highest priority enhancements that can be made to this package to increase its utility, accuracy, robustness, privacy, usefulness, sophistication, and overall polish without introducing scope creep or confusing the product or itended use\"",
      "timestamp": "2026-02-01T01:19:16.669630+00:00",
      "affected_files": [
        "/Users/gregking/.claude/plans/velvet-baking-cloud.md"
      ]
    },
    {
      "index": 1,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:22:53.295744+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 2,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:22:58.254423+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 3,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:02.670865+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 4,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:07.170662+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    },
    {
      "index": 5,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:14.243250+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    },
    {
      "index": 6,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:21.921285+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 7,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:35.948331+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 8,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:39.949251+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 9,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:45.296326+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 10,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:23:51.393975+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 11,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:24:00.144480+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 12,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:24:08.909347+00:00",
      "affected_files": [
        "Cargo.toml"
      ]
    },
    {
      "index": 13,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:24:13.007830+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 14,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:24:41.686488+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    },
    {
      "index": 15,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:24:45.364273+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    },
    {
      "index": 16,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:25:16.922075+00:00",
      "affected_files": [
        "src/capture/hook.rs"
      ]
    },
    {
      "index": 17,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:25:26.140621+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 18,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:25:39.134609+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 19,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:25:44.152229+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 20,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:25:56.234782+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 21,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:01.312140+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 22,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:08.442138+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 23,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:19.332207+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 24,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:27.655351+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 25,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:32.510352+00:00",
      "affected_files": [
        "src/cli/setup.rs"
      ]
    },
    {
      "index": 26,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:39.175159+00:00",
      "affected_files": [
        "src/cli/audit.rs"
      ]
    },
    {
      "index": 27,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:26:45.094161+00:00",
      "affected_files": [
        "src/cli/export.rs"
      ]
    },
    {
      "index": 28,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:27:27.697698+00:00",
      "affected_files": [
        "src/cli/mod.rs"
      ]
    },
    {
      "index": 29,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:27:38.641254+00:00",
      "affected_files": [
        "src/cli/mod.rs"
      ]
    },
    {
      "index": 30,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:28:00.273673+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 31,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:28:07.083122+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 32,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:28:13.062453+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 33,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:28:30.544879+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 34,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:28:42.343639+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 35,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:29:01.605314+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 36,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:29:07.957375+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 37,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:29:32.502067+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 38,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:29:38.942253+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 39,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:29:49.003056+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 40,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:30:05.340752+00:00",
      "affected_files": [
        "src/privacy/redaction.rs"
      ]
    },
    {
      "index": 41,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:30:43.831402+00:00",
      "affected_files": [
        "src/privacy/config.rs"
      ]
    },
    {
      "index": 42,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:30:51.397845+00:00",
      "affected_files": [
        "src/privacy/config.rs"
      ]
    },
    {
      "index": 43,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:07.626507+00:00",
      "affected_files": [
        "src/privacy/config.rs"
      ]
    },
    {
      "index": 44,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:25.969922+00:00",
      "affected_files": [
        "src/privacy/config.rs"
      ]
    },
    {
      "index": 45,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:31.904594+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 46,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:38.342440+00:00",
      "affected_files": [
        "src/capture/pending.rs"
      ]
    },
    {
      "index": 47,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:43.963710+00:00",
      "affected_files": [
        "src/capture/threeway.rs"
      ]
    },
    {
      "index": 48,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:49.502249+00:00",
      "affected_files": [
        "src/capture/threeway.rs"
      ]
    },
    {
      "index": 49,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:31:57.656155+00:00",
      "affected_files": [
        "src/privacy/mod.rs"
      ]
    },
    {
      "index": 50,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:32:19.572049+00:00",
      "affected_files": [
        "src/cli/export.rs"
      ]
    },
    {
      "index": 51,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:32:31.688658+00:00",
      "affected_files": [
        "src/capture/hook.rs"
      ]
    },
    {
      "index": 52,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:33:05.443725+00:00",
      "affected_files": [
        "src/cli/blame.rs"
      ]
    },
    {
      "index": 53,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:33:12.417002+00:00",
      "affected_files": [
        "src/cli/show.rs"
      ]
    },
    {
      "index": 54,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:33:17.488340+00:00",
      "affected_files": [
        "src/cli/export.rs"
      ]
    },
    {
      "index": 55,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:33:21.848464+00:00",
      "affected_files": [
        "src/cli/export.rs"
      ]
    },
    {
      "index": 56,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:33:44.122880+00:00",
      "affected_files": [
        "src/cli/blame.rs"
      ]
    },
    {
      "index": 57,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:34:02.594934+00:00",
      "affected_files": [
        "src/cli/blame.rs"
      ]
    },
    {
      "index": 58,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:34:31.831054+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    },
    {
      "index": 59,
      "text": "\"Implement the following plan:\\n\\n# whogitit Enhancement Plan\\n\\n## Purpose\\nPrioritized enhancements to increase utility, accuracy, robustness, privacy, and polish without scope creep.\\n\\n---\\n\\n## Priority 1: Critical Security & Data Integrity\\n\\n### 1.1 File Permission Hardening\\n**Files:** `src/capture/pending.rs`, `src/storage/audit.rs`\\n\\n- Set `.whogitit-pending.json` to mode `0600` after creation (line 449)\\n- Set audit log to mode `0600` after creation (line 104)\\n- Set backup files to mode `0600` (line 499)\\n\\n**Why:** Pending buffer contains full file snapshots and prompts. Currently uses default umask (likely 0644), exposing sensitive data.\\n\\n### 1.2 Concurrent Access Protection\\n**Files:** `src/capture/pending.rs`\\n\\n- Add advisory file locking (flock/fcntl) around pending buffer read/write\\n- Detect concurrent modification and warn or merge\\n\\n**Why:** Two Claude Code sessions in same repo will corrupt pending buffer. One session's edits get lost.\\n\\n### 1.3 User Identity Validation\\n**File:** `src/storage/audit.rs:220`\\n\\n- Replace `std::env::var(\\\"USER\\\")` with validated identity (check against getuid on Unix)\\n- Log warning if env var doesn't match system identity\\n\\n**Why:** `USER` env var is trivially spoofable, allowing false audit trails.\\n\\n---\\n\\n## Priority 2: Robustness & Error Handling\\n\\n### 2.1 Silent Failure Elimination\\n**Files:** `src/capture/hook.rs`, `src/capture/pending.rs`\\n\\n- Replace `.ok()?` chains in `get_content_from_git_head()` (line 175-182) with explicit error logging\\n- Change corrupted pending buffer handling from `Ok(None)` to logged warning + backup creation (line 407-413)\\n\\n**Why:** Users currently have no indication when hooks fail to capture content or when data is silently discarded.\\n\\n### 2.2 Unsafe Unwrap Removal\\n**Files:** `src/cli/setup.rs:24`, `src/cli/audit.rs:55`, `src/cli/export.rs:188`, `src/cli/retention.rs` (6 instances)\\n\\n- Replace `.expect(\\\"Could not determine home directory\\\")` with graceful erro",
      "timestamp": "2026-02-01T01:34:51.383459+00:00",
      "affected_files": [
        "src/storage/audit.rs"
      ]
    }
  ],
  "files": [
    {
      "path": "src/cli/export.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "//! Export command for bulk attribution data export",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use chrono::{DateTime, Utc};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use serde::Serialize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use std::io::Write;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "use crate::core::attribution::AIAttribution;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "use crate::storage::notes::NotesStore;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "/// Arguments for export command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "#[derive(Debug, clap::Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "pub struct ExportArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "    /// Output format (json or csv)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "    #[arg(long, value_parser = [\"json\", \"csv\"], default_value = \"json\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "    pub format: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "    /// Only include commits after this date (YYYY-MM-DD)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "    pub since: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "    /// Only include commits before this date (YYYY-MM-DD)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    pub until: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "    /// Output file (default: stdout)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    #[arg(short, long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    pub output: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    /// Include full prompt text (default: truncated)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "    pub full_prompts: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    /// Maximum prompt length when not using --full-prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "    #[arg(long, default_value = \"100\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "    pub prompt_max_len: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "/// Export format for JSON output",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "#[derive(Debug, Serialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "pub struct ExportData {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    /// Export schema version",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    pub export_version: u8,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "    /// When the export was created",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "    pub exported_at: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    /// Date range filter (if specified)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "    pub date_range: Option<DateRange>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "    /// Exported commits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    pub commits: Vec<CommitExport>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "    /// Summary statistics",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    pub summary: ExportSummary,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "/// Date range filter",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "#[derive(Debug, Serialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "pub struct DateRange {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    pub since: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    pub until: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "/// Exported commit data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "#[derive(Debug, Serialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "pub struct CommitExport {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    /// Git commit SHA",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "    pub commit_id: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "    /// Short commit SHA (7 chars)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    pub commit_short: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    /// Commit message (first line)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "    pub message: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    /// Commit author",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    pub author: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    /// Commit timestamp",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    pub committed_at: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "    /// AI session ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    pub session_id: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "    /// Model used",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    pub model: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    /// Total AI-generated lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    pub ai_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    /// AI lines modified by human",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    pub ai_modified_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    /// Human-written lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    pub human_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    /// Original lines (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    pub original_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    /// Files affected",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "    pub files: Vec<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "    /// Prompts used",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "    pub prompts: Vec<PromptExport>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "/// Exported prompt data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "#[derive(Debug, Serialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "pub struct PromptExport {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "    pub index: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "    pub text: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "    pub affected_files: Vec<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "/// Export summary statistics",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "#[derive(Debug, Serialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "pub struct ExportSummary {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    pub total_commits: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    pub commits_with_ai: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "    pub total_ai_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "    pub total_ai_modified_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "    pub total_human_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "    pub total_original_lines: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "    pub total_prompts: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "/// Run the export command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "pub fn run(args: ExportArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "    let repo = git2::Repository::discover(\".\").context(",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "        \"Not in a git repository. \\",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "         Run 'git init' to create one, or 'cd' to a directory containing a .git folder.\",",
          "source": {
            "type": "AIModified",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
            "similarity": 0.9875
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 0.9875
        },
        {
          "line_number": 117,
          "content": "    )?;",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "    let notes_store = NotesStore::new(&repo)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "    // Parse date filters",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "    let since = parse_date(&args.since)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "    let until = parse_date(&args.until)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "    // Validate date range",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "    if let (Some(ref since_date), Some(ref until_date)) = (&since, &until) {",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        if since_date > until_date {",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "            anyhow::bail!(",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "                \"Invalid date range: --since ({}) must be before --until ({})\",",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "                args.since.as_ref().unwrap(),",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "                args.until.as_ref().unwrap()",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "            );",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "    // Get all commits with attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "    let attributed_commits = notes_store.list_attributed_commits()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "    // Collect export data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "    let mut commits: Vec<CommitExport> = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "    for commit_oid in attributed_commits {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "        let commit = repo.find_commit(commit_oid)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "        let commit_time =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "            DateTime::from_timestamp(commit.time().seconds(), 0).unwrap_or(DateTime::UNIX_EPOCH);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "        // Apply date filters",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "        if let Some(ref since_date) = since {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "            if commit_time < *since_date {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "        if let Some(ref until_date) = until {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "            if commit_time > *until_date {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "        // Get attribution data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        if let Some(attribution) = notes_store.fetch_attribution(commit_oid)? {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "            let export = build_commit_export(&commit, &attribution, &args)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "            commits.push(export);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "    // Sort by commit time (newest first)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "    commits.sort_by(|a, b| b.committed_at.cmp(&a.committed_at));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "    // Build summary",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "    let summary = build_summary(&commits);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "    // Write output",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "    let output_data = ExportData {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        export_version: 1,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "        exported_at: Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "        date_range: if args.since.is_some() || args.until.is_some() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "            Some(DateRange {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "                since: args.since.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "                until: args.until.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "            None",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "        commits,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "        summary,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "    match args.format.as_str() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "        \"json\" => write_json(&output_data, &args.output)?,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "        \"csv\" => write_csv(&output_data, &args.output)?,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "        other => anyhow::bail!(",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "            \"Unsupported format: '{}'. Supported formats: json, csv\",",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "            other",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "        ),",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "fn parse_date(date_str: &Option<String>) -> Result<Option<DateTime<Utc>>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "    match date_str {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "        Some(s) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "            // Parse YYYY-MM-DD format",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "            let date = chrono::NaiveDate::parse_from_str(s, \"%Y-%m-%d\")",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "                .with_context(|| format!(\"Invalid date format '{}'. Use YYYY-MM-DD.\", s))?;",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "            let datetime = date",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "                .and_hms_opt(0, 0, 0)",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "                .ok_or_else(|| anyhow::anyhow!(\"Invalid time for date {}\", s))?;",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "            Ok(Some(datetime.and_utc()))",
          "source": {
            "type": "AI",
            "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e"
          },
          "edit_id": "12f46fcd-11f8-4ff7-89bb-0401f16a043e",
          "prompt_index": 55,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "        None => Ok(None),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "fn build_commit_export(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "    commit: &git2::Commit,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "    attribution: &AIAttribution,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "    args: &ExportArgs,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": ") -> Result<CommitExport> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "    let commit_id = commit.id().to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "    let commit_short = commit_id[..7].to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "    let message = commit.summary().unwrap_or(\"(no message)\").to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "    let author = commit.author().name().unwrap_or(\"Unknown\").to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "    let committed_at = DateTime::from_timestamp(commit.time().seconds(), 0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "        .unwrap_or(DateTime::UNIX_EPOCH)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "        .to_rfc3339();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "    let ai_lines = attribution.total_ai_lines();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "    let ai_modified_lines = attribution.total_ai_modified_lines();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "    let human_lines = attribution.total_human_lines();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "    let original_lines = attribution.total_original_lines();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "    let files: Vec<String> = attribution.files.iter().map(|f| f.path.clone()).collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "    let prompts: Vec<PromptExport> = attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "        .prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "        .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "        .map(|p| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "            let text = if args.full_prompts {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "                p.text.clone()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "            } else if p.text.len() > args.prompt_max_len {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "                format!(\"{}...\", &p.text[..args.prompt_max_len])",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "            } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "                p.text.clone()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "            PromptExport {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "                index: p.index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "                text,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "                affected_files: p.affected_files.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "        .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "    Ok(CommitExport {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "        commit_id,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "        commit_short,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "        message,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "        author,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "        committed_at,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "        session_id: attribution.session.session_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "        model: attribution.session.model.id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "        ai_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "        ai_modified_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "        human_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "        original_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "        files,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "        prompts,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "    })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "fn build_summary(commits: &[CommitExport]) -> ExportSummary {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "    let commits_with_ai = commits.iter().filter(|c| c.ai_lines > 0).count();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "    let total_ai_lines: usize = commits.iter().map(|c| c.ai_lines).sum();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "    let total_ai_modified_lines: usize = commits.iter().map(|c| c.ai_modified_lines).sum();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "    let total_human_lines: usize = commits.iter().map(|c| c.human_lines).sum();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "    let total_original_lines: usize = commits.iter().map(|c| c.original_lines).sum();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "    let total_prompts: usize = commits.iter().map(|c| c.prompts.len()).sum();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "    ExportSummary {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "        total_commits: commits.len(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "        commits_with_ai,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "        total_ai_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "        total_ai_modified_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "        total_human_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "        total_original_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "        total_prompts,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "fn write_json(data: &ExportData, output: &Option<String>) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "    let json = serde_json::to_string_pretty(data)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "    match output {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "        Some(path) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "            let mut file = std::fs::File::create(path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "            file.write_all(json.as_bytes())?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "            eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "                \"Exported {} commits to {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "                data.summary.total_commits, path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "        None => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            println!(\"{}\", json);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "fn write_csv(data: &ExportData, output: &Option<String>) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "    let mut csv_content = String::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "    // Header",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "    csv_content.push_str(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "        \"commit_id,commit_short,message,author,committed_at,session_id,model,ai_lines,ai_modified_lines,human_lines,original_lines,files_count,prompts_count\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "    );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "    // Rows",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "    for commit in &data.commits {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "        let message = commit.message.replace(',', \";\").replace('\\n', \" \");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "        csv_content.push_str(&format!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "            \"{},{},{},{},{},{},{},{},{},{},{},{},{}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "            commit.commit_id,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "            commit.commit_short,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "            message,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "            commit.author.replace(',', \";\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "            commit.committed_at,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "            commit.session_id,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "            commit.model,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "            commit.ai_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "            commit.ai_modified_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "            commit.human_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "            commit.original_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "            commit.files.len(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "            commit.prompts.len()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "    match output {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "        Some(path) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "            let mut file = std::fs::File::create(path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "            file.write_all(csv_content.as_bytes())?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "            eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "                \"Exported {} commits to {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "                data.summary.total_commits, path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "        None => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "            print!(\"{}\", csv_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 353,
        "ai_lines": 24,
        "ai_modified_lines": 1,
        "human_lines": 0,
        "original_lines": 328,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/privacy/redaction.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use regex::Regex;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "use serde::{Deserialize, Serialize};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "/// Redaction placeholder",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "const REDACTED: &str = \"[REDACTED]\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "/// Merge overlapping intervals",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "///",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "/// Takes a sorted list of (start, end) intervals and returns a new list",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "/// where all overlapping or adjacent intervals have been merged.",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "fn merge_intervals(intervals: Vec<(usize, usize)>) -> Vec<(usize, usize)> {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "    if intervals.is_empty() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "        return Vec::new();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "    let mut merged: Vec<(usize, usize)> = Vec::with_capacity(intervals.len());",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "    let mut current = intervals[0];",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "    for interval in intervals.into_iter().skip(1) {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "        // If intervals overlap or are adjacent, merge them",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "        if interval.0 <= current.1 {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "            current.1 = current.1.max(interval.1);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "        } else {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "            // No overlap, push current and start new interval",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "            merged.push(current);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "            current = interval;",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    // Don't forget the last interval",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    merged.push(current);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "    merged",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "/// Named pattern definition",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "#[derive(Debug, Clone)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "pub struct NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    pub name: &'static str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "    pub pattern: &'static str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "    pub description: &'static str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "/// Default redaction patterns with names for audit trails",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "pub mod patterns {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    use super::NamedPattern;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "    /// API key pattern: matches api_key, api-key, apikey, secret, token followed by = or :",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    pub const API_KEY: &str = r\"(?i)(api[_-]?key|secret|token)\\s*[:=]\\s*\\S+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    /// Email pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    pub const EMAIL: &str = r\"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "    /// Password pattern: matches password, passwd, pwd followed by = or :",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "    pub const PASSWORD: &str = r\"(?i)(password|passwd|pwd)\\s*[:=]\\s*\\S+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    /// AWS key pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    pub const AWS_KEY: &str =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "        r\"(?i)(aws[_-]?)?(access[_-]?key[_-]?id|secret[_-]?access[_-]?key)\\s*[:=]\\s*\\S+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "    /// Private key header",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "    pub const PRIVATE_KEY: &str = r\"-----BEGIN\\s+(?:RSA\\s+)?PRIVATE\\s+KEY-----\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    /// Bearer token",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "    pub const BEARER_TOKEN: &str = r\"(?i)bearer\\s+[a-zA-Z0-9_\\-\\.]+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    /// GitHub token pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    pub const GITHUB_TOKEN: &str = r\"gh[pousr]_[A-Za-z0-9_]{36,}\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    /// Generic secret assignment",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    pub const GENERIC_SECRET: &str =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "        r#\"(?i)[\"']?(?:secret|private|credential)[_-]?(?:key)?[\"']?\\s*[:=]\\s*[\"']?[^\"'\\s]+\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "    // === NEW PII PATTERNS ===",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "    /// Social Security Number pattern (US format)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    pub const SSN: &str = r\"\\b\\d{3}-\\d{2}-\\d{4}\\b\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    /// Credit card number pattern (major card types)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    pub const CREDIT_CARD: &str = r\"\\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})\\b\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    /// Phone number pattern (US format with optional +1)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    pub const PHONE: &str = r\"\\b(?:\\+1[-.\\s]?)?\\(?[0-9]{3}\\)?[-.\\s]?[0-9]{3}[-.\\s]?[0-9]{4}\\b\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    /// Database connection string pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    pub const DB_CONNECTION: &str =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "        r\"(?i)(?:mysql|postgres|postgresql|mongodb|redis|mssql|mariadb)://[^\\s]+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "    /// Slack token pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "    pub const SLACK_TOKEN: &str = r\"xox[baprs]-[0-9A-Za-z\\-]+\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "    /// Stripe API key pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "    pub const STRIPE_KEY: &str = r\"(?:sk|pk|rk)_(?:live|test)_[0-9a-zA-Z]{24,}\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "    // === ADDITIONAL PATTERNS ===",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "    /// JWT token pattern (three base64url-encoded segments separated by dots)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    pub const JWT_TOKEN: &str = r\"eyJ[A-Za-z0-9_-]*\\.eyJ[A-Za-z0-9_-]*\\.[A-Za-z0-9_-]+\";",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6666666666666666
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6666666666666666
        },
        {
          "line_number": 99,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "    /// Google OAuth refresh token pattern",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "    pub const GOOGLE_OAUTH: &str = r\"1//[0-9A-Za-z_-]{40,}\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    /// Microsoft/Azure OAuth refresh token pattern",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    pub const MICROSOFT_OAUTH: &str = r\"0\\.A[A-Za-z0-9_-]{80,}\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "    /// Docker registry credentials (user:pass@registry format)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "    pub const DOCKER_REGISTRY: &str =",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "        r\"(?i)(?:docker|registry)[_-]?(?:user|pass|auth|credential)?[:\\s=]+[^\\s]+:[^\\s]+@[^\\s]+\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "    /// Kubernetes secret data (base64 encoded values in common k8s formats)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "    pub const K8S_SECRET: &str = r\"(?i)(?:kubectl\\s+create\\s+secret|kind:\\s*Secret)\";",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6419753086419753
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6419753086419753
        },
        {
          "line_number": 112,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "    /// Generic base64-encoded secret (long base64 strings that look like secrets)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "    pub const BASE64_SECRET: &str = r#\"(?i)(?:secret|key|token|password|credential)[_-]?(?:data)?[:\\s=]+['\"]?[A-Za-z0-9+/=]{40,}['\"]?\"#;",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.7575757575757576
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.7575757575757576
        },
        {
          "line_number": 115,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "    /// npm auth token",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "    pub const NPM_TOKEN: &str = r\"npm_[A-Za-z0-9]{36}\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "    /// PyPI API token",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "    pub const PYPI_TOKEN: &str = r\"pypi-AgEIcHlwaS5vcmc[A-Za-z0-9_-]{50,}\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "    /// All builtin patterns with names",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "    pub const ALL_NAMED: &[NamedPattern] = &[",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "            name: \"API_KEY\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "            pattern: API_KEY,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "            description: \"API keys and tokens (api_key=, secret=, token=)\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "            name: \"EMAIL\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "            pattern: EMAIL,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "            description: \"Email addresses\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "            name: \"PASSWORD\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "            pattern: PASSWORD,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "            description: \"Password assignments (password=, pwd=)\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "            name: \"AWS_KEY\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "            pattern: AWS_KEY,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "            description: \"AWS access keys and secret keys\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "            name: \"PRIVATE_KEY\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "            pattern: PRIVATE_KEY,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "            description: \"PEM private key headers\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "            name: \"BEARER_TOKEN\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "            pattern: BEARER_TOKEN,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "            description: \"Bearer authentication tokens\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "            name: \"GITHUB_TOKEN\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "            pattern: GITHUB_TOKEN,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "            description: \"GitHub personal access tokens\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "            name: \"GENERIC_SECRET\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "            pattern: GENERIC_SECRET,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "            description: \"Generic secret/credential assignments\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "            name: \"SSN\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "            pattern: SSN,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "            description: \"US Social Security Numbers\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "            name: \"CREDIT_CARD\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "            pattern: CREDIT_CARD,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "            description: \"Credit card numbers (Visa, MC, Amex, Discover)\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "            name: \"PHONE\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "            pattern: PHONE,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "            description: \"US phone numbers\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "            name: \"DB_CONNECTION\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "            pattern: DB_CONNECTION,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "            description: \"Database connection strings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "            name: \"SLACK_TOKEN\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "            pattern: SLACK_TOKEN,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "            description: \"Slack API tokens\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "        NamedPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "            name: \"STRIPE_KEY\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "            pattern: STRIPE_KEY,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "            description: \"Stripe API keys\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "            name: \"JWT_TOKEN\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "            pattern: JWT_TOKEN,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "            description: \"JWT tokens (JSON Web Tokens)\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "            name: \"GOOGLE_OAUTH\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "            pattern: GOOGLE_OAUTH,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "            description: \"Google OAuth refresh tokens\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "            name: \"MICROSOFT_OAUTH\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "            pattern: MICROSOFT_OAUTH,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "            description: \"Microsoft/Azure OAuth refresh tokens\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "            name: \"DOCKER_REGISTRY\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "            pattern: DOCKER_REGISTRY,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "            description: \"Docker registry credentials\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "            name: \"K8S_SECRET\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "            pattern: K8S_SECRET,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "            description: \"Kubernetes secret data\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "            name: \"BASE64_SECRET\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "            pattern: BASE64_SECRET,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "            description: \"Base64-encoded secrets\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "            name: \"NPM_TOKEN\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "            pattern: NPM_TOKEN,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "            description: \"npm authentication tokens\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "        NamedPattern {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "            name: \"PYPI_TOKEN\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "            pattern: PYPI_TOKEN,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "            description: \"PyPI API tokens\",",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "        },",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "    ];",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "/// A redaction event for audit trail",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "pub struct RedactionEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "    /// Name of the pattern that matched",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "    pub pattern_name: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "    /// Character range in original text (start, end)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "    pub char_range: (usize, usize),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "    /// ISO8601 timestamp",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "    pub timestamp: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "    /// Preview of what was matched (first 10 chars, then ...)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "    pub preview: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "/// Result of redaction with audit trail",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "pub struct RedactionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "    /// Redacted text",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "    pub text: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "    /// Audit events for each redaction",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "    pub events: Vec<RedactionEvent>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "    /// Total number of redactions",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "    pub redaction_count: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "/// Compiled pattern with name for tracking",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "#[derive(Clone)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "struct CompiledPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "    name: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "    regex: Regex,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "/// Privacy redactor for sensitive data in prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "#[derive(Clone)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "pub struct Redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "    patterns: Vec<CompiledPattern>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "impl Redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "    /// Create a redactor with custom patterns (unnamed)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "    pub fn new(pattern_strings: &[&str]) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "        let patterns = pattern_strings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "            .enumerate()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "            .filter_map(|(i, p)| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "                Regex::new(p).ok().map(|regex| CompiledPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "                    name: format!(\"CUSTOM_{}\", i),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "                    regex,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "                })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "        Self { patterns }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "    /// Create a redactor with named patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "    pub fn with_named_patterns(named_patterns: &[(String, String)]) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "        let patterns = named_patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "            .filter_map(|(name, pattern)| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "                Regex::new(pattern).ok().map(|regex| CompiledPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "                    name: name.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "                    regex,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "                })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "        Self { patterns }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "    /// Create a redactor with all default security patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "    pub fn default_patterns() -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "        let named: Vec<(String, String)> = patterns::ALL_NAMED",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "            .map(|np| (np.name.to_string(), np.pattern.to_string()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "        Self::with_named_patterns(&named)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "    /// Create a redactor with specific builtin patterns by name",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "    pub fn with_builtins(names: &[&str]) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "        let named: Vec<(String, String)> = patterns::ALL_NAMED",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "            .filter(|np| names.contains(&np.name))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "            .map(|np| (np.name.to_string(), np.pattern.to_string()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "        Self::with_named_patterns(&named)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "    /// Create a redactor with all builtins except specified names",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "    pub fn without_builtins(excluded_names: &[&str]) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "        let named: Vec<(String, String)> = patterns::ALL_NAMED",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "            .filter(|np| !excluded_names.contains(&np.name))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "            .map(|np| (np.name.to_string(), np.pattern.to_string()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "        Self::with_named_patterns(&named)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "    /// Create a redactor with no patterns (no redaction)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "    pub fn none() -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "        Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "            patterns: Vec::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "    /// Add a custom pattern with a name",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "    pub fn add_named_pattern(&mut self, name: &str, pattern: &str) -> Result<(), regex::Error> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "        let regex = Regex::new(pattern)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "        self.patterns.push(CompiledPattern {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "            name: name.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "            regex,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "    /// Add a custom pattern (backward compatible)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "    pub fn add_pattern(&mut self, pattern: &str) -> Result<(), regex::Error> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "        let name = format!(\"CUSTOM_{}\", self.patterns.len());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "        self.add_named_pattern(&name, pattern)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "    /// Redact sensitive data from text",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "    /// Uses interval merging to handle overlapping patterns correctly,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "    /// preventing double-redaction and corrupted output.",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "    pub fn redact(&self, text: &str) -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "        // Collect all match intervals",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        let mut intervals: Vec<(usize, usize)> = Vec::new();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "        for cp in &self.patterns {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "            for m in cp.regex.find_iter(text) {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "                intervals.push((m.start(), m.end()));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "        if intervals.is_empty() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "            return text.to_string();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "        // Sort by start position",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "        intervals.sort_by_key(|i| i.0);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "        // Merge overlapping intervals",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "        let merged = merge_intervals(intervals);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "        // Build result string by replacing merged intervals",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "        let mut result = String::with_capacity(text.len());",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "        let mut last_end = 0;",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "        for (start, end) in merged {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "            // Add text before this interval",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "            result.push_str(&text[last_end..start]);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "            // Add redaction marker",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "            result.push_str(REDACTED);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "            last_end = end;",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "        // Add remaining text",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "        result.push_str(&text[last_end..]);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "        result",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "    /// Redact sensitive data with full audit trail",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "    /// Note: The redaction_count reflects the number of distinct matches found,",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "    /// though overlapping matches are merged into single redactions in the output.",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "    pub fn redact_with_audit(&self, text: &str) -> RedactionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "        let timestamp = chrono::Utc::now().to_rfc3339();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "        let mut events = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "        let mut all_intervals: Vec<(usize, usize)> = Vec::new();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "        // Collect all matches first with their pattern info",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "        for cp in &self.patterns {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "            for m in cp.regex.find_iter(text) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": "                let matched = m.as_str();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "                let preview = if matched.len() > 10 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "                    format!(\"{}...\", &matched[..10])",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "                } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "                    matched.to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "                };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "                events.push(RedactionEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "                    pattern_name: cp.name.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "                    char_range: (m.start(), m.end()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "                    timestamp: timestamp.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "                    preview,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "                });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "                all_intervals.push((m.start(), m.end()));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "        // Sort events by position for deterministic output",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "        events.sort_by_key(|e| e.char_range.0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "        // The redaction count is the number of distinct matches",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "        // (even if some overlap and get merged in output)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "        let redaction_count = events.len();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "        // Perform the actual redaction (with interval merging)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "        let text = self.redact(text);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "        RedactionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "            text,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "            events,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "            redaction_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "    /// Check if text contains sensitive data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "    pub fn contains_sensitive(&self, text: &str) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "        self.patterns.iter().any(|cp| cp.regex.is_match(text))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "    /// Get list of matches in text (for debugging/preview)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "    pub fn find_sensitive(&self, text: &str) -> Vec<String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 457,
          "content": "        self.patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 458,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 459,
          "content": "            .flat_map(|cp| cp.regex.find_iter(text).map(|m| m.as_str().to_string()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 460,
          "content": "            .collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 461,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 462,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 463,
          "content": "    /// Get list of matches with pattern names",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 464,
          "content": "    pub fn find_sensitive_named(&self, text: &str) -> Vec<(String, String)> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 465,
          "content": "        self.patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 466,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 467,
          "content": "            .flat_map(|cp| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 468,
          "content": "                cp.regex",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 469,
          "content": "                    .find_iter(text)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 470,
          "content": "                    .map(|m| (cp.name.clone(), m.as_str().to_string()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 471,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 472,
          "content": "            .collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 473,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 474,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 475,
          "content": "    /// Get names of all loaded patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 476,
          "content": "    pub fn pattern_names(&self) -> Vec<&str> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 477,
          "content": "        self.patterns.iter().map(|cp| cp.name.as_str()).collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 478,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 479,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 480,
          "content": "    /// Get count of loaded patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 481,
          "content": "    pub fn pattern_count(&self) -> usize {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 482,
          "content": "        self.patterns.len()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 483,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 484,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 485,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 486,
          "content": "impl Default for Redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 487,
          "content": "    fn default() -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 488,
          "content": "        Self::default_patterns()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 489,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 490,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 491,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 492,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 493,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 494,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 495,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 496,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 497,
          "content": "    fn test_api_key_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 498,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 499,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 500,
          "content": "        let input = \"Use api_key = sk-1234567890abcdef for auth\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 501,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 502,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 503,
          "content": "        assert!(!output.contains(\"sk-1234567890abcdef\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 504,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 505,
          "content": "        let input2 = \"Set SECRET: my_secret_value\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 506,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 507,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 508,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 509,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 510,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 511,
          "content": "    fn test_email_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 512,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 513,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 514,
          "content": "        let input = \"Send to user@example.com for review\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 515,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 516,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 517,
          "content": "        assert!(!output.contains(\"user@example.com\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 518,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 519,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 520,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 521,
          "content": "    fn test_password_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 522,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 523,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 524,
          "content": "        let input = \"password = super_secret_123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 525,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 526,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 527,
          "content": "        assert!(!output.contains(\"super_secret_123\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 528,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 529,
          "content": "        let input2 = \"Use PWD: mypassword\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 530,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 531,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 532,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 533,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 534,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 535,
          "content": "    fn test_aws_key_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 536,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 537,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 538,
          "content": "        let input = \"AWS_ACCESS_KEY_ID = AKIAIOSFODNN7EXAMPLE\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 539,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 540,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 541,
          "content": "        assert!(!output.contains(\"AKIAIOSFODNN7EXAMPLE\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 542,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 543,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 544,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 545,
          "content": "    fn test_bearer_token_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 546,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 547,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 548,
          "content": "        let input = \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 549,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 550,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 551,
          "content": "        assert!(!output.contains(\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 552,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 553,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 554,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 555,
          "content": "    fn test_github_token_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 556,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 557,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 558,
          "content": "        let input = \"GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 559,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 560,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 561,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 562,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 563,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 564,
          "content": "    fn test_private_key_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 565,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 566,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 567,
          "content": "        let input = \"Use this key:\\n-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBg...\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 568,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 569,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 570,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 571,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 572,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 573,
          "content": "    fn test_no_false_positives() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 574,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 575,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 576,
          "content": "        // Normal text should not be redacted",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 577,
          "content": "        let input = \"Add error handling to the API endpoint\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 578,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 579,
          "content": "        assert_eq!(input, output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 580,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 581,
          "content": "        let input2 = \"The token count is 42\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 582,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 583,
          "content": "        assert_eq!(input2, output2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 584,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 585,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 586,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 587,
          "content": "    fn test_multiple_redactions() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 588,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 589,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 590,
          "content": "        let input = \"api_key = abc123 and email user@test.com with password = secret\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 591,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 592,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 593,
          "content": "        // Should redact all three",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 594,
          "content": "        assert!(!output.contains(\"abc123\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 595,
          "content": "        assert!(!output.contains(\"user@test.com\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 596,
          "content": "        assert!(!output.contains(\"secret\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 597,
          "content": "        assert_eq!(output.matches(REDACTED).count(), 3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 598,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 599,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 600,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 601,
          "content": "    fn test_contains_sensitive() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 602,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 603,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 604,
          "content": "        assert!(redactor.contains_sensitive(\"api_key = secret\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 605,
          "content": "        assert!(redactor.contains_sensitive(\"email: test@example.com\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 606,
          "content": "        assert!(!redactor.contains_sensitive(\"normal text here\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 607,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 608,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 609,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 610,
          "content": "    fn test_find_sensitive() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 611,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 612,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 613,
          "content": "        let matches = redactor.find_sensitive(\"api_key = secret123 and user@test.com\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 614,
          "content": "        assert!(!matches.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 615,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 616,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 617,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 618,
          "content": "    fn test_custom_pattern() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 619,
          "content": "        let mut redactor = Redactor::none();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 620,
          "content": "        redactor.add_pattern(r\"SSN:\\s*\\d{3}-\\d{2}-\\d{4}\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 621,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 622,
          "content": "        let input = \"Customer SSN: 123-45-6789\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 623,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 624,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 625,
          "content": "        assert!(!output.contains(\"123-45-6789\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 626,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 627,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 628,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 629,
          "content": "    fn test_no_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 630,
          "content": "        let redactor = Redactor::none();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 631,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 632,
          "content": "        let input = \"api_key = secret123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 633,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 634,
          "content": "        assert_eq!(input, output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 635,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 636,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 637,
          "content": "    // === NEW PATTERN TESTS ===",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 638,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 639,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 640,
          "content": "    fn test_ssn_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 641,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 642,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 643,
          "content": "        let input = \"Customer SSN is 123-45-6789\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 644,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 645,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 646,
          "content": "        assert!(!output.contains(\"123-45-6789\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 647,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 648,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 649,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 650,
          "content": "    fn test_credit_card_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 651,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 652,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 653,
          "content": "        // Visa",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 654,
          "content": "        let input = \"Card: 4111111111111111\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 655,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 656,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 657,
          "content": "        assert!(!output.contains(\"4111111111111111\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 658,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 659,
          "content": "        // Mastercard",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 660,
          "content": "        let input2 = \"Pay with 5500000000000004\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 661,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 662,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 663,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 664,
          "content": "        // Amex",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 665,
          "content": "        let input3 = \"Amex: 378282246310005\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 666,
          "content": "        let output3 = redactor.redact(input3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 667,
          "content": "        assert!(output3.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 668,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 669,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 670,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 671,
          "content": "    fn test_phone_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 672,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 673,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 674,
          "content": "        let input = \"Call me at 555-123-4567\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 675,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 676,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 677,
          "content": "        assert!(!output.contains(\"555-123-4567\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 678,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 679,
          "content": "        let input2 = \"Phone: +1 (555) 123-4567\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 680,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 681,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 682,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 683,
          "content": "        let input3 = \"Contact: 555.123.4567\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 684,
          "content": "        let output3 = redactor.redact(input3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 685,
          "content": "        assert!(output3.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 686,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 687,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 688,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 689,
          "content": "    fn test_db_connection_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 690,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 691,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 692,
          "content": "        let input = \"DATABASE_URL=postgres://user:pass@localhost:5432/db\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 693,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 694,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 695,
          "content": "        assert!(!output.contains(\"postgres://\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 696,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 697,
          "content": "        let input2 = \"Use mysql://root:secret@db.example.com/mydb\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 698,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 699,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 700,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 701,
          "content": "        let input3 = \"mongodb://admin:password@cluster.mongodb.net/app\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 702,
          "content": "        let output3 = redactor.redact(input3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 703,
          "content": "        assert!(output3.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 704,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 705,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 706,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 707,
          "content": "    fn test_slack_token_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 708,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 709,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 710,
          "content": "        // Use obviously fake token format that matches pattern but won't trigger secret scanning",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 711,
          "content": "        let input = \"SLACK_TOKEN=xoxb-FAKE-TOKEN-TEST\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 712,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 713,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 714,
          "content": "        assert!(!output.contains(\"xoxb-\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 715,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 716,
          "content": "        let input2 = \"Use xoxp-FAKE-TEST for user\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 717,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 718,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 719,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 720,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 721,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 722,
          "content": "    fn test_stripe_key_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 723,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 724,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 725,
          "content": "        // Build test strings at runtime to avoid GitHub secret scanning false positives",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 726,
          "content": "        let prefix = \"sk_live_\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 727,
          "content": "        let suffix = \"0\".repeat(24); // 24 zeros - matches pattern but clearly not a real key",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 728,
          "content": "        let input = format!(\"STRIPE_KEY={}{}\", prefix, suffix);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 729,
          "content": "        let output = redactor.redact(&input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 730,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 731,
          "content": "        assert!(!output.contains(\"sk_live_\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 732,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 733,
          "content": "        let prefix2 = \"pk_test_\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 734,
          "content": "        let input2 = format!(\"Test with {}{}\", prefix2, suffix);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 735,
          "content": "        let output2 = redactor.redact(&input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 736,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 737,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 738,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 739,
          "content": "    // === AUDIT TRAIL TESTS ===",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 740,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 741,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 742,
          "content": "    fn test_redact_with_audit() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 743,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 744,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 745,
          "content": "        let input = \"api_key = secret123 and email user@test.com\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 746,
          "content": "        let result = redactor.redact_with_audit(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 747,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 748,
          "content": "        assert!(result.text.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 749,
          "content": "        assert_eq!(result.redaction_count, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 750,
          "content": "        assert_eq!(result.events.len(), 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 751,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 752,
          "content": "        // Check that events have pattern names",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 753,
          "content": "        let pattern_names: Vec<_> = result",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 754,
          "content": "            .events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 755,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 756,
          "content": "            .map(|e| e.pattern_name.as_str())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 757,
          "content": "            .collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 758,
          "content": "        assert!(pattern_names.contains(&\"API_KEY\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 759,
          "content": "        assert!(pattern_names.contains(&\"EMAIL\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 760,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 761,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 762,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 763,
          "content": "    fn test_redact_with_audit_no_matches() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 764,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 765,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 766,
          "content": "        let input = \"Normal text without sensitive data\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 767,
          "content": "        let result = redactor.redact_with_audit(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 768,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 769,
          "content": "        assert_eq!(result.text, input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 770,
          "content": "        assert_eq!(result.redaction_count, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 771,
          "content": "        assert!(result.events.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 772,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 773,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 774,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 775,
          "content": "    fn test_find_sensitive_named() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 776,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 777,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 778,
          "content": "        let matches = redactor.find_sensitive_named(\"api_key = secret123 and 123-45-6789\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 779,
          "content": "        assert!(!matches.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 780,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 781,
          "content": "        let names: Vec<_> = matches.iter().map(|(name, _)| name.as_str()).collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 782,
          "content": "        assert!(names.contains(&\"API_KEY\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 783,
          "content": "        assert!(names.contains(&\"SSN\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 784,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 785,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 786,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 787,
          "content": "    fn test_with_builtins() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 788,
          "content": "        let redactor = Redactor::with_builtins(&[\"EMAIL\", \"SSN\"]);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 789,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 790,
          "content": "        // Should redact email",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 791,
          "content": "        let input1 = \"Email: test@example.com\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 792,
          "content": "        let output1 = redactor.redact(input1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 793,
          "content": "        assert!(output1.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 794,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 795,
          "content": "        // Should redact SSN",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 796,
          "content": "        let input2 = \"SSN: 123-45-6789\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 797,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 798,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 799,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 800,
          "content": "        // Should NOT redact API keys (not included)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 801,
          "content": "        let input3 = \"api_key = secret123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 802,
          "content": "        let output3 = redactor.redact(input3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 803,
          "content": "        assert_eq!(input3, output3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 804,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 805,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 806,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 807,
          "content": "    fn test_without_builtins() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 808,
          "content": "        let redactor = Redactor::without_builtins(&[\"EMAIL\"]);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 809,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 810,
          "content": "        // Should NOT redact email (excluded)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 811,
          "content": "        let input1 = \"Email: test@example.com\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 812,
          "content": "        let output1 = redactor.redact(input1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 813,
          "content": "        assert_eq!(input1, output1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 814,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 815,
          "content": "        // Should still redact API keys",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 816,
          "content": "        let input2 = \"api_key = secret123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 817,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 818,
          "content": "        assert!(output2.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 819,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 820,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 821,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 822,
          "content": "    fn test_pattern_names() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 823,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 824,
          "content": "        let names = redactor.pattern_names();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 825,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 826,
          "content": "        assert!(names.contains(&\"API_KEY\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 827,
          "content": "        assert!(names.contains(&\"EMAIL\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 828,
          "content": "        assert!(names.contains(&\"SSN\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 829,
          "content": "        assert!(names.contains(&\"CREDIT_CARD\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 830,
          "content": "        assert!(names.contains(&\"JWT_TOKEN\"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 831,
          "content": "        assert!(names.contains(&\"DOCKER_REGISTRY\"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 832,
          "content": "        // K8S_SECRET pattern may fail to compile (multiline), so 22 or 23 patterns expected",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 833,
          "content": "        assert!(",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 834,
          "content": "            names.len() >= 22,",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 835,
          "content": "            \"Expected at least 22 builtin patterns, got {}\",",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 836,
          "content": "            names.len()",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 837,
          "content": "        );",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6666666666666666
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6666666666666666
        },
        {
          "line_number": 838,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 839,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 840,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 841,
          "content": "    fn test_add_named_pattern() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 842,
          "content": "        let mut redactor = Redactor::none();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 843,
          "content": "        redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 844,
          "content": "            .add_named_pattern(\"CUSTOM_ID\", r\"ID-\\d{6}\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 845,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 846,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 847,
          "content": "        let input = \"Reference ID-123456\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 848,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 849,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 850,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 851,
          "content": "        let names = redactor.pattern_names();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 852,
          "content": "        assert!(names.contains(&\"CUSTOM_ID\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 853,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 854,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 855,
          "content": "    // === TESTS FOR NEW PATTERNS ===",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 856,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 857,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 858,
          "content": "    fn test_jwt_token_redaction() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 859,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 860,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 861,
          "content": "        // Standard JWT format: header.payload.signature",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 862,
          "content": "        let input = \"Authorization: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 863,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 864,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 865,
          "content": "        assert!(!output.contains(\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 866,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 867,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 868,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 869,
          "content": "    fn test_google_oauth_redaction() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 870,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 871,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 872,
          "content": "        // Google refresh token format",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 873,
          "content": "        let input = \"GOOGLE_REFRESH_TOKEN=1//0gxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 874,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 875,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 876,
          "content": "        assert!(!output.contains(\"1//0g\"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 877,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 878,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 879,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 880,
          "content": "    fn test_npm_token_redaction() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 881,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 882,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 883,
          "content": "        // npm token format",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 884,
          "content": "        let input = \"//registry.npmjs.org/:_authToken=npm_abcdefghijklmnopqrstuvwxyz1234567890\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 885,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 886,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 887,
          "content": "        assert!(!output.contains(\"npm_\"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 888,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 889,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 890,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 891,
          "content": "    fn test_base64_secret_redaction() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 892,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 893,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 894,
          "content": "        // Base64-encoded secret",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 895,
          "content": "        let input = \"secret_key: 'SGVsbG9Xb3JsZFRoaXNJc0FWZXJ5TG9uZ1NlY3JldEtleVRoYXRTaG91bGRCZVJlZGFjdGVk'\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 896,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 897,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 898,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 899,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 900,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 901,
          "content": "    fn test_overlapping_patterns() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 902,
          "content": "        // Create redactor with patterns that could overlap",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 903,
          "content": "        let mut redactor = Redactor::none();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 904,
          "content": "        // Pattern 1 matches \"api_key = value\"",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 905,
          "content": "        redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 906,
          "content": "            .add_named_pattern(\"PATTERN1\", r\"api_key\\s*=\\s*\\S+\")",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.7428571428571429
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.7428571428571429
        },
        {
          "line_number": 907,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 908,
          "content": "        // Pattern 2 matches \"secret123\" specifically",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 909,
          "content": "        redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 910,
          "content": "            .add_named_pattern(\"PATTERN2\", r\"secret\\d+\")",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.7096774193548387
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.7096774193548387
        },
        {
          "line_number": 911,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 912,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 913,
          "content": "        // The value \"secret123\" could be matched by both patterns",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 914,
          "content": "        // (one as part of api_key value, one as the secret pattern)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 915,
          "content": "        let input = \"Use api_key = secret123 for auth\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 916,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 917,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 918,
          "content": "        // Should produce clean output without double-redaction",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 919,
          "content": "        // The word \"[REDACTED]\" should appear, but not \"[REDACTED][REDACTED]\" or corrupted text",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 920,
          "content": "        assert!(output.contains(REDACTED));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 921,
          "content": "        assert!(",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 922,
          "content": "            !output.contains(\"[REDACTED][REDACTED]\"),",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6341463414634146
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6341463414634146
        },
        {
          "line_number": 923,
          "content": "            \"Double redaction detected\"",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 924,
          "content": "        );",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6666666666666666
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6666666666666666
        },
        {
          "line_number": 925,
          "content": "        assert!(output.contains(\"Use \"), \"Text before should be preserved\");",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 926,
          "content": "        assert!(",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 927,
          "content": "            output.contains(\" for auth\"),",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.696969696969697
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.696969696969697
        },
        {
          "line_number": 928,
          "content": "            \"Text after should be preserved\"",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 929,
          "content": "        );",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.6666666666666666
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.6666666666666666
        },
        {
          "line_number": 930,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 931,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 932,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 933,
          "content": "    fn test_adjacent_patterns() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 934,
          "content": "        // Test adjacent (but not overlapping) matches",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 935,
          "content": "        let mut redactor = Redactor::none();",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 936,
          "content": "        redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 937,
          "content": "            .add_named_pattern(\"EMAIL\", r\"[a-z]+@[a-z]+\\.[a-z]+\")",
          "source": {
            "type": "AIModified",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
            "similarity": 0.7464788732394366
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 0.7464788732394366
        },
        {
          "line_number": 938,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 939,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 940,
          "content": "        let input = \"Contact user@test.com or admin@test.com\";",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 941,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 942,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 943,
          "content": "        // Both emails should be redacted separately",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 944,
          "content": "        assert_eq!(output.matches(REDACTED).count(), 2);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 945,
          "content": "        assert!(output.contains(\"Contact \"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 946,
          "content": "        assert!(output.contains(\" or \"));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 947,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 948,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 949,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 950,
          "content": "    fn test_interval_merging() {",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 951,
          "content": "        // Directly test the merge function",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 952,
          "content": "        let intervals = vec![(0, 5), (3, 8), (10, 15), (14, 20)];",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 953,
          "content": "        let merged = merge_intervals(intervals);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 954,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 955,
          "content": "        // First two should merge: (0,5) + (3,8) = (0,8)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 956,
          "content": "        // Last two should merge: (10,15) + (14,20) = (10,20)",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 957,
          "content": "        assert_eq!(merged.len(), 2);",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 958,
          "content": "        assert_eq!(merged[0], (0, 8));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 959,
          "content": "        assert_eq!(merged[1], (10, 20));",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 960,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5"
          },
          "edit_id": "898af32c-60b7-4a06-a053-f9cdc923d8f5",
          "prompt_index": 40,
          "confidence": 1.0
        },
        {
          "line_number": 961,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 961,
        "ai_lines": 231,
        "ai_modified_lines": 11,
        "human_lines": 8,
        "original_lines": 711,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/privacy/config.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "//! Privacy configuration for whogitit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "//!",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "//! Supports loading from `.whogitit.toml` (repo) or `~/.config/whogitit/config.toml` (global).",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use serde::{Deserialize, Serialize};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use std::path::{Path, PathBuf};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "use super::redaction::{patterns, Redactor};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "use regex;",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "/// Privacy configuration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "#[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "pub struct PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "    /// Whether redaction is enabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "    pub enabled: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "    /// Whether to use builtin patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "    pub use_builtin_patterns: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "    /// Custom patterns to add",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    pub custom_patterns: Vec<PatternConfig>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "    /// Builtin patterns to disable (by name)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    pub disabled_patterns: Vec<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    /// Whether to log redaction events for audit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    pub audit_log: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "impl Default for PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "    fn default() -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "        Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "            enabled: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "            use_builtin_patterns: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "            custom_patterns: Vec::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "            disabled_patterns: Vec::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "            audit_log: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "/// Custom pattern configuration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "pub struct PatternConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    /// Pattern name (for audit trail)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "    pub name: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    /// Regex pattern",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "    pub pattern: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "    /// Optional description",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    pub description: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "/// Full whogitit configuration file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize, Default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "#[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "pub struct WhogititConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    /// Privacy settings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "    pub privacy: PrivacyConfig,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    /// Retention settings (for Phase 3)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "    pub retention: Option<RetentionConfig>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    /// Analysis settings",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    #[serde(default)]",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    pub analysis: AnalysisConfig,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "/// Analysis configuration",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "#[serde(default)]",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "pub struct AnalysisConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    /// Maximum age in hours before a pending buffer is considered stale",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    /// Default: 24 hours",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    pub max_pending_age_hours: u32,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    /// Similarity threshold (0.0-1.0) for detecting AIModified lines",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    /// Lower values mean more aggressive matching, higher values require more similarity",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    /// Default: 0.6",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "    pub similarity_threshold: f64,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "impl Default for AnalysisConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "    fn default() -> Self {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "        Self {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "            max_pending_age_hours: 24,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "            similarity_threshold: 0.6,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "/// Data retention configuration (Phase 3)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "#[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "pub struct RetentionConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    /// Maximum age of attribution data in days",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    pub max_age_days: Option<u32>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "    /// Whether to auto-purge old data",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "    pub auto_purge: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "    /// Refs to always retain (e.g., [\"refs/heads/main\"])",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "    pub retain_refs: Vec<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "    /// Minimum commits to keep regardless of age",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "    pub min_commits: Option<u32>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "impl Default for RetentionConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "    fn default() -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "        Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "            max_age_days: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "            auto_purge: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "            retain_refs: vec![\"refs/heads/main\".to_string()],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "            min_commits: Some(100),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "impl WhogititConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "    /// Load configuration from repo root, falling back to global config",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "    pub fn load(repo_root: &Path) -> Result<Self> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "        // Try repo-local config first",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "        let repo_config = repo_root.join(\".whogitit.toml\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        if repo_config.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "            return Self::load_from_file(&repo_config);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "        // Try global config",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "        if let Some(global_config) = Self::global_config_path() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "            if global_config.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "                return Self::load_from_file(&global_config);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "        // Return defaults",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        Ok(Self::default())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "    /// Load configuration from a specific file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "    pub fn load_from_file(path: &Path) -> Result<Self> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "        let content = std::fs::read_to_string(path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "            .with_context(|| format!(\"Failed to read config file: {}\", path.display()))?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "        toml::from_str(&content)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "            .with_context(|| format!(\"Failed to parse config file: {}\", path.display()))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "    /// Get global config path (~/.config/whogitit/config.toml)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "    pub fn global_config_path() -> Option<PathBuf> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        dirs_path().map(|p| p.join(\"config.toml\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "    /// Get repo-local config path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "    pub fn repo_config_path(repo_root: &Path) -> PathBuf {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "        repo_root.join(\".whogitit.toml\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "    /// Check if a config file exists for this repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "    pub fn exists_for_repo(repo_root: &Path) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "        Self::repo_config_path(repo_root).exists()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "impl PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "    /// Build a Redactor from this configuration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "    /// Validates all patterns and logs warnings for invalid ones.",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "    /// Invalid custom patterns are skipped (with warning).",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "    /// Invalid disabled pattern names are also warned about.",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "    pub fn build_redactor(&self) -> Redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "        if !self.enabled {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "            return Redactor::none();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "        let mut named_patterns: Vec<(String, String)> = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "        // Validate disabled pattern names",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "        let valid_builtin_names: Vec<&str> = patterns::ALL_NAMED.iter().map(|np| np.name).collect();",
          "source": {
            "type": "AIModified",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
            "similarity": 0.6413043478260869
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 0.6413043478260869
        },
        {
          "line_number": 188,
          "content": "        for disabled_name in &self.disabled_patterns {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "            if !valid_builtin_names.contains(&disabled_name.as_str()) {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "                eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "                    \"whogitit: Warning - disabled pattern '{}' is not a valid builtin pattern name\",",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "                    disabled_name",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "                eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "                    \"whogitit: Valid builtin patterns: {}\",",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "                    valid_builtin_names.join(\", \")",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "        // Add builtin patterns (unless disabled)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "        if self.use_builtin_patterns {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "            for np in patterns::ALL_NAMED {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "                if !self.disabled_patterns.contains(&np.name.to_string()) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "                    named_patterns.push((np.name.to_string(), np.pattern.to_string()));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "        // Validate and add custom patterns",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "        for custom in &self.custom_patterns {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "            // Validate the regex pattern",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "            match regex::Regex::new(&custom.pattern) {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "                Ok(_) => {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "                    named_patterns.push((custom.name.clone(), custom.pattern.clone()));",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "                Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "                    eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "                        \"whogitit: Warning - invalid custom pattern '{}': {}\",",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "                        custom.name, e",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "                    );",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "                    eprintln!(\"whogitit: Pattern '{}' will be skipped\", custom.name);",
          "source": {
            "type": "AIModified",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
            "similarity": 0.6307692307692307
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 0.6307692307692307
        },
        {
          "line_number": 223,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "        Redactor::with_named_patterns(&named_patterns)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "    /// List all available builtin pattern names",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "    pub fn available_patterns() -> Vec<(&'static str, &'static str)> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "        patterns::ALL_NAMED",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "            .map(|np| (np.name, np.description))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "            .collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "/// Get whogitit config directory path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "fn dirs_path() -> Option<PathBuf> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "    // Try XDG_CONFIG_HOME first, then fall back to ~/.config",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "    std::env::var(\"XDG_CONFIG_HOME\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "        .ok()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "        .map(PathBuf::from)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "        .or_else(|| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "            std::env::var(\"HOME\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "                .ok()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "                .map(|h| PathBuf::from(h).join(\".config\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "        .map(|p| p.join(\"whogitit\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "    use tempfile::TempDir;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "    fn test_default_config() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "        let config = WhogititConfig::default();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "        assert!(config.privacy.enabled);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "        assert!(config.privacy.use_builtin_patterns);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "        assert!(config.privacy.custom_patterns.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "        assert!(config.privacy.disabled_patterns.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "        assert!(!config.privacy.audit_log);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "    fn test_parse_toml_config() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "        let toml = r#\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "[privacy]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "enabled = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "use_builtin_patterns = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "audit_log = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "disabled_patterns = [\"EMAIL\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "[[privacy.custom_patterns]]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "name = \"INTERNAL_ID\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "pattern = \"INT-[0-9]{6}\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "description = \"Internal tracking IDs\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "        let config: WhogititConfig = toml::from_str(toml).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "        assert!(config.privacy.enabled);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "        assert!(config.privacy.audit_log);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "        assert_eq!(config.privacy.disabled_patterns, vec![\"EMAIL\"]);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "        assert_eq!(config.privacy.custom_patterns.len(), 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "        assert_eq!(config.privacy.custom_patterns[0].name, \"INTERNAL_ID\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "    fn test_build_redactor_with_disabled() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "        let config = PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "            disabled_patterns: vec![\"EMAIL\".to_string()],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "            ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "        let redactor = config.build_redactor();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "        // EMAIL should be disabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "        let input = \"test@example.com\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "        assert_eq!(input, output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "        // But API_KEY should still work",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "        let input2 = \"api_key = secret123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "        assert!(output2.contains(\"[REDACTED]\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "    fn test_build_redactor_with_custom() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "        let config = PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "            use_builtin_patterns: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "            custom_patterns: vec![PatternConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "                name: \"CUSTOM\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "                pattern: r\"CUSTOM-\\d+\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "                description: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "            }],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "            ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "        let redactor = config.build_redactor();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "        // Custom pattern should work",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "        let input = \"Reference: CUSTOM-12345\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "        assert!(output.contains(\"[REDACTED]\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "        // Builtin patterns should NOT work",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "        let input2 = \"api_key = secret123\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "        let output2 = redactor.redact(input2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "        assert_eq!(input2, output2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "    fn test_disabled_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "        let config = PrivacyConfig {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "            enabled: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "            ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "        let redactor = config.build_redactor();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "        let input = \"api_key = secret123 and test@example.com\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "        let output = redactor.redact(input);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "        assert_eq!(input, output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "    fn test_load_from_file() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "        let config_path = dir.path().join(\".whogitit.toml\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "        std::fs::write(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "            &config_path,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "            r#\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "[privacy]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "enabled = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "audit_log = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "\"#,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "        )",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "        .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "        let config = WhogititConfig::load_from_file(&config_path).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        assert!(config.privacy.enabled);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "        assert!(config.privacy.audit_log);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "    fn test_load_default_when_missing() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "        let config = WhogititConfig::load(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "        // Should return defaults",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "        assert!(config.privacy.enabled);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "        assert!(!config.privacy.audit_log);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "    fn test_available_patterns() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "        let patterns = PrivacyConfig::available_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "        assert!(!patterns.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "        let names: Vec<_> = patterns.iter().map(|(name, _)| *name).collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "        assert!(names.contains(&\"API_KEY\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "        assert!(names.contains(&\"EMAIL\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "        assert!(names.contains(&\"SSN\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "        assert!(names.contains(&\"CREDIT_CARD\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "    fn test_retention_config() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "        let toml = r#\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "[retention]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "max_age_days = 365",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "auto_purge = false",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "retain_refs = [\"refs/heads/main\", \"refs/heads/release\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "min_commits = 50",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "        let config: WhogititConfig = toml::from_str(toml).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "        let retention = config.retention.unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "        assert_eq!(retention.max_age_days, Some(365));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "        assert!(!retention.auto_purge);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "        assert_eq!(retention.retain_refs.len(), 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "        assert_eq!(retention.min_commits, Some(50));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "    fn test_invalid_custom_pattern_validation() {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "        // Config with an invalid regex pattern",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": "        let config = PrivacyConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "            custom_patterns: vec![",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "                PatternConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "                    name: \"VALID\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "                    pattern: r\"\\d+\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "                    description: None,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "                },",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "                PatternConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "                    name: \"INVALID\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "                    pattern: r\"[invalid(\".to_string(), // Invalid regex",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "                    description: None,",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "                },",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "            ],",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "            ..Default::default()",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "        // Build should succeed (skipping invalid pattern)",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "        let redactor = config.build_redactor();",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "        // Only the valid custom pattern should be added (plus builtins)",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "        let names = redactor.pattern_names();",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "        assert!(names.contains(&\"VALID\"));",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "        assert!(!names.contains(&\"INVALID\"));",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "    #[test]",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "    fn test_invalid_disabled_pattern_name() {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "        // Config with an invalid disabled pattern name",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "        let config = PrivacyConfig {",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "            disabled_patterns: vec![\"NOT_A_REAL_PATTERN\".to_string()],",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "            ..Default::default()",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "        // Build should succeed (with warning logged)",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "        let redactor = config.build_redactor();",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "        // Should still have all builtin patterns (nothing was actually disabled)",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "        let names = redactor.pattern_names();",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "        assert!(names.contains(&\"API_KEY\"));",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "        assert!(names.contains(&\"EMAIL\"));",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "db083360-8049-46e9-8eee-bda3243c1123"
          },
          "edit_id": "db083360-8049-46e9-8eee-bda3243c1123",
          "prompt_index": 44,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 456,
        "ai_lines": 104,
        "ai_modified_lines": 2,
        "human_lines": 0,
        "original_lines": 350,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/storage/audit.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "//! Append-only audit log for compliance tracking",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use serde::{Deserialize, Serialize};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use std::fs::{self, File, OpenOptions};",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use std::io::{BufRead, BufReader, Write};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use std::path::{Path, PathBuf};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "use std::os::unix::fs::PermissionsExt;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "extern crate libc;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "/// Audit log directory",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "const AUDIT_DIR: &str = \".whogitit\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "/// Audit log file name",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "const AUDIT_FILE: &str = \"audit.jsonl\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "/// An audit log event",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "pub struct AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "    /// ISO8601 timestamp",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    pub timestamp: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    /// Event type",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "    pub event: AuditEventType,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    /// Additional details",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    #[serde(flatten)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "    pub details: AuditDetails,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "/// Types of audit events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize, PartialEq)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "#[serde(rename_all = \"snake_case\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "pub enum AuditEventType {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "    /// Attribution data was deleted",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "    Delete,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "    /// Attribution data was exported",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    Export,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "    /// Retention policy was applied",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "    RetentionApply,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    /// Configuration was changed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    ConfigChange,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "    /// Redaction occurred (when audit logging enabled)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "    Redaction,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "impl std::fmt::Display for AuditEventType {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "        match self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "            Self::Delete => write!(f, \"delete\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "            Self::Export => write!(f, \"export\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "            Self::RetentionApply => write!(f, \"retention_apply\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "            Self::ConfigChange => write!(f, \"config_change\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "            Self::Redaction => write!(f, \"redaction\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "/// Additional details for an audit event",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize, Default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "pub struct AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "    /// Commit ID (for delete events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "    pub commit: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "    /// Reason for the action",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    pub reason: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "    /// Export format (for export events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    pub format: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    /// Number of commits affected",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "    pub commit_count: Option<u32>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    /// Pattern name (for redaction events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    pub pattern_name: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    /// Redaction count (for redaction events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    pub redaction_count: Option<u32>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    /// Hash of the previous event (for tamper detection chain)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    pub prev_hash: Option<String>,",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    /// Hash of this event's content (for integrity verification)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    pub event_hash: Option<String>,",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "    /// User who performed the action",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "    pub user: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "/// Append-only audit log store",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "pub struct AuditLog {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "    path: PathBuf,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "impl AuditLog {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    /// Create a new audit log for the given repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "    pub fn new(repo_root: &Path) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "        let path = repo_root.join(AUDIT_DIR).join(AUDIT_FILE);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "        Self { path }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    /// Ensure the audit log directory exists",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "    fn ensure_dir(&self) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "        if let Some(parent) = self.path.parent() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "            std::fs::create_dir_all(parent).context(\"Failed to create audit directory\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "    /// Append an event to the audit log",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "    pub fn log(&self, event: AuditEvent) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "        self.ensure_dir()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "        let is_new_file = !self.path.exists();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "        let mut file = OpenOptions::new()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "            .create(true)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "            .append(true)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "            .open(&self.path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "            .context(\"Failed to open audit log\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        // Set restrictive permissions (0600) on new audit log - contains sensitive data",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "        #[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        if is_new_file {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "            let mut perms = fs::metadata(&self.path)?.permissions();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "            perms.set_mode(0o600);",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "            fs::set_permissions(&self.path, perms)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "                .context(\"Failed to set permissions on audit log\")?;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        let json = serde_json::to_string(&event)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "        writeln!(file, \"{}\", json).context(\"Failed to write to audit log\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "        // Ensure data is persisted to disk for audit integrity",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "        file.sync_all()",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 138,
          "content": "            .context(\"Failed to sync audit log to disk\")?;",
          "source": {
            "type": "AIModified",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
            "similarity": 0.7608695652173914
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 0.7608695652173914
        },
        {
          "line_number": 139,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "    /// Log a delete event",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "    pub fn log_delete(&self, commit: &str, reason: &str) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        self.log(AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "            timestamp: chrono::Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "            event: AuditEventType::Delete,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "            details: AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "                commit: Some(commit.to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "                reason: Some(reason.to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "                user: get_current_user(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "                ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "    /// Log an export event",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "    pub fn log_export(&self, format: &str, commit_count: u32) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        self.log(AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "            timestamp: chrono::Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "            event: AuditEventType::Export,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "            details: AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "                format: Some(format.to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "                commit_count: Some(commit_count),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "                user: get_current_user(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "                ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "    /// Log a retention policy application",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "    pub fn log_retention(&self, commit_count: u32, reason: &str) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        self.log(AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "            timestamp: chrono::Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "            event: AuditEventType::RetentionApply,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "            details: AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "                commit_count: Some(commit_count),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "                reason: Some(reason.to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "                user: get_current_user(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "                ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "    /// Log a redaction event",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "    pub fn log_redaction(&self, pattern_name: &str, redaction_count: u32) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "        self.log(AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "            timestamp: chrono::Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "            event: AuditEventType::Redaction,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "            details: AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "                pattern_name: Some(pattern_name.to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "                redaction_count: Some(redaction_count),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "                ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "    /// Read all events from the audit log",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "    pub fn read_all(&self) -> Result<Vec<AuditEvent>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "        if !self.path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "            return Ok(Vec::new());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "        let file = File::open(&self.path).context(\"Failed to open audit log\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "        let reader = BufReader::new(file);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "        let mut events = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "        for line in reader.lines() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "            let line = line?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "            if line.trim().is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "            if let Ok(event) = serde_json::from_str::<AuditEvent>(&line) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "                events.push(event);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "        Ok(events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "    /// Read events filtered by date range",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "    pub fn read_since(&self, since: chrono::DateTime<chrono::Utc>) -> Result<Vec<AuditEvent>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "        let all = self.read_all()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "        Ok(all",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "            .into_iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "            .filter(|e| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "                chrono::DateTime::parse_from_rfc3339(&e.timestamp)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "                    .map(|t| t >= since)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "                    .unwrap_or(false)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "            .collect())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "    /// Check if audit log exists",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "    pub fn exists(&self) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "        self.path.exists()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "    /// Get the path to the audit log",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "    pub fn path(&self) -> &Path {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "        &self.path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "    /// Log an event with hash chaining for tamper detection",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "    /// Each event includes a hash of the previous event, creating a chain",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "    /// that can be verified to detect tampering.",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "    pub fn log_with_chain(&self, mut event: AuditEvent) -> Result<()> {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "        use sha2::{Digest, Sha256};",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "        // Get the hash of the last event (if any)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "        let prev_hash = if self.path.exists() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "            self.get_last_event_hash()?",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "        } else {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "            None",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "        // Set the previous hash",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "        event.details.prev_hash = prev_hash;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "        // Calculate hash of this event's content (excluding event_hash itself)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "        let content_to_hash = format!(",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "            \"{}:{}:{:?}\",",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "            event.timestamp, event.event, event.details.commit",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 265,
          "content": "        );",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "        let mut hasher = Sha256::new();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "        hasher.update(content_to_hash.as_bytes());",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "        let hash = format!(\"{:x}\", hasher.finalize());",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "        event.details.event_hash = Some(hash[..16].to_string()); // Truncate for readability",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "        self.log(event)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "    /// Get the hash of the last event in the log",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "    fn get_last_event_hash(&self) -> Result<Option<String>> {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "        let events = self.read_all()?;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "        Ok(events.last().and_then(|e| e.details.event_hash.clone()))",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "    /// Verify the integrity of the audit log chain",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "    /// Returns Ok(true) if the chain is valid, Ok(false) if tampered,",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "    /// or an error if the log cannot be read.",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "    pub fn verify_chain(&self) -> Result<bool> {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "        let events = self.read_all()?;",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "        if events.is_empty() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "            return Ok(true);",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "        // First event should have no prev_hash",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "        if events[0].details.prev_hash.is_some() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "            return Ok(false);",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "        // Each subsequent event should reference the previous event's hash",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "        for i in 1..events.len() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "            let expected_prev = events[i - 1].details.event_hash.as_ref();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "            let actual_prev = events[i].details.prev_hash.as_ref();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "            // If either the previous event has a hash or the current expects one,",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            // they should match",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "            if expected_prev != actual_prev {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "                // Allow for legacy events without hashes",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "                if expected_prev.is_some() && actual_prev.is_some() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "                    return Ok(false);",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "        Ok(true)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "/// Get the current user name for audit trail",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "///",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "/// On Unix, validates against the actual system user ID to detect spoofing.",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "/// Falls back to USER/USERNAME environment variables on non-Unix or if validation fails.",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "fn get_current_user() -> Option<String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "    let env_user = std::env::var(\"USER\")",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "        .or_else(|_| std::env::var(\"USERNAME\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "        .ok();",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "    #[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "    {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "        // Get the actual username from the system based on UID",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "        let uid = unsafe { libc::getuid() };",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "        // Try to get the password entry for this UID",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "        let pwd = unsafe { libc::getpwuid(uid) };",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "        if !pwd.is_null() {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "            let system_user = unsafe {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "                std::ffi::CStr::from_ptr((*pwd).pw_name)",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "                    .to_string_lossy()",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "                    .to_string()",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "            };",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "            // Check if env var matches system user",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "            if let Some(ref env_name) = env_user {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "                if env_name != &system_user {",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "                    eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "                        \"whogitit: Warning - USER env var '{}' does not match system user '{}', using system user\",",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "                        env_name, system_user",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "                    );",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "            return Some(system_user);",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "    // Fallback to environment variable",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "    env_user",
          "source": {
            "type": "AI",
            "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b"
          },
          "edit_id": "c611a4ee-7824-4b2a-91a5-dd3da66f817b",
          "prompt_index": 59,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "    use tempfile::TempDir;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "    fn test_audit_log_roundtrip() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "        let log = AuditLog::new(dir.path());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "        log.log_delete(\"abc123\", \"GDPR request\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        log.log_export(\"json\", 42).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "        log.log_retention(10, \"Retention policy\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "        let events = log.read_all().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "        assert_eq!(events.len(), 3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "        assert_eq!(events[0].event, AuditEventType::Delete);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "        assert_eq!(events[1].event, AuditEventType::Export);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "        assert_eq!(events[2].event, AuditEventType::RetentionApply);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "    fn test_audit_log_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "        let log = AuditLog::new(dir.path());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "        let events = log.read_all().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "        assert!(events.is_empty());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "    fn test_audit_event_serialization() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "        let event = AuditEvent {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "            timestamp: \"2026-01-31T12:00:00Z\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "            event: AuditEventType::Delete,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "            details: AuditDetails {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "                commit: Some(\"abc123\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "                reason: Some(\"test\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "                ..Default::default()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "        let json = serde_json::to_string(&event).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "        let parsed: AuditEvent = serde_json::from_str(&json).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "        assert_eq!(parsed.event, AuditEventType::Delete);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "        assert_eq!(parsed.details.commit, Some(\"abc123\".to_string()));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 403,
        "ai_lines": 131,
        "ai_modified_lines": 1,
        "human_lines": 2,
        "original_lines": 269,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/privacy/mod.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "pub mod config;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "pub mod redaction;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "pub use config::{AnalysisConfig, PatternConfig, PrivacyConfig, RetentionConfig, WhogititConfig};",
          "source": {
            "type": "AI",
            "edit_id": "91b49d89-5386-4efe-a2eb-c4fa12fb71ae"
          },
          "edit_id": "91b49d89-5386-4efe-a2eb-c4fa12fb71ae",
          "prompt_index": 49,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "pub use redaction::{RedactionEvent, RedactionResult, Redactor};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 5,
        "ai_lines": 1,
        "ai_modified_lines": 0,
        "human_lines": 0,
        "original_lines": 4,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/capture/threeway.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use std::collections::{HashMap, HashSet};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use similar::{ChangeTag, TextDiff};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use crate::capture::snapshot::{",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "    FileAttributionResult, FileEditHistory, LineAttribution, LineSource,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "/// Default similarity threshold for AIModified detection",
          "source": {
            "type": "AI",
            "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5"
          },
          "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5",
          "prompt_index": 48,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "/// This can be overridden via config (analysis.similarity_threshold)",
          "source": {
            "type": "AI",
            "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5"
          },
          "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5",
          "prompt_index": 48,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "pub const DEFAULT_SIMILARITY_THRESHOLD: f64 = 0.6;",
          "source": {
            "type": "AI",
            "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5"
          },
          "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5",
          "prompt_index": 48,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5"
          },
          "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5",
          "prompt_index": 48,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "/// Normalize a line for comparison purposes.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "/// - Trims trailing whitespace (but preserves leading indentation)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "/// - Normalizes line endings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "/// - Handles cross-platform line ending differences",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "fn normalize_line(line: &str) -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "    line.trim_end().to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "/// Normalize a line for use as a hash key.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "/// Uses the same normalization as normalize_line.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "fn normalize_for_key(line: &str) -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    normalize_line(line)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "/// Performs three-way attribution analysis",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "/// Given:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "/// - Original content (before any AI edits)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "/// - AI edit history (sequence of AI changes)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "/// - Final content (what's being committed)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "/// Determines for each line in final content:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "/// - Was it from the original file?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "/// - Was it added by AI (and which edit/prompt)?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "/// - Was it added by AI but modified by human?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "/// - Was it added by human after AI edits?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "pub struct ThreeWayAnalyzer;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "impl ThreeWayAnalyzer {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    /// Analyze a file's final content against its edit history",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    pub fn analyze(history: &FileEditHistory, final_content: &str) -> FileAttributionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "        let final_lines: Vec<&str> = final_content.lines().collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "        // Build lookup tables for efficient matching",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "        let original_lines = build_line_set(&history.original.content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "        let ai_line_sources = build_ai_line_map(history);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "        // Analyze each line in the final content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "        let mut attributions = Vec::with_capacity(final_lines.len());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "        for (idx, line) in final_lines.iter().enumerate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "            let line_number = (idx + 1) as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "            let attribution = attribute_line(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "                line,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "                line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "                &original_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "                &ai_line_sources,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "                history,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "            attributions.push(attribution);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "        // Post-process: improve attribution using context",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "        improve_attributions_with_context(&mut attributions, history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "        let summary = FileAttributionResult::compute_summary(&attributions);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "        FileAttributionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "            path: history.path.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "            lines: attributions,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "            summary,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    /// Analyze with position-aware diff for better accuracy",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    pub fn analyze_with_diff(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "        history: &FileEditHistory,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "        final_content: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    ) -> FileAttributionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "        let final_lines: Vec<&str> = final_content.lines().collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "        let mut attributions = Vec::with_capacity(final_lines.len());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "        // If no AI edits, everything is original or human",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "        if history.edits.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "            for (idx, line) in final_lines.iter().enumerate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "                let line_number = (idx + 1) as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "                let source = if line_in_content(line, &history.original.content) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "                    LineSource::Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "                } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "                    LineSource::Human",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "                };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "                attributions.push(LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "                    line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "                    content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "                    source,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "                    edit_id: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "                    prompt_index: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "                    confidence: 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "                });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "            let summary = FileAttributionResult::compute_summary(&attributions);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "            return FileAttributionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "                path: history.path.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "                lines: attributions,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "                summary,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "        // Perform diff-based analysis",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "        // Compare: original -> final, and latest_ai -> final",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "        let latest_ai = history.latest_ai_content();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "        // Build lookup sets",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "        let original_lines = build_line_set(&history.original.content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "        let ai_line_map = build_ai_line_map(history);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "        // Track which final lines match AI content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "        let ai_to_final_mapping = diff_map_lines(&latest_ai.content, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "        // Track which final lines match original content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "        let original_to_final_mapping = diff_map_lines(&history.original.content, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "        // Build reverse map: final line index -> source",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        let mut final_line_sources: HashMap<usize, (LineSource, Option<String>, Option<u32>)> =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "            HashMap::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "        // First pass: mark lines that exist in original as Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "        // (Lines in both original and AI should be Original - they weren't changed)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "        for (_, final_idx) in &original_to_final_mapping {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "            final_line_sources.insert(*final_idx, (LineSource::Original, None, None));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "        // Second pass: mark lines from AI edits that weren't mapped from original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "        // Key insight: if a final line has position mapping from AI but NOT from original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "        // it's AI-generated - even if the content happens to match something in original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "        // (e.g., a `}` added by AI shouldn't be marked as Original just because",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "        // the original file also had a `}` at a different position)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "        for (ai_idx, final_idx) in &ai_to_final_mapping {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "            // Skip if already marked (came from original position mapping)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "            if final_line_sources.contains_key(final_idx) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "            let ai_line = latest_ai.lines().get(*ai_idx).copied().unwrap_or(\"\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "            let normalized = normalize_for_key(ai_line);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "            // This line was mapped from AI output and NOT from original position",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "            // So it's AI-generated (regardless of whether similar content exists in original)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "            if let Some((edit_id, prompt_idx)) = ai_line_map.get(&normalized) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "                final_line_sources.insert(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "                    *final_idx,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "                    (",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "                        LineSource::AI {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "                            edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "                        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "                        Some(edit_id.clone()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "                        Some(*prompt_idx),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "                    ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "                );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "        // Third pass: check unmapped lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "        for (idx, line) in final_lines.iter().enumerate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "            if final_line_sources.contains_key(&idx) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "            let normalized = normalize_for_key(line);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "            // Check if line exists in original first",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "            if original_lines.contains(&normalized) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "                final_line_sources.insert(idx, (LineSource::Original, None, None));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "            // Check if line is in AI output (but not original)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "            if let Some((edit_id, prompt_idx)) = ai_line_map.get(&normalized) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "                final_line_sources.insert(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "                    idx,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "                    (",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "                        LineSource::AI {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "                            edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "                        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "                        Some(edit_id.clone()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "                        Some(*prompt_idx),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "                    ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "                );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "            // Check if this is similar to an AI line (modified)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "            if let Some((edit_id, prompt_idx, similarity)) =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "                find_similar_ai_line(line, &ai_line_map, DEFAULT_SIMILARITY_THRESHOLD)",
          "source": {
            "type": "AI",
            "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5"
          },
          "edit_id": "de3e3ca3-9a3f-4aef-914e-98d8c3d25ea5",
          "prompt_index": 48,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "                final_line_sources.insert(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "                    idx,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "                    (",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "                        LineSource::AIModified {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "                            edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "                            similarity,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "                        },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "                        Some(edit_id),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "                        Some(prompt_idx),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "                    ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "                );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "                continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "            // New line added by human",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "            final_line_sources.insert(idx, (LineSource::Human, None, None));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "        // Build final attributions",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "        for (idx, line) in final_lines.iter().enumerate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "            let line_number = (idx + 1) as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "            let (source, edit_id, prompt_index) = final_line_sources",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "                .get(&idx)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "                .cloned()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "                .unwrap_or((LineSource::Unknown, None, None));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "            let confidence = match &source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "                LineSource::Original => 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "                LineSource::AI { .. } => 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "                LineSource::AIModified { similarity, .. } => *similarity,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "                LineSource::Human => 0.9,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "                LineSource::Unknown => 0.5,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "            attributions.push(LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "                line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "                content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "                source,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "                edit_id,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "                prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "                confidence,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "            });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "        // Post-process: improve attribution using context and block matching",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "        improve_attributions_with_context(&mut attributions, history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "        let summary = FileAttributionResult::compute_summary(&attributions);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "        FileAttributionResult {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "            path: history.path.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "            lines: attributions,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "            summary,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "/// Build a set of normalized lines from content for fast lookup",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "fn build_line_set(content: &str) -> HashSet<String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "    content.lines().map(normalize_for_key).collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "/// Build a map from normalized line content -> (edit_id, prompt_index) for all AI edits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "/// IMPORTANT: All lines in an AI edit's `after` content are considered AI-generated,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "/// not just lines that differ from `before`. This is because when AI writes/edits a file,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "/// it produces the entire output - even if some lines coincidentally match the original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "/// the AI chose to include them.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "/// Lines are normalized (trailing whitespace trimmed) to handle git/editor differences.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "fn build_ai_line_map(history: &FileEditHistory) -> HashMap<String, (String, u32)> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "    let mut map = HashMap::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "    // Process edits in order - later edits override earlier ones",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "    for edit in &history.edits {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "        // ALL lines in the AI's output are AI-generated",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "        // This ensures complete file rewrites are properly attributed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "        for line in edit.after.content.lines() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "            map.insert(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "                normalize_for_key(line),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "                (edit.edit_id.clone(), edit.prompt_index),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "    map",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "/// Check if a normalized line exists in content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "fn line_in_content(line: &str, content: &str) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "    let normalized = normalize_for_key(line);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "    content.lines().any(|l| normalize_for_key(l) == normalized)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "/// Map line indices from source to target using diff",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "fn diff_map_lines(source: &str, target: &str) -> Vec<(usize, usize)> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "    let diff = TextDiff::from_lines(source, target);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "    let mut mappings = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "    let mut source_idx = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "    let mut target_idx = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "    for change in diff.iter_all_changes() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "        match change.tag() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            ChangeTag::Equal => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "                mappings.push((source_idx, target_idx));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "                source_idx += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "                target_idx += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "            ChangeTag::Delete => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "                source_idx += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "            ChangeTag::Insert => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "                target_idx += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "    mappings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "/// Attribute a single line",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "/// Priority order:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "/// 1. Original - if line existed before AI edits and is unchanged",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "/// 2. AI - if line is in the AI edit output but NOT in original (actually changed)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "/// 3. AIModified - if line is similar to an AI line",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "/// 4. Human - line was added after AI edits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "/// All lookups use normalized line content to handle whitespace differences.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "fn attribute_line(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "    line: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "    line_number: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "    original_lines: &HashSet<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "    ai_line_sources: &HashMap<String, (String, u32)>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "    _history: &FileEditHistory,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": ") -> LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "    let normalized = normalize_for_key(line);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "    let in_original = original_lines.contains(&normalized);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "    let in_ai = ai_line_sources.get(&normalized);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "    // If line exists in original AND in AI output, it's unchanged - mark as Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "    // This prevents counting context lines that AI included but didn't change",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "    if in_original && in_ai.is_some() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "        return LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "            line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "            content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "            source: LineSource::Original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "            edit_id: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "            prompt_index: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "            confidence: 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "    // If line is in original but NOT in AI output, it's still Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "    // (The AI didn't touch this line at all)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "    if in_original {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "        return LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "            line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "            content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "            source: LineSource::Original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "            edit_id: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "            prompt_index: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "            confidence: 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "    // If line is in AI output but NOT in original, it's AI-generated",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "    if let Some((edit_id, prompt_idx)) = in_ai {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        return LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "            line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "            content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "            source: LineSource::AI {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "                edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "            edit_id: Some(edit_id.clone()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "            prompt_index: Some(*prompt_idx),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "            confidence: 1.0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "    // Check if line is similar to an AI line (human modified AI output)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "    if let Some((edit_id, prompt_idx, similarity)) =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "        find_similar_ai_line(line, ai_line_sources, 0.6)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "        return LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "            line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "            content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "            source: LineSource::AIModified {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "                edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "                similarity,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "            edit_id: Some(edit_id),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "            prompt_index: Some(prompt_idx),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "            confidence: similarity,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "    // Line doesn't exist in original or AI output - must be human-added",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "    LineAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "        line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "        content: line.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "        source: LineSource::Human,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "        edit_id: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "        prompt_index: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "        confidence: 0.9,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "/// Find a similar AI line using edit distance",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "/// Note: Empty/whitespace-only lines are handled by exact matching in attribute_line,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "/// so this function focuses on non-trivial content similarity.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "fn find_similar_ai_line(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "    line: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "    ai_lines: &HashMap<String, (String, u32)>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "    threshold: f64,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": ") -> Option<(String, u32, f64)> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "    let line_trimmed = line.trim();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "    // Empty lines should be handled by exact matching, not similarity",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "    // (empty lines match other empty lines with 100% similarity via normalize_for_key)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "    if line_trimmed.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "        return None;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "    let mut best_match: Option<(String, u32, f64)> = None;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "    for (ai_line, (edit_id, prompt_idx)) in ai_lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "        let ai_trimmed = ai_line.trim();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "        // Skip empty AI lines in similarity comparison",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "        if ai_trimmed.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "            continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "        let similarity = compute_similarity(line_trimmed, ai_trimmed);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "        if similarity >= threshold",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "            && (best_match.is_none() || similarity > best_match.as_ref().unwrap().2)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "        {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "            best_match = Some((edit_id.clone(), *prompt_idx, similarity));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "    best_match",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "/// Compute similarity between two strings (0.0 - 1.0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "fn compute_similarity(a: &str, b: &str) -> f64 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "    if a == b {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "        return 1.0;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "    if a.is_empty() || b.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "        return 0.0;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "    // Use longest common subsequence ratio",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "    let lcs_len = longest_common_subsequence(a, b);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 457,
          "content": "    let max_len = a.len().max(b.len()) as f64;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 458,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 459,
          "content": "    lcs_len as f64 / max_len",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 460,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 461,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 462,
          "content": "/// Compute length of longest common subsequence",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 463,
          "content": "fn longest_common_subsequence(a: &str, b: &str) -> usize {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 464,
          "content": "    let a_chars: Vec<char> = a.chars().collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 465,
          "content": "    let b_chars: Vec<char> = b.chars().collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 466,
          "content": "    let m = a_chars.len();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 467,
          "content": "    let n = b_chars.len();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 468,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 469,
          "content": "    // Optimization: if strings are very different in length, quick exit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 470,
          "content": "    if (m as f64 / n as f64) < 0.5 || (n as f64 / m as f64) < 0.5 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 471,
          "content": "        return 0;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 472,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 473,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 474,
          "content": "    let mut dp = vec![vec![0usize; n + 1]; m + 1];",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 475,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 476,
          "content": "    for i in 1..=m {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 477,
          "content": "        for j in 1..=n {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 478,
          "content": "            if a_chars[i - 1] == b_chars[j - 1] {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 479,
          "content": "                dp[i][j] = dp[i - 1][j - 1] + 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 480,
          "content": "            } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 481,
          "content": "                dp[i][j] = dp[i - 1][j].max(dp[i][j - 1]);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 482,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 483,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 484,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 485,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 486,
          "content": "    dp[m][n]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 487,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 488,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 489,
          "content": "/// Improve attributions using contextual information",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 490,
          "content": "fn improve_attributions_with_context(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 491,
          "content": "    attributions: &mut [LineAttribution],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 492,
          "content": "    history: &FileEditHistory,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 493,
          "content": "    _final_content: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 494,
          "content": ") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 495,
          "content": "    let len = attributions.len();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 496,
          "content": "    if len < 2 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 497,
          "content": "        return;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 498,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 499,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 500,
          "content": "    // First pass: handle unknown lines surrounded by AI lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 501,
          "content": "    for i in 1..len - 1 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 502,
          "content": "        if attributions[i].source == LineSource::Unknown {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 503,
          "content": "            let prev_edit = attributions[i - 1].edit_id.clone();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 504,
          "content": "            let next_edit = attributions[i + 1].edit_id.clone();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 505,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 506,
          "content": "            if prev_edit.is_some() && prev_edit == next_edit {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 507,
          "content": "                attributions[i].source = LineSource::AIModified {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 508,
          "content": "                    edit_id: prev_edit.clone().unwrap(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 509,
          "content": "                    similarity: 0.5,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 510,
          "content": "                };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 511,
          "content": "                attributions[i].edit_id = prev_edit;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 512,
          "content": "                attributions[i].prompt_index = attributions[i - 1].prompt_index;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 513,
          "content": "                attributions[i].confidence = 0.5;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 514,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 515,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 516,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 517,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 518,
          "content": "    // Second pass: block-level matching for reformatted code",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 519,
          "content": "    // This handles cases where formatters (rustfmt, prettier, etc.) split",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 520,
          "content": "    // a single AI-generated line into multiple lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 521,
          "content": "    improve_attributions_with_block_matching(attributions, history);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 522,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 523,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 524,
          "content": "/// Normalize a string for block comparison by collapsing whitespace",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 525,
          "content": "fn normalize_for_block_comparison(s: &str) -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 526,
          "content": "    s.split_whitespace().collect::<Vec<_>>().join(\" \")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 527,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 528,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 529,
          "content": "/// Improve attributions by matching blocks of consecutive Human lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 530,
          "content": "/// against AI-generated content.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 531,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 532,
          "content": "/// This handles the case where code formatters split a single line into multiple lines.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 533,
          "content": "/// For example, rustfmt might split:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 534,
          "content": "///   `let x = foo.bar().baz().qux();`",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 535,
          "content": "/// into:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 536,
          "content": "///   `let x = foo`",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 537,
          "content": "///   `    .bar()`",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 538,
          "content": "///   `    .baz()`",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 539,
          "content": "///   `    .qux();`",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 540,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 541,
          "content": "/// Each individual line doesn't match the AI output, but when joined they do.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 542,
          "content": "fn improve_attributions_with_block_matching(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 543,
          "content": "    attributions: &mut [LineAttribution],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 544,
          "content": "    history: &FileEditHistory,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 545,
          "content": ") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 546,
          "content": "    if attributions.is_empty() || history.edits.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 547,
          "content": "        return;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 548,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 549,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 550,
          "content": "    // Build normalized AI lines for comparison",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 551,
          "content": "    // We normalize each AI line and also create joined versions of consecutive AI lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 552,
          "content": "    let mut ai_normalized_lines: Vec<(String, String, u32)> = Vec::new(); // (normalized, edit_id, prompt_idx)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 553,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 554,
          "content": "    for edit in &history.edits {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 555,
          "content": "        for line in edit.after.content.lines() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 556,
          "content": "            let normalized = normalize_for_block_comparison(line);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 557,
          "content": "            if !normalized.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 558,
          "content": "                ai_normalized_lines.push((normalized, edit.edit_id.clone(), edit.prompt_index));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 559,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 560,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 561,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 562,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 563,
          "content": "    // Also create joined versions of consecutive AI lines (2-8 lines joined)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 564,
          "content": "    for edit in &history.edits {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 565,
          "content": "        let lines: Vec<&str> = edit.after.content.lines().collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 566,
          "content": "        for window_size in 2..=8.min(lines.len()) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 567,
          "content": "            for start in 0..=lines.len().saturating_sub(window_size) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 568,
          "content": "                let joined: String = lines[start..start + window_size]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 569,
          "content": "                    .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 570,
          "content": "                    .map(|l| normalize_for_block_comparison(l))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 571,
          "content": "                    .collect::<Vec<_>>()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 572,
          "content": "                    .join(\" \");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 573,
          "content": "                if !joined.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 574,
          "content": "                    ai_normalized_lines.push((joined, edit.edit_id.clone(), edit.prompt_index));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 575,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 576,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 577,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 578,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 579,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 580,
          "content": "    // Find blocks of consecutive unmatched lines (Human or low-confidence AIModified)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 581,
          "content": "    // Low-confidence AIModified lines are likely false positives from partial similarity matching",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 582,
          "content": "    let is_unmatched = |attr: &LineAttribution| -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 583,
          "content": "        match &attr.source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 584,
          "content": "            LineSource::Human => true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 585,
          "content": "            LineSource::Unknown => true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 586,
          "content": "            // Include AIModified with similarity < 0.85 as potentially misattributed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 587,
          "content": "            LineSource::AIModified { similarity, .. } => *similarity < 0.85,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 588,
          "content": "            _ => false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 589,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 590,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 591,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 592,
          "content": "    let mut i = 0;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 593,
          "content": "    while i < attributions.len() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 594,
          "content": "        // Find start of an unmatched block",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 595,
          "content": "        if !is_unmatched(&attributions[i]) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 596,
          "content": "            i += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 597,
          "content": "            continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 598,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 599,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 600,
          "content": "        // Find the extent of the unmatched block",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 601,
          "content": "        let block_start = i;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 602,
          "content": "        let mut block_end = i;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 603,
          "content": "        while block_end < attributions.len() && is_unmatched(&attributions[block_end]) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 604,
          "content": "            block_end += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 605,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 606,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 607,
          "content": "        let block_len = block_end - block_start;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 608,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 609,
          "content": "        // Only process blocks of 1-8 lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 610,
          "content": "        if (1..=8).contains(&block_len) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 611,
          "content": "            // Join the block content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 612,
          "content": "            let block_content: String = attributions[block_start..block_end]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 613,
          "content": "                .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 614,
          "content": "                .map(|a| normalize_for_block_comparison(&a.content))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 615,
          "content": "                .collect::<Vec<_>>()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 616,
          "content": "                .join(\" \");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 617,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 618,
          "content": "            // Find best matching AI line/block",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 619,
          "content": "            let mut best_match: Option<(f64, String, u32)> = None;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 620,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 621,
          "content": "            for (ai_normalized, edit_id, prompt_idx) in &ai_normalized_lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 622,
          "content": "                let similarity = compute_similarity(&block_content, ai_normalized);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 623,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 624,
          "content": "                // Require higher similarity for longer blocks (more confidence needed)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 625,
          "content": "                let threshold = match block_len {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 626,
          "content": "                    1 => 0.85,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 627,
          "content": "                    2 => 0.80,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 628,
          "content": "                    3..=4 => 0.75,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 629,
          "content": "                    _ => 0.70,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 630,
          "content": "                };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 631,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 632,
          "content": "                if similarity >= threshold",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 633,
          "content": "                    && (best_match.is_none() || similarity > best_match.as_ref().unwrap().0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 634,
          "content": "                {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 635,
          "content": "                    best_match = Some((similarity, edit_id.clone(), *prompt_idx));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 636,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 637,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 638,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 639,
          "content": "            // If we found a match, re-attribute all lines in the block",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 640,
          "content": "            if let Some((similarity, edit_id, prompt_idx)) = best_match {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 641,
          "content": "                for attr in attributions.iter_mut().take(block_end).skip(block_start) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 642,
          "content": "                    attr.source = LineSource::AI {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 643,
          "content": "                        edit_id: edit_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 644,
          "content": "                    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 645,
          "content": "                    attr.edit_id = Some(edit_id.clone());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 646,
          "content": "                    attr.prompt_index = Some(prompt_idx);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 647,
          "content": "                    attr.confidence = similarity;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 648,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 649,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 650,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 651,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 652,
          "content": "        i = block_end;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 653,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 654,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 655,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 656,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 657,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 658,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 659,
          "content": "    use crate::capture::snapshot::AIEdit;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 660,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 661,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 662,
          "content": "    fn test_simple_ai_addition() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 663,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"line1\\nline2\\n\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 664,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 665,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 666,
          "content": "            \"Add line3\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 667,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 668,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 669,
          "content": "            \"line1\\nline2\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 670,
          "content": "            \"line1\\nline2\\nline3\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 671,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 672,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 673,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, \"line1\\nline2\\nline3\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 674,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 675,
          "content": "        // line1 and line2 exist in both original and AI output -> Original (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 676,
          "content": "        // line3 is only in AI output -> AI (actually added by AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 677,
          "content": "        assert_eq!(result.summary.ai_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 678,
          "content": "        assert_eq!(result.summary.original_lines, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 679,
          "content": "        assert_eq!(result.summary.human_lines, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 680,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 681,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 682,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 683,
          "content": "    fn test_human_modification_after_ai() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 684,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"line1\\n\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 685,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 686,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 687,
          "content": "            \"Add lines\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 688,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 689,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 690,
          "content": "            \"line1\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 691,
          "content": "            \"line1\\nAI line\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 692,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 693,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 694,
          "content": "        // Human adds a line and modifies AI line",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 695,
          "content": "        let final_content = \"line1\\nAI line modified\\nhuman line\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 696,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 697,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 698,
          "content": "        // \"line1\" is in both original and AI output -> Original (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 699,
          "content": "        assert_eq!(result.summary.original_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 700,
          "content": "        // \"AI line modified\" should be detected as AIModified (similar to \"AI line\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 701,
          "content": "        // \"human line\" should be detected as Human (not in original or AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 702,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 703,
          "content": "            result.summary.ai_modified_lines + result.summary.human_lines,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 704,
          "content": "            2,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 705,
          "content": "            \"Should have 2 changed lines (modified + human)\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 706,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 707,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 708,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 709,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 710,
          "content": "    fn test_line_shift() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 711,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"line1\\nline2\\n\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 712,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 713,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 714,
          "content": "            \"Add AI content\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 715,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 716,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 717,
          "content": "            \"line1\\nline2\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 718,
          "content": "            \"line1\\nline2\\nAI added\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 719,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 720,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 721,
          "content": "        // Human inserts line at beginning",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 722,
          "content": "        let final_content = \"new first line\\nline1\\nline2\\nAI added\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 723,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 724,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 725,
          "content": "        // \"new first line\" is Human (not in original or AI output)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 726,
          "content": "        // \"line1\", \"line2\" are in both original and AI output -> Original (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 727,
          "content": "        // \"AI added\" is only in AI output -> AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 728,
          "content": "        assert_eq!(result.summary.human_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 729,
          "content": "        assert_eq!(result.summary.ai_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 730,
          "content": "        assert_eq!(result.summary.original_lines, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 731,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 732,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 733,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 734,
          "content": "    fn test_similarity_computation() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 735,
          "content": "        assert_eq!(compute_similarity(\"hello\", \"hello\"), 1.0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 736,
          "content": "        // Completely different strings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 737,
          "content": "        assert!(compute_similarity(\"abc\", \"xyz\") < 0.3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 738,
          "content": "        // Similar strings with comparable length should have high similarity",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 739,
          "content": "        assert!(compute_similarity(\"println(hello)\", \"println(world)\") > 0.6);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 740,
          "content": "        // Modified line detection",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 741,
          "content": "        assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 742,
          "content": "            compute_similarity(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 743,
          "content": "                \"    println!(\\\"hello\\\");\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 744,
          "content": "                \"    println!(\\\"hello, world!\\\");\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 745,
          "content": "            ) > 0.6",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 746,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 747,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 748,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 749,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 750,
          "content": "    fn test_multiple_ai_edits() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 751,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"original\\n\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 752,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 753,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 754,
          "content": "            \"First prompt\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 755,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 756,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 757,
          "content": "            \"original\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 758,
          "content": "            \"original\\nfirst AI\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 759,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 760,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 761,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 762,
          "content": "            \"Second prompt\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 763,
          "content": "            1,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 764,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 765,
          "content": "            \"original\\nfirst AI\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 766,
          "content": "            \"original\\nfirst AI\\nsecond AI\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 767,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 768,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 769,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, \"original\\nfirst AI\\nsecond AI\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 770,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 771,
          "content": "        // \"original\" is in the original file AND in AI outputs -> Original (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 772,
          "content": "        // \"first AI\" is NOT in original, added by AI -> AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 773,
          "content": "        // \"second AI\" is NOT in original, added by AI -> AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 774,
          "content": "        assert_eq!(result.summary.original_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 775,
          "content": "        assert_eq!(result.summary.ai_lines, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 776,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 777,
          "content": "        // Check that AI lines have correct prompt indices",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 778,
          "content": "        let first_ai = result",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 779,
          "content": "            .lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 780,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 781,
          "content": "            .find(|l| l.content == \"first AI\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 782,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 783,
          "content": "        // first AI appears in edit 0's output and edit 1's output, later wins",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 784,
          "content": "        assert_eq!(first_ai.prompt_index, Some(1));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 785,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 786,
          "content": "        let second_ai = result",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 787,
          "content": "            .lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 788,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 789,
          "content": "            .find(|l| l.content == \"second AI\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 790,
          "content": "            .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 791,
          "content": "        assert_eq!(second_ai.prompt_index, Some(1));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 792,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 793,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 794,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 795,
          "content": "    fn test_only_original_no_ai_edits() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 796,
          "content": "        // Test that without AI edits, original lines stay original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 797,
          "content": "        let history = FileEditHistory::new(\"test.rs\", Some(\"line1\\nline2\\n\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 798,
          "content": "        // No AI edits added",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 799,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 800,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, \"line1\\nline2\\nline3\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 801,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 802,
          "content": "        // line1, line2 are original (no AI touched them)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 803,
          "content": "        // line3 is human (added without AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 804,
          "content": "        assert_eq!(result.summary.original_lines, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 805,
          "content": "        assert_eq!(result.summary.human_lines, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 806,
          "content": "        assert_eq!(result.summary.ai_lines, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 807,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 808,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 809,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 810,
          "content": "    fn test_whitespace_normalization() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 811,
          "content": "        // Test that trailing whitespace differences don't affect attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 812,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 813,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 814,
          "content": "        // AI generates lines with trailing spaces",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 815,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 816,
          "content": "            \"Generate code\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 817,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 818,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 819,
          "content": "            \"\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 820,
          "content": "            \"fn main() {  \\n    println!(\\\"hello\\\");  \\n}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 821,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 822,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 823,
          "content": "        // Final commit has trailing spaces stripped (common git behavior)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 824,
          "content": "        let final_content = \"fn main() {\\n    println!(\\\"hello\\\");\\n}\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 825,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 826,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 827,
          "content": "        // All lines should be AI despite whitespace differences",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 828,
          "content": "        assert_eq!(result.summary.ai_lines, 3, \"All lines should be AI\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 829,
          "content": "        assert_eq!(result.summary.human_lines, 0, \"No human lines expected\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 830,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 831,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 832,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 833,
          "content": "    fn test_empty_line_attribution() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 834,
          "content": "        // Test that empty lines in AI output are properly attributed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 835,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 836,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 837,
          "content": "        // AI generates code with empty lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 838,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 839,
          "content": "            \"Generate code with spacing\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 840,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 841,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 842,
          "content": "            \"\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 843,
          "content": "            \"fn main() {\\n\\n    println!(\\\"hello\\\");\\n\\n}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 844,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 845,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 846,
          "content": "        let final_content = \"fn main() {\\n\\n    println!(\\\"hello\\\");\\n\\n}\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 847,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 848,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 849,
          "content": "        // All lines including empty ones should be AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 850,
          "content": "        assert_eq!(result.summary.ai_lines, 5, \"All 5 lines should be AI\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 851,
          "content": "        assert_eq!(result.summary.human_lines, 0, \"No human lines expected\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 852,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 853,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 854,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 855,
          "content": "    fn test_tabs_vs_spaces() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 856,
          "content": "        // Test that different indentation styles still match",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 857,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(\"\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 858,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 859,
          "content": "        // AI generates with spaces",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 860,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 861,
          "content": "            \"Generate code\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 862,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 863,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 864,
          "content": "            \"\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 865,
          "content": "            \"fn main() {\\n    code();\\n}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 866,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 867,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 868,
          "content": "        // Final uses same content (tabs would need different handling)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 869,
          "content": "        let final_content = \"fn main() {\\n    code();\\n}\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 870,
          "content": "        let result = ThreeWayAnalyzer::analyze(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 871,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 872,
          "content": "        assert_eq!(result.summary.ai_lines, 3);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 873,
          "content": "        assert_eq!(result.summary.human_lines, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 874,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 875,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 876,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 877,
          "content": "    fn test_diff_unmapped_lines_still_attributed_correctly() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 878,
          "content": "        // This test verifies that lines existing in BOTH original and AI output are Original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 879,
          "content": "        // while lines only in AI output are AI.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 880,
          "content": "        let original = \"fn foo() {\\n    old_code();\\n}\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 881,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 882,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 883,
          "content": "        // AI rewrites the function with new content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 884,
          "content": "        // \"fn foo() {\" and \"}\" exist in both original and AI output",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 885,
          "content": "        let ai_output = \"fn foo() {\\n    new_code();\\n    more_code();\\n}\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 886,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 887,
          "content": "            \"Rewrite function\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 888,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 889,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 890,
          "content": "            original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 891,
          "content": "            ai_output,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 892,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 893,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 894,
          "content": "        // Final content matches AI output exactly",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 895,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, ai_output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 896,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 897,
          "content": "        // Lines in both original AND AI output  Original (unchanged)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 898,
          "content": "        // \"fn foo() {\" and \"}\" are in both  2 Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 899,
          "content": "        // \"new_code();\" and \"more_code();\" are only in AI  2 AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 900,
          "content": "        assert_eq!(result.summary.ai_lines, 2, \"2 lines only in AI output\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 901,
          "content": "        assert_eq!(result.summary.human_lines, 0, \"No human lines expected\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 902,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 903,
          "content": "            result.summary.original_lines, 2,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 904,
          "content": "            \"2 lines unchanged from original (fn foo and closing brace)\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 905,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 906,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 907,
          "content": "        // Verify the closing brace is Original (exists in both original and AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 908,
          "content": "        let closing_brace = result.lines.iter().find(|l| l.content == \"}\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 909,
          "content": "        assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 910,
          "content": "            matches!(closing_brace.source, LineSource::Original),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 911,
          "content": "            \"Closing brace should be Original (exists in both), got {:?}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 912,
          "content": "            closing_brace.source",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 913,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 914,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 915,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 916,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 917,
          "content": "    fn test_debug_attribution_flow() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 918,
          "content": "        // Debug test to verify attribution logic",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 919,
          "content": "        let original = \"line1\\nline2\\nline3\\nline4\\nline5\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 920,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 921,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 922,
          "content": "        // First AI edit: adds line6, line7",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 923,
          "content": "        let after1 = \"line1\\nline2\\nline3\\nline4\\nline5\\nline6\\nline7\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 924,
          "content": "        history.add_edit(AIEdit::new(\"prompt1\", 0, \"Edit\", original, after1));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 925,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 926,
          "content": "        // Second AI edit: adds line8 and modifies line3",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 927,
          "content": "        let after2 = \"line1\\nline2\\nLINE3_MODIFIED\\nline4\\nline5\\nline6\\nline7\\nline8\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 928,
          "content": "        history.add_edit(AIEdit::new(\"prompt2\", 1, \"Edit\", after1, after2));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 929,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 930,
          "content": "        // Final content matches AI edit exactly",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 931,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, after2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 932,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 933,
          "content": "        println!(\"\\nAttribution results:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 934,
          "content": "        println!(\"  AI lines: {}\", result.summary.ai_lines);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 935,
          "content": "        println!(\"  AI modified lines: {}\", result.summary.ai_modified_lines);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 936,
          "content": "        println!(\"  Original lines: {}\", result.summary.original_lines);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 937,
          "content": "        println!(\"  Human lines: {}\", result.summary.human_lines);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 938,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 939,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 940,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 941,
          "content": "                \"  Line {}: {:?} - '{}'\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 942,
          "content": "                line.line_number, line.source, line.content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 943,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 944,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 945,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 946,
          "content": "        // line1, line2, line4, line5: Original (unchanged from original)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 947,
          "content": "        // LINE3_MODIFIED: AI (this line was changed by AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 948,
          "content": "        // line6, line7, line8: AI (new lines added by AI)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 949,
          "content": "        assert_eq!(result.summary.ai_lines, 4, \"4 lines actually changed by AI\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 950,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 951,
          "content": "            result.summary.original_lines, 4,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 952,
          "content": "            \"4 lines unchanged from original\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 953,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 954,
          "content": "        assert_eq!(result.summary.human_lines, 0, \"No human lines expected\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 955,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 956,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 957,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 958,
          "content": "    fn test_duplicate_lines_in_ai_output() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 959,
          "content": "        // Test that duplicate lines (like closing braces) are properly attributed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 960,
          "content": "        // This tests the real-world scenario where the same line content appears multiple times",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 961,
          "content": "        let original = r#\"fn foo() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 962,
          "content": "    code();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 963,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 964,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 965,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 966,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 967,
          "content": "        // AI adds a new function with similar structure (duplicate \"}\" and empty lines)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 968,
          "content": "        let after1 = r#\"fn foo() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 969,
          "content": "    code();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 970,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 971,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 972,
          "content": "fn bar() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 973,
          "content": "    more_code();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 974,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 975,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 976,
          "content": "        history.add_edit(AIEdit::new(\"Add bar function\", 0, \"Edit\", original, after1));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 977,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 978,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, after1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 979,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 980,
          "content": "        println!(\"\\nDuplicate lines test:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 981,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 982,
          "content": "            let source_str = match &line.source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 983,
          "content": "                LineSource::AI { .. } => \"AI\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 984,
          "content": "                LineSource::Original => \"Orig\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 985,
          "content": "                LineSource::Human => \"Human\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 986,
          "content": "                _ => \"Other\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 987,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 988,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 989,
          "content": "                \"  Line {}: {} - '{}'\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 990,
          "content": "                line.line_number, source_str, line.content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 991,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 992,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 993,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 994,
          "content": "        // Lines 1-3 (fn foo, code(), }) exist in BOTH original and AI  Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 995,
          "content": "        // Lines 4-7 (empty, fn bar, more_code(), }) are only in AI  AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 996,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 997,
          "content": "            result.summary.human_lines, 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 998,
          "content": "            \"No human lines - all are either original or AI\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 999,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1000,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1001,
          "content": "            result.summary.original_lines, 3,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1002,
          "content": "            \"3 lines unchanged from original (fn foo, code, first closing brace)\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1003,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1004,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1005,
          "content": "            result.summary.ai_lines, 4,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1006,
          "content": "            \"4 lines added by AI (empty, fn bar, more_code, second closing brace)\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1007,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1008,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1009,
          "content": "        // The closing brace \"}\" appears twice:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1010,
          "content": "        // - Line 3: from original (exists in both)  Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1011,
          "content": "        // - Line 7: added by AI (only in AI output)  AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1012,
          "content": "        let closing_braces: Vec<_> = result.lines.iter().filter(|l| l.content == \"}\").collect();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1013,
          "content": "        assert_eq!(closing_braces.len(), 2, \"Should have 2 closing braces\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1014,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1015,
          "content": "        // First closing brace (line 3) should be Original",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1016,
          "content": "        assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1017,
          "content": "            matches!(closing_braces[0].source, LineSource::Original),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1018,
          "content": "            \"First closing brace (line {}) should be Original, got {:?}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1019,
          "content": "            closing_braces[0].line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1020,
          "content": "            closing_braces[0].source",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1021,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1022,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1023,
          "content": "        // Second closing brace (line 7) should be AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1024,
          "content": "        assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1025,
          "content": "            matches!(closing_braces[1].source, LineSource::AI { .. }),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1026,
          "content": "            \"Second closing brace (line {}) should be AI, got {:?}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1027,
          "content": "            closing_braces[1].line_number,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1028,
          "content": "            closing_braces[1].source",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1029,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1030,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1031,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1032,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1033,
          "content": "    fn test_common_patterns_attributed_to_ai() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1034,
          "content": "        // Test that common patterns like empty lines, closing braces, and doc comments",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1035,
          "content": "        // are properly attributed to AI when they appear in AI output",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1036,
          "content": "        let original = \"\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1037,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1038,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1039,
          "content": "        // AI generates code with common patterns",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1040,
          "content": "        let ai_output = r#\"/// A test function",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1041,
          "content": "#[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1042,
          "content": "fn test() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1043,
          "content": "    assert!(true);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1044,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1045,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1046,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1047,
          "content": "            \"Generate test\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1048,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1049,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1050,
          "content": "            original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1051,
          "content": "            ai_output,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1052,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1053,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1054,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, ai_output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1055,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1056,
          "content": "        // All lines should be AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1057,
          "content": "        assert_eq!(result.summary.ai_lines, 5, \"All 5 lines should be AI\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1058,
          "content": "        assert_eq!(result.summary.human_lines, 0, \"No human lines\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1059,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1060,
          "content": "        // Check each line individually",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1061,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1062,
          "content": "            assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1063,
          "content": "                matches!(line.source, LineSource::AI { .. }),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1064,
          "content": "                \"Line '{}' should be AI, got {:?}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1065,
          "content": "                line.content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1066,
          "content": "                line.source",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1067,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1068,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1069,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1070,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1071,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1072,
          "content": "    fn test_block_matching_reformatted_method_chain() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1073,
          "content": "        // Test that a method chain split by rustfmt is still attributed to AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1074,
          "content": "        let original = \"\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1075,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1076,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1077,
          "content": "        // AI generates a single-line method chain",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1078,
          "content": "        let ai_output = \"let result = foo.bar().baz().qux().unwrap();\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1079,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1080,
          "content": "            \"Generate code\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1081,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1082,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1083,
          "content": "            original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1084,
          "content": "            ai_output,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1085,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1086,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1087,
          "content": "        // But the committed code has it split by rustfmt",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1088,
          "content": "        let final_content = r#\"let result = foo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1089,
          "content": "    .bar()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1090,
          "content": "    .baz()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1091,
          "content": "    .qux()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1092,
          "content": "    .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1093,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1094,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1095,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1096,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1097,
          "content": "        println!(\"\\nBlock matching test:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1098,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1099,
          "content": "            let source_str = match &line.source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1100,
          "content": "                LineSource::AI { .. } => \"AI\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1101,
          "content": "                LineSource::Human => \"Human\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1102,
          "content": "                _ => \"Other\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1103,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1104,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1105,
          "content": "                \"  Line {}: {} - '{}'\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1106,
          "content": "                line.line_number, source_str, line.content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1107,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1108,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1109,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1110,
          "content": "        // All lines should be attributed to AI via block matching",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1111,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1112,
          "content": "            result.summary.human_lines, 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1113,
          "content": "            \"No human lines - block matching should attribute all to AI\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1114,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1115,
          "content": "        assert!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1116,
          "content": "            result.summary.ai_lines >= 4,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1117,
          "content": "            \"Most lines should be AI (got {})\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1118,
          "content": "            result.summary.ai_lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1119,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1120,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1121,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1122,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1123,
          "content": "    fn test_block_matching_split_assignment() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1124,
          "content": "        // Test an assignment split across two lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1125,
          "content": "        let original = \"\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1126,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1127,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1128,
          "content": "        // AI generates a single-line assignment",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1129,
          "content": "        let ai_output =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1130,
          "content": "            \"let commit_time = DateTime::from_timestamp(commit.time().seconds(), 0).unwrap();\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1131,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1132,
          "content": "            \"Generate code\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1133,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1134,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1135,
          "content": "            original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1136,
          "content": "            ai_output,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1137,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1138,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1139,
          "content": "        // But rustfmt splits it",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1140,
          "content": "        let final_content = r#\"let commit_time =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1141,
          "content": "    DateTime::from_timestamp(commit.time().seconds(), 0).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1142,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1143,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1144,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1145,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1146,
          "content": "        println!(\"\\nSplit assignment test:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1147,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1148,
          "content": "            let source_str = match &line.source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1149,
          "content": "                LineSource::AI { .. } => \"AI\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1150,
          "content": "                LineSource::Human => \"Human\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1151,
          "content": "                LineSource::Original => \"Original\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1152,
          "content": "                LineSource::AIModified { .. } => \"AIModified\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1153,
          "content": "                LineSource::Unknown => \"Unknown\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1154,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1155,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1156,
          "content": "                \"  Line {}: {} - '{}'\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1157,
          "content": "                line.line_number, source_str, line.content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1158,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1159,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1160,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1161,
          "content": "        // Both lines should be AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1162,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1163,
          "content": "            result.summary.human_lines, 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1164,
          "content": "            \"Both lines should be AI via block matching\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1165,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1166,
          "content": "        assert_eq!(result.summary.ai_lines, 2, \"Both lines should be AI\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1167,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1168,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1169,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1170,
          "content": "    fn test_block_matching_closure_formatting() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1171,
          "content": "        // Test a closure that gets reformatted across multiple lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1172,
          "content": "        let original = \"\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1173,
          "content": "        let mut history = FileEditHistory::new(\"test.rs\", Some(original));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1174,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1175,
          "content": "        // AI generates compact closure",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1176,
          "content": "        let ai_output = \".map(|t| { t.with_timezone(&Utc).format(\\\"%Y-%m-%d\\\").to_string() })\\n\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1177,
          "content": "        history.add_edit(AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1178,
          "content": "            \"Generate code\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1179,
          "content": "            0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1180,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1181,
          "content": "            original,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1182,
          "content": "            ai_output,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1183,
          "content": "        ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1184,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1185,
          "content": "        // Rustfmt expands it",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1186,
          "content": "        let final_content = r#\".map(|t| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1187,
          "content": "    t.with_timezone(&Utc)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1188,
          "content": "        .format(\"%Y-%m-%d\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1189,
          "content": "        .to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1190,
          "content": "})",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1191,
          "content": "\"#;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1192,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1193,
          "content": "        let result = ThreeWayAnalyzer::analyze_with_diff(&history, final_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1194,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1195,
          "content": "        println!(\"\\nClosure formatting test:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1196,
          "content": "        for line in &result.lines {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1197,
          "content": "            let source_str = match &line.source {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1198,
          "content": "                LineSource::AI { .. } => \"AI\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1199,
          "content": "                LineSource::Human => \"Human\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1200,
          "content": "                _ => \"Other\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1201,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1202,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1203,
          "content": "                \"  Line {}: {} - '{}'\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1204,
          "content": "                line.line_number, source_str, line.content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1205,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1206,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1207,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1208,
          "content": "        // All lines should be AI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1209,
          "content": "        assert_eq!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1210,
          "content": "            result.summary.human_lines, 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1211,
          "content": "            \"All lines should be AI via block matching\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1212,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1213,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 1214,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 1214,
        "ai_lines": 5,
        "ai_modified_lines": 0,
        "human_lines": 0,
        "original_lines": 1209,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/cli/audit.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "//! Audit log viewing command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use chrono::{DateTime, Utc};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use colored::Colorize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use crate::storage::audit::{AuditEventType, AuditLog};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "/// Arguments for audit command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "#[derive(Debug, clap::Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "pub struct AuditArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "    /// Only show events after this date (YYYY-MM-DD)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "    pub since: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "    /// Filter by event type",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "    #[arg(long, value_parser = [\"delete\", \"export\", \"retention_apply\", \"config_change\", \"redaction\"])]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "    pub event_type: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "    /// Output as JSON",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "    pub json: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    /// Show last N events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    #[arg(long, default_value = \"50\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "    pub limit: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "/// Run the audit command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "pub fn run(args: AuditArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    let repo = git2::Repository::discover(\".\").context(\"Not in a git repository\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "    let repo_root = repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "        .workdir()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "        .ok_or_else(|| anyhow::anyhow!(\"No working directory\"))?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "    let audit_log = AuditLog::new(repo_root);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "    if !audit_log.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "        if args.json {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "            println!(\"[]\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "            println!(\"No audit log found.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "            println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "                \"Enable audit logging in .whogitit.toml: {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "                \"[privacy]\\naudit_log = true\".dimmed()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "            );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "        return Ok(());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    // Read events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    let mut events = if let Some(since_str) = &args.since {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "        let since_date = chrono::NaiveDate::parse_from_str(since_str, \"%Y-%m-%d\")",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 54,
          "content": "            .context(\"Invalid date format. Use YYYY-MM-DD.\")?;",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 55,
          "content": "        let since = since_date",
          "source": {
            "type": "AI",
            "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85"
          },
          "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85",
          "prompt_index": 26,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "            .and_hms_opt(0, 0, 0)",
          "source": {
            "type": "AI",
            "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85"
          },
          "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85",
          "prompt_index": 26,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "            .ok_or_else(|| anyhow::anyhow!(\"Invalid time for date {}\", since_str))?",
          "source": {
            "type": "AI",
            "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85"
          },
          "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85",
          "prompt_index": 26,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "            .and_utc();",
          "source": {
            "type": "AI",
            "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85"
          },
          "edit_id": "850f019e-51af-43c4-8f96-76648fac3b85",
          "prompt_index": 26,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "        audit_log.read_since(since)?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "        audit_log.read_all()?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    // Filter by event type",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "    if let Some(event_type_str) = &args.event_type {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "        let event_type = match event_type_str.as_str() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "            \"delete\" => AuditEventType::Delete,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "            \"export\" => AuditEventType::Export,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "            \"retention_apply\" => AuditEventType::RetentionApply,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "            \"config_change\" => AuditEventType::ConfigChange,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "            \"redaction\" => AuditEventType::Redaction,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "            _ => anyhow::bail!(\"Unknown event type: {}\", event_type_str),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "        events.retain(|e| e.event == event_type);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    // Sort by timestamp (newest first)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    events.sort_by(|a, b| b.timestamp.cmp(&a.timestamp));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    // Limit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    events.truncate(args.limit);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    if args.json {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "        println!(\"{}\", serde_json::to_string_pretty(&events)?);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "        print_events(&events)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "fn print_events(events: &[crate::storage::audit::AuditEvent]) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "    if events.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "        println!(\"No audit events found.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "        return Ok(());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    println!(\"{}\", \"Audit Log\".bold());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "    println!(\"{}\", \"=\".repeat(60));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "    for event in events {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "        let timestamp = DateTime::parse_from_rfc3339(&event.timestamp)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "            .map(|t| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "                t.with_timezone(&Utc)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "                    .format(\"%Y-%m-%d %H:%M:%S\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "                    .to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "            .unwrap_or_else(|_| event.timestamp.clone());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "        let event_color = match event.event {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "            AuditEventType::Delete => \"delete\".red(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "            AuditEventType::Export => \"export\".blue(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "            AuditEventType::RetentionApply => \"retention\".yellow(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "            AuditEventType::ConfigChange => \"config\".cyan(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "            AuditEventType::Redaction => \"redaction\".magenta(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "        print!(\"{} {} \", timestamp.dimmed(), event_color);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "        // Print details",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "        let details = &event.details;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "        let mut detail_parts: Vec<String> = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        if let Some(commit) = &details.commit {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "            detail_parts.push(format!(\"commit:{}\", &commit[..7.min(commit.len())]));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "        if let Some(count) = details.commit_count {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "            detail_parts.push(format!(\"commits:{}\", count));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "        if let Some(format) = &details.format {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "            detail_parts.push(format!(\"format:{}\", format));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        if let Some(pattern) = &details.pattern_name {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "            detail_parts.push(format!(\"pattern:{}\", pattern));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "        if let Some(count) = details.redaction_count {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "            detail_parts.push(format!(\"redactions:{}\", count));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "        if let Some(user) = &details.user {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "            detail_parts.push(format!(\"user:{}\", user));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "        if !detail_parts.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "            print!(\"{}\", detail_parts.join(\" \").dimmed());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "        if let Some(reason) = &details.reason {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "            print!(\" - {}\", reason);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "        println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 155,
        "ai_lines": 4,
        "ai_modified_lines": 0,
        "human_lines": 2,
        "original_lines": 149,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/cli/blame.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "use clap::Args;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use colored::Colorize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use git2::Repository;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use crate::cli::output::{format_blame, OutputFormat};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use crate::core::blame::AIBlamer;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "/// Blame command arguments",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "#[derive(Debug, Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "pub struct BlameArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "    /// File to blame",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "    pub file: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "    /// Revision to blame against (default: HEAD)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "    #[arg(short, long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "    pub revision: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "    /// Output format",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "    #[arg(long, value_enum, default_value_t = OutputFormat::Pretty)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "    pub format: OutputFormat,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "    /// Show only AI-generated lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    pub ai_only: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    /// Show only human-written lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "    pub human_only: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "/// Check if repository is a shallow clone",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "fn is_shallow_clone(repo: &Repository) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    repo.is_shallow()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "/// Print shallow clone warning",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "fn print_shallow_warning() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "        \"{} Running in shallow clone mode - some attribution data may be unavailable.\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "        \"Warning:\".yellow()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "        \"         Run '{}' to get full history.\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "        \"git fetch --unshallow\".cyan()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "    eprintln!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "/// Run the blame command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "pub fn run(args: BlameArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    // Open repository",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "    let repo = Repository::discover(\".\").context(",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "        \"Not in a git repository. \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "         Run 'git init' to create one, or 'cd' to a directory containing a .git folder.\",",
          "source": {
            "type": "AIModified",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
            "similarity": 0.9875
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 0.9875
        },
        {
          "line_number": 56,
          "content": "    )?;",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    // Check for shallow clone - warn in all formats for consistency",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "    if is_shallow_clone(&repo) {",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "        match args.format {",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "            OutputFormat::Pretty => print_shallow_warning(),",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "            OutputFormat::Json => {",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "                // For programmatic output, still warn to stderr",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "                eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "                    \"Warning: Shallow clone detected - attribution data may be incomplete. \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "                     Run 'git fetch --unshallow' for full history.\"",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    // Create blamer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    let mut blamer = AIBlamer::new(&repo).context(",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "        \"Failed to initialize blame engine. \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "         Run 'whogitit doctor' to diagnose configuration issues.\",",
          "source": {
            "type": "AIModified",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
            "similarity": 0.9824561403508771
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 0.9824561403508771
        },
        {
          "line_number": 76,
          "content": "    )?;",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    // Run blame with improved error context",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    let revision_display = args.revision.as_deref().unwrap_or(\"HEAD\");",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    let mut result = blamer",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 81,
          "content": "        .blame(&args.file, args.revision.as_deref())",
          "source": {
            "type": "AIModified",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
            "similarity": 0.6567164179104478
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 0.6567164179104478
        },
        {
          "line_number": 82,
          "content": "        .with_context(|| {",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "            format!(",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "                \"Failed to blame '{}' at revision '{}'. \\n\\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "                 Suggestions:\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "                 - Verify the file exists: git show {}:{}\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "                 - Check the revision is valid: git rev-parse {}\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "                 - Try with HEAD: whogitit blame {}\",",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "                args.file,",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "                revision_display,",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "                revision_display,",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "                args.file,",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "                revision_display,",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "                args.file",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "            )",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "        })?;",
          "source": {
            "type": "AI",
            "edit_id": "0ace856e-061e-4892-8b75-5749f1503050"
          },
          "edit_id": "0ace856e-061e-4892-8b75-5749f1503050",
          "prompt_index": 57,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    // Filter lines if requested",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "    if args.ai_only {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "        result.lines.retain(|l| l.source.is_ai());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "    } else if args.human_only {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "        result.lines.retain(|l| l.source.is_human());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "    // Format output",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "    let output = format_blame(&result, args.format);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "    print!(\"{}\", output);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 110,
        "ai_lines": 35,
        "ai_modified_lines": 3,
        "human_lines": 1,
        "original_lines": 71,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/capture/hook.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use std::env;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "use std::path::Path;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "use git2::Repository;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use serde::{Deserialize, Serialize};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "use crate::capture::pending::{PendingBuffer, PendingStore};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "use crate::capture::threeway::ThreeWayAnalyzer;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "use crate::core::attribution::{AIAttribution, PromptInfo, SessionMetadata};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "use crate::privacy::{Redactor, WhogititConfig};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "use crate::storage::notes::NotesStore;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "/// Environment variable for session ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "const ENV_SESSION_ID: &str = \"WHOGITIT_SESSION_ID\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "/// Environment variable for model ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "const ENV_MODEL_ID: &str = \"WHOGITIT_MODEL_ID\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "/// Default model if not specified",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "const DEFAULT_MODEL: &str = \"claude-opus-4-5-20251101\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "/// Context from Claude Code transcript",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize, Default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "pub struct HookContext {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    /// Whether the edit was made in plan mode",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "    pub plan_mode: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    /// Whether this is from a subagent",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "    pub is_subagent: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    /// Agent nesting depth (0=main, 1+=subagent)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "    pub agent_depth: u8,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "    /// Subagent ID if applicable",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    #[serde(skip_serializing_if = \"Option::is_none\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "    pub subagent_id: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "/// Input from Claude Code hook for file changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "pub struct HookInput {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "    /// The tool being called (Edit, Write)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    pub tool: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    /// File path being modified",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "    pub file_path: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "    /// The current user prompt/context",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    pub prompt: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "    /// Old file content (None for new files)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "    pub old_content: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    /// New file content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "    pub new_content: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    /// Context from transcript (plan mode, subagent, etc.)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "    pub context: Option<HookContext>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "/// Claude Code hook handler",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "pub struct CaptureHook {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    /// Repository root path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "    repo_root: std::path::PathBuf,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "    /// Privacy redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "    redactor: Redactor,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "    /// Whether audit logging is enabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "    audit_enabled: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "impl CaptureHook {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    /// Create a new capture hook for a repository",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    pub fn new(repo_path: &Path) -> Result<Self> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "        let repo_root = repo_path.to_path_buf();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "        // Load config and build redactor",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "        let config = WhogititConfig::load(&repo_root).unwrap_or_default();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "        let redactor = config.privacy.build_redactor();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "        let audit_enabled = config.privacy.audit_log;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "        Ok(Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "            repo_root,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "            redactor,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "            audit_enabled,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    /// Get or create session ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    fn get_session_id() -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "        env::var(ENV_SESSION_ID).unwrap_or_else(|_| uuid::Uuid::new_v4().to_string())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "    /// Get model ID from environment",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "    fn get_model_id() -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "        env::var(ENV_MODEL_ID).unwrap_or_else(|_| DEFAULT_MODEL.to_string())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "    /// Handle a file change from Claude Code",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "    pub fn on_file_change(&self, input: HookInput) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "        let store = PendingStore::new(&self.repo_root);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "        // Load or create pending buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "        let mut buffer = match store.load()? {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "            Some(b) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "                // Check if we should start a new session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "                // (different session ID in env means new session)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "                let current_session = Self::get_session_id();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "                if b.session.session_id != current_session && env::var(ENV_SESSION_ID).is_ok() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "                    // New session ID explicitly set, start fresh",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "                    // But first, warn about uncommitted changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "                    if b.has_changes() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "                        eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "                            \"whogitit: Warning - discarding {} uncommitted edits from previous session\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "                            b.total_edits()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "                        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "                    PendingBuffer::new(&current_session, &Self::get_model_id())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "                } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "                    b",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "            None => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "                let mut buffer = PendingBuffer::new(&Self::get_session_id(), &Self::get_model_id());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "                buffer.audit_logging_enabled = self.audit_enabled;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "                buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        // Make path relative to repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "        let relative_path = self.make_relative_path(&input.file_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "        // Validate input",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "        if relative_path.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "            anyhow::bail!(\"Empty file path\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "        // Check for path traversal attempts",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        if relative_path.contains(\"..\") {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "            anyhow::bail!(",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "                \"Path traversal detected in file path: '{}'. Paths containing '..' are not allowed.\",",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "                relative_path",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "            );",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "        // Check for absolute paths that escaped normalization",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "        if relative_path.starts_with('/') {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "            anyhow::bail!(",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "                \"Absolute path not allowed: '{}'. Paths must be relative to repository root.\",",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "                relative_path",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "            );",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "        if input.new_content.is_empty() && input.tool != \"Delete\" {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "            eprintln!(\"whogitit: Warning - empty new_content for non-delete operation\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "        // Determine old content: use provided value, or fall back to git HEAD",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "        let old_content = match input.old_content {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "            Some(content) => Some(content),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "            None => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "                // Try to get content from git HEAD for existing files",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "                self.get_content_from_git_head(&relative_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "        // Build edit context from hook input",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "        let edit_context =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "            input",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "                .context",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "                .as_ref()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "                .map(|ctx| crate::capture::snapshot::EditContext {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "                    plan_mode: ctx.plan_mode,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "                    subagent_id: ctx.subagent_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "                    agent_depth: ctx.agent_depth,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "                    plan_step: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "                });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        // Record the edit with full content snapshots",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "        buffer.record_edit_with_context(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "            &relative_path,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "            old_content.as_deref(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "            &input.new_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "            &input.tool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "            &input.prompt,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "            Some(&self.redactor),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "            edit_context,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "        // Save buffer with atomic write",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "        store.save(&buffer)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "    /// Get file content from git HEAD (the last committed version)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "    ///",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "    /// Returns None for new files or if git operations fail.",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "    /// Logs warnings for unexpected failures to aid debugging.",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "    fn get_content_from_git_head(&self, path: &str) -> Option<String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "        let repo = match Repository::open(&self.repo_root) {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "            Ok(r) => r,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "            Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "                eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "                    \"whogitit: Warning - failed to open repository at '{}': {}\",",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "                    self.repo_root.display(),",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "                    e",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "                return None;",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "        let head = match repo.head() {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "            Ok(h) => h,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "            Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "                // HEAD not existing is normal for new repos with no commits",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "                if e.code() != git2::ErrorCode::UnbornBranch {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "                    eprintln!(\"whogitit: Warning - failed to get HEAD: {}\", e);",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "                return None;",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "        let commit = match head.peel_to_commit() {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "            Ok(c) => c,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "            Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "                eprintln!(\"whogitit: Warning - failed to peel HEAD to commit: {}\", e);",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "                return None;",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "        let tree = match commit.tree() {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "            Ok(t) => t,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "            Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "                eprintln!(\"whogitit: Warning - failed to get commit tree: {}\", e);",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "                return None;",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "        // File not existing in HEAD is normal for new files - don't warn",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "        let entry = match tree.get_path(std::path::Path::new(path)) {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "            Ok(e) => e,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "            Err(_) => return None, // New file, not in HEAD",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "        let blob = match repo.find_blob(entry.id()) {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "            Ok(b) => b,",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "            Err(e) => {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "                eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "                    \"whogitit: Warning - failed to read blob for '{}': {}\",",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "                    path, e",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "                return None;",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "        };",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "        // Non-UTF8 content is valid for binary files - don't treat as error",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "        match std::str::from_utf8(blob.content()) {",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "            Ok(content) => Some(content.to_string()),",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "            Err(_) => None, // Binary file",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d"
          },
          "edit_id": "1f22767e-f03f-40c3-9afe-f54d997d209d",
          "prompt_index": 51,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "    /// Handle post-commit: perform three-way analysis, attach notes, and clean up",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "    pub fn on_post_commit(&self) -> Result<Option<AIAttribution>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "        let store = PendingStore::new(&self.repo_root);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "        // Load pending buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "        let buffer = match store.load()? {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "            Some(b) if b.has_changes() => b,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "            _ => return Ok(None),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "        // Open repo and get HEAD commit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "        let repo = Repository::open(&self.repo_root).context(\"Failed to open repository\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "        let head = repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "            .head()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "            .context(\"Failed to get HEAD\")?",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "            .peel_to_commit()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "            .context(\"Failed to get HEAD commit\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "        // Analyze each file with three-way diff against committed content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "        let mut file_results = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "        let tree = head.tree()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "        for (path, history) in &buffer.file_histories {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "            // Get the committed content for this file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "            let committed_content = match tree.get_path(std::path::Path::new(path)) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "                Ok(entry) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "                    let blob = repo.find_blob(entry.id())?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "                    String::from_utf8_lossy(blob.content()).to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "                Err(_) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "                    // File might have been deleted or not staged",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "                    continue;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "            };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "            // Perform three-way analysis",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "            let result = ThreeWayAnalyzer::analyze_with_diff(history, &committed_content);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "            file_results.push(result);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "        // Compute extended session metadata",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "        let used_plan_mode = buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "            .file_histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "            .values()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            .flat_map(|h| h.edits.iter())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "            .any(|e| e.context.plan_mode);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "        let subagent_count = buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "            .file_histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "            .values()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "            .flat_map(|h| h.edits.iter())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "            .filter(|e| e.context.agent_depth > 0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "            .count() as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "        // Create attribution with full analysis",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "        let attribution = AIAttribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "            version: 3,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "            session: SessionMetadata {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "                session_id: buffer.session.session_id.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "                model: buffer.session.model.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "                started_at: buffer.session.started_at.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "                prompt_count: buffer.session.prompt_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "                used_plan_mode,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "                subagent_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "            prompts: buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "                .session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "                .prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "                .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "                .map(|p| PromptInfo {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "                    index: p.index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "                    text: p.text.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "                    timestamp: p.timestamp.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "                    affected_files: p.affected_files.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "                })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "                .collect(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "            files: file_results,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "        // Store as git note",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "        let notes_store = NotesStore::new(&repo)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "        notes_store.store_attribution(head.id(), &attribution)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "        // Clean up pending file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "        store.delete()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "        // Log summary",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "        let total_ai = attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "            .files",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "            .map(|f| f.summary.ai_lines + f.summary.ai_modified_lines)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "            .sum::<usize>();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "        let total_human = attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "            .files",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "            .map(|f| f.summary.human_lines)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "            .sum::<usize>();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "        eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "            \"whogitit: Attached attribution - {} AI lines, {} human lines across {} files\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "            total_ai,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "            total_human,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "            attribution.files.len()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "        Ok(Some(attribution))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "    /// Make a path relative to the repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "    fn make_relative_path(&self, path: &str) -> Result<String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "        let abs_path = if Path::new(path).is_absolute() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "            Path::new(path).to_path_buf()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "            self.repo_root.join(path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "        let relative = abs_path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "            .strip_prefix(&self.repo_root)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "            .map(|p| p.to_string_lossy().to_string())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "            .unwrap_or_else(|_| path.to_string());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "        Ok(relative)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "    /// Get current pending status",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "    pub fn status(&self) -> Result<PendingStatus> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "        let store = PendingStore::new(&self.repo_root);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "        // Use quiet load to avoid spurious warnings during status check",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "        match store.load_quiet()? {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "            Some(buffer) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "                let session_id = buffer.session.session_id.clone();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "                let file_count = buffer.file_count();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "                let line_count = buffer.total_lines();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "                let edit_count = buffer.total_edits();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "                let prompt_count = buffer.session.prompt_count;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "                let has_pending = buffer.has_changes();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "                let is_stale = buffer.is_stale();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "                let age = buffer.age_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "                Ok(PendingStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "                    has_pending,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "                    session_id: Some(session_id),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "                    file_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "                    line_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "                    edit_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "                    prompt_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "                    is_stale,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "                    age,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "                })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "            None => Ok(PendingStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "                has_pending: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "                session_id: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "                file_count: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "                line_count: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "                edit_count: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "                prompt_count: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": "                is_stale: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "                age: String::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "            }),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "    /// Clear pending changes without committing",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "    pub fn clear_pending(&self) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "        let store = PendingStore::new(&self.repo_root);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "        store.delete()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "/// Status of pending changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "#[derive(Debug)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "pub struct PendingStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "    pub has_pending: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "    pub session_id: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "    pub file_count: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "    pub line_count: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "    pub edit_count: usize,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "    pub prompt_count: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "    /// Whether the pending buffer is stale (older than 24 hours)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "    pub is_stale: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "    /// Human-readable age of the pending buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "    pub age: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "/// Hook entry point for Claude Code integration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "pub fn run_capture_hook() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "    // Read input from stdin",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "    let input: HookInput = serde_json::from_reader(std::io::stdin())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "        .context(\"Failed to read hook input from stdin\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "    // Find repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "    let repo_root = find_repo_root()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "    // Process the change",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "    let hook = CaptureHook::new(&repo_root)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "    hook.on_file_change(input)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 457,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 458,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 459,
          "content": "/// Find the git repository root from current directory",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 460,
          "content": "fn find_repo_root() -> Result<std::path::PathBuf> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 461,
          "content": "    let current = env::current_dir()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 462,
          "content": "    let repo = Repository::discover(&current).context(\"Not in a git repository\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 463,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 464,
          "content": "    repo.workdir()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 465,
          "content": "        .map(|p| p.to_path_buf())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 466,
          "content": "        .context(\"Repository has no working directory\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 467,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 468,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 469,
          "content": "/// Git post-commit hook entry point",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 470,
          "content": "pub fn run_post_commit_hook() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 471,
          "content": "    let repo_root = find_repo_root()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 472,
          "content": "    let hook = CaptureHook::new(&repo_root)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 473,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 474,
          "content": "    hook.on_post_commit()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 475,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 476,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 477,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 478,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 479,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 480,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 481,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 482,
          "content": "    use git2::Signature;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 483,
          "content": "    use tempfile::TempDir;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 484,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 485,
          "content": "    fn create_test_repo() -> (TempDir, Repository) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 486,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 487,
          "content": "        let repo = Repository::init(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 488,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 489,
          "content": "        // Create initial commit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 490,
          "content": "        {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 491,
          "content": "            let sig = Signature::now(\"Test\", \"test@test.com\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 492,
          "content": "            let tree_id = repo.index().unwrap().write_tree().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 493,
          "content": "            let tree = repo.find_tree(tree_id).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 494,
          "content": "            repo.commit(Some(\"HEAD\"), &sig, &sig, \"Initial\", &tree, &[])",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 495,
          "content": "                .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 496,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 497,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 498,
          "content": "        (dir, repo)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 499,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 500,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 501,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 502,
          "content": "    fn test_capture_hook_on_file_change() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 503,
          "content": "        let (dir, _repo) = create_test_repo();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 504,
          "content": "        let hook = CaptureHook::new(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 505,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 506,
          "content": "        let input = HookInput {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 507,
          "content": "            tool: \"Write\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 508,
          "content": "            file_path: \"test.rs\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 509,
          "content": "            prompt: \"Create a test file\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 510,
          "content": "            old_content: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 511,
          "content": "            new_content: \"fn test() {}\\n\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 512,
          "content": "            context: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 513,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 514,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 515,
          "content": "        hook.on_file_change(input).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 516,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 517,
          "content": "        let status = hook.status().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 518,
          "content": "        assert!(status.has_pending);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 519,
          "content": "        assert_eq!(status.file_count, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 520,
          "content": "        assert_eq!(status.edit_count, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 521,
          "content": "        assert_eq!(status.prompt_count, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 522,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 523,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 524,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 525,
          "content": "    fn test_capture_hook_multiple_edits() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 526,
          "content": "        let (dir, _repo) = create_test_repo();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 527,
          "content": "        let hook = CaptureHook::new(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 528,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 529,
          "content": "        // First edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 530,
          "content": "        hook.on_file_change(HookInput {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 531,
          "content": "            tool: \"Write\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 532,
          "content": "            file_path: \"test.rs\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 533,
          "content": "            prompt: \"Create file\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 534,
          "content": "            old_content: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 535,
          "content": "            new_content: \"line1\\n\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 536,
          "content": "            context: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 537,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 538,
          "content": "        .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 539,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 540,
          "content": "        // Second edit to same file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 541,
          "content": "        hook.on_file_change(HookInput {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 542,
          "content": "            tool: \"Edit\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 543,
          "content": "            file_path: \"test.rs\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 544,
          "content": "            prompt: \"Add line\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 545,
          "content": "            old_content: Some(\"line1\\n\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 546,
          "content": "            new_content: \"line1\\nline2\\n\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 547,
          "content": "            context: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 548,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 549,
          "content": "        .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 550,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 551,
          "content": "        let status = hook.status().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 552,
          "content": "        assert_eq!(status.file_count, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 553,
          "content": "        assert_eq!(status.edit_count, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 554,
          "content": "        assert_eq!(status.prompt_count, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 555,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 556,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 557,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 558,
          "content": "    fn test_capture_hook_status_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 559,
          "content": "        let (dir, _repo) = create_test_repo();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 560,
          "content": "        let hook = CaptureHook::new(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 561,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 562,
          "content": "        let status = hook.status().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 563,
          "content": "        assert!(!status.has_pending);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 564,
          "content": "        assert_eq!(status.file_count, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 565,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 566,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 567,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 568,
          "content": "    fn test_capture_hook_clear() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 569,
          "content": "        let (dir, _repo) = create_test_repo();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 570,
          "content": "        let hook = CaptureHook::new(dir.path()).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 571,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 572,
          "content": "        // Add a change",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 573,
          "content": "        hook.on_file_change(HookInput {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 574,
          "content": "            tool: \"Write\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 575,
          "content": "            file_path: \"test.rs\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 576,
          "content": "            prompt: \"test\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 577,
          "content": "            old_content: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 578,
          "content": "            new_content: \"content\\n\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 579,
          "content": "            context: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 580,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 581,
          "content": "        .unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 582,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 583,
          "content": "        assert!(hook.status().unwrap().has_pending);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 584,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 585,
          "content": "        // Clear",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 586,
          "content": "        hook.clear_pending().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 587,
          "content": "        assert!(!hook.status().unwrap().has_pending);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 588,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 589,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 589,
        "ai_lines": 81,
        "ai_modified_lines": 0,
        "human_lines": 0,
        "original_lines": 508,
        "unknown_lines": 0
      }
    },
    {
      "path": "Cargo.toml",
      "lines": [
        {
          "line_number": 1,
          "content": "[package]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "name = \"whogitit\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "version = \"0.1.0\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "edition = \"2021\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "description = \"Track AI-generated code at line-level granularity\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "license = \"MIT\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "repository = \"https://github.com/dotsetlabs/whogitit\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "homepage = \"https://github.com/dotsetlabs/whogitit\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "readme = \"README.md\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "keywords = [\"git\", \"ai\", \"attribution\", \"cli\", \"blame\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "categories = [\"command-line-utilities\", \"development-tools\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "rust-version = \"1.70\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "[dependencies]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "git2 = \"0.18\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "clap = { version = \"4\", features = [\"derive\"] }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "serde = { version = \"1\", features = [\"derive\"] }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "serde_json = \"1\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "similar = \"2\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "anyhow = \"1\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "chrono = { version = \"0.4\", features = [\"serde\"] }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "sha2 = \"0.10\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "colored = \"2\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "regex = \"1\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "uuid = { version = \"1\", features = [\"v4\"] }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "toml = \"0.8\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "dirs = \"5\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "[target.'cfg(unix)'.dependencies]",
          "source": {
            "type": "AI",
            "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2"
          },
          "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2",
          "prompt_index": 12,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "libc = \"0.2\"",
          "source": {
            "type": "AI",
            "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2"
          },
          "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2",
          "prompt_index": 12,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2"
          },
          "edit_id": "238620f4-bf50-4046-92ee-6dd8ed8382a2",
          "prompt_index": 12,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "[dev-dependencies]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "tempfile = \"3\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "[profile.release]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "lto = \"thin\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "codegen-units = 1",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "strip = true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "opt-level = 3",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 39,
        "ai_lines": 3,
        "ai_modified_lines": 0,
        "human_lines": 0,
        "original_lines": 36,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/cli/show.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "use clap::Args;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use colored::Colorize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use git2::Repository;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "use crate::cli::output::OutputFormat;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use crate::storage::notes::NotesStore;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "use crate::utils::{truncate, SHORT_COMMIT_LEN};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "/// Show command arguments",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "#[derive(Debug, Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "pub struct ShowArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "    /// Commit to show (default: HEAD)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "    #[arg(default_value = \"HEAD\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "    pub commit: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "    /// Output format",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "    #[arg(long, value_enum, default_value_t = OutputFormat::Pretty)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "    pub format: OutputFormat,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "/// Run the show command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "pub fn run(args: ShowArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "    // Open repository",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    let repo = Repository::discover(\".\").context(",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "        \"Not in a git repository. \\",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "         Run 'git init' to create one, or 'cd' to a directory containing a .git folder.\",",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 0.9875
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 0.9875
        },
        {
          "line_number": 28,
          "content": "    )?;",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    // Resolve commit reference",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "    let obj = repo.revparse_single(&args.commit).with_context(|| {",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 32,
          "content": "        format!(",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 1.0
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "            \"Failed to resolve '{}'. \\n\\",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 1.0
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "                 Suggestions:\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "                 - Use a valid commit SHA: whogitit show abc1234\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "                 - Use HEAD for latest: whogitit show HEAD\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "                 - Use a branch name: whogitit show main\\n  \\",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "                 - Use HEAD~N for parent: whogitit show HEAD~1\",",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "            args.commit",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 1.0
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "        )",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 1.0
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "    })?;",
          "source": {
            "type": "AIModified",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
            "similarity": 1.0
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    let commit = obj",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "        .peel_to_commit()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "        .with_context(|| format!(\"'{}' is not a valid commit reference\", args.commit))?;",
          "source": {
            "type": "AI",
            "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7"
          },
          "edit_id": "9bff6d2a-8a9a-4d3d-80c9-e043503c26c7",
          "prompt_index": 53,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    let commit_id = commit.id().to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "    // Safe substring: commit IDs are hex strings (ASCII), but we still use min() for safety",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "    let commit_short = &commit_id[..commit_id.len().min(SHORT_COMMIT_LEN)];",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "    // Get attribution",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    let notes_store = NotesStore::new(&repo)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    let attribution = notes_store.fetch_attribution(commit.id())?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "    match attribution {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "        Some(attr) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "            if args.format == OutputFormat::Json {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "                println!(\"{}\", serde_json::to_string_pretty(&attr)?);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "            } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "                print_summary(commit_short, &attr);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "        None => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "            if args.format == OutputFormat::Json {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "                // Output null JSON for programmatic consumption",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "                println!(\"null\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "            } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "                println!(\"No AI attribution found for commit {}\", commit_short);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "                println!(\"This commit was not made with AI assistance tracked by whogitit.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "fn print_summary(commit_short: &str, attr: &crate::core::attribution::AIAttribution) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    println!(\"{}: {}\", \"Commit\".bold(), commit_short.yellow());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    println!(\"{}: {}\", \"Session\".bold(), attr.session.session_id.cyan());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    println!(\"{}: {}\", \"Model\".bold(), attr.session.model.id);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    println!(\"{}: {}\", \"Started\".bold(), attr.session.started_at.dimmed());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    // Show prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    if !attr.prompts.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "        println!(\"{}\", \"Prompts used:\".bold());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "        for prompt in &attr.prompts {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "            let preview = truncate(&prompt.text, 60);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "            println!(\"  #{}: \\\"{}\\\"\", prompt.index, preview.dimmed());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "        println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "    // Show files with detailed breakdown",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "    println!(\"{}\", \"Files with AI changes:\".bold());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "    let mut total_ai = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "    let mut total_ai_modified = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    let mut total_human = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "    let mut total_original = 0usize;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "    for file in &attr.files {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "        let s = &file.summary;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "        total_ai += s.ai_lines;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "        total_ai_modified += s.ai_modified_lines;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "        total_human += s.human_lines;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "        total_original += s.original_lines;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "        // Color-coded breakdown",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "        let ai_str = format!(\"{} AI\", s.ai_lines).green();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "        let modified_str = if s.ai_modified_lines > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "            format!(\", {} modified\", s.ai_modified_lines)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "                .yellow()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "                .to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "            String::new()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "        let human_str = if s.human_lines > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "            format!(\", {} human\", s.human_lines).blue().to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "            String::new()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "        let original_str = if s.original_lines > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "            format!(\", {} original\", s.original_lines)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "                .dimmed()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "                .to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "            String::new()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "        println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "            \"  {} ({}{}{}{}) - {} total lines\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "            file.path, ai_str, modified_str, human_str, original_str, s.total_lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "    println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "    println!(\"{}\", \"Summary:\".bold());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "    println!(\"  {} AI-generated lines\", total_ai.to_string().green());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "    if total_ai_modified > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "        println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "            \"  {} AI lines modified by human\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "            total_ai_modified.to_string().yellow()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "    if total_human > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "        println!(\"  {} human-added lines\", total_human.to_string().blue());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "    if total_original > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "        println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "            \"  {} original/unchanged lines\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "            total_original.to_string().dimmed()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 154,
        "ai_lines": 9,
        "ai_modified_lines": 6,
        "human_lines": 1,
        "original_lines": 138,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/cli/setup.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "//! Setup and doctor commands for whogitit configuration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "//!",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "//! The `setup` command handles one-time global configuration:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "//! - Installing the capture hook script to ~/.claude/hooks/",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "//! - Configuring Claude Code settings.json with hook configuration",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "//!",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "//! The `doctor` command verifies the configuration is correct.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "use std::fs;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "use std::path::PathBuf;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "use serde_json::{json, Value};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "use std::os::unix::fs::PermissionsExt;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "/// The embedded capture hook script",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "pub const CAPTURE_HOOK_SCRIPT: &str = include_str!(\"../../hooks/whogitit-capture.sh\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "/// Get the Claude configuration directory path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "///",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "/// Returns None if home directory cannot be determined (e.g., in containerized environments).",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "pub fn claude_config_dir() -> Option<PathBuf> {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "    dirs::home_dir().map(|h| h.join(\".claude\"))",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "/// Get the Claude configuration directory path, or error if unavailable",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "pub fn claude_config_dir_required() -> Result<PathBuf> {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "    claude_config_dir().ok_or_else(|| {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "        anyhow::anyhow!(",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "            \"Could not determine home directory. Set HOME environment variable or run with --help for alternatives.\"",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "        )",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    })",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "/// Get the Claude hooks directory path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "pub fn claude_hooks_dir() -> Option<PathBuf> {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    claude_config_dir().map(|c| c.join(\"hooks\"))",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "/// Get the Claude settings.json path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "pub fn claude_settings_path() -> Option<PathBuf> {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "    claude_config_dir().map(|c| c.join(\"settings.json\"))",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "/// Get the capture hook script path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "pub fn capture_hook_path() -> Option<PathBuf> {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    claude_hooks_dir().map(|h| h.join(\"whogitit-capture.sh\"))",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "/// The hook configuration that needs to be in settings.json",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "fn hook_configuration() -> Value {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "    json!({",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "        \"PreToolUse\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "                \"matcher\": \"Edit|Write|Bash\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "                \"hooks\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "                    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "                        \"type\": \"command\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "                        \"command\": \"WHOGITIT_HOOK_PHASE=pre ~/.claude/hooks/whogitit-capture.sh\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "                ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "        ],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "        \"PostToolUse\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "                \"matcher\": \"Edit|Write|Bash\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "                \"hooks\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "                    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "                        \"type\": \"command\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "                        \"command\": \"WHOGITIT_HOOK_PHASE=post ~/.claude/hooks/whogitit-capture.sh\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "                ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "        ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "/// Check if whogitit hooks are already configured in a settings value",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "fn has_whogitit_hooks(settings: &Value) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    if let Some(hooks) = settings.get(\"hooks\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "        // Check PreToolUse for whogitit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "        if let Some(pre_hooks) = hooks.get(\"PreToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "            if let Some(arr) = pre_hooks.as_array() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "                for entry in arr {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "                    if let Some(inner_hooks) = entry.get(\"hooks\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "                        if let Some(inner_arr) = inner_hooks.as_array() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "                            for hook in inner_arr {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "                                if let Some(cmd) = hook.get(\"command\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "                                    if let Some(cmd_str) = cmd.as_str() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "                                        if cmd_str.contains(\"whogitit\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "                                            return true;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "                                        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "                                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "                                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "                            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "                        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    false",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "/// Merge whogitit hooks into existing settings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "fn merge_hooks_into_settings(mut settings: Value) -> Value {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "    let hook_config = hook_configuration();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "    // Ensure hooks object exists",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "    if settings.get(\"hooks\").is_none() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "        settings[\"hooks\"] = json!({});",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "    let hooks = settings[\"hooks\"].as_object_mut().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "    // Merge PreToolUse",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "    if let Some(pre_hooks) = hook_config.get(\"PreToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "        if hooks.contains_key(\"PreToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "            // Append to existing array",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "            if let Some(existing) = hooks.get_mut(\"PreToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "                if let Some(arr) = existing.as_array_mut() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "                    if let Some(new_hooks) = pre_hooks.as_array() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "                        arr.extend(new_hooks.iter().cloned());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "            hooks.insert(\"PreToolUse\".to_string(), pre_hooks.clone());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "    // Merge PostToolUse",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "    if let Some(post_hooks) = hook_config.get(\"PostToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "        if hooks.contains_key(\"PostToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "            // Append to existing array",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "            if let Some(existing) = hooks.get_mut(\"PostToolUse\") {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "                if let Some(arr) = existing.as_array_mut() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "                    if let Some(new_hooks) = post_hooks.as_array() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "                        arr.extend(new_hooks.iter().cloned());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "            hooks.insert(\"PostToolUse\".to_string(), post_hooks.clone());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "    settings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "/// Result of checking setup status",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "#[derive(Debug, Clone)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "pub struct SetupStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "    pub hook_script_installed: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "    pub hook_script_executable: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "    pub settings_configured: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "    pub claude_dir_exists: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "impl SetupStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "    /// Check if global setup is complete",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "    pub fn is_complete(&self) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "        self.hook_script_installed && self.hook_script_executable && self.settings_configured",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "/// Check the current setup status",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "pub fn check_setup_status() -> SetupStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "    let claude_dir = match claude_config_dir() {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "        Some(dir) => dir,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        None => {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "            return SetupStatus {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "                hook_script_installed: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "                hook_script_executable: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "                settings_configured: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "                claude_dir_exists: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "            };",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "    };",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "    let hook_path = claude_dir.join(\"hooks\").join(\"whogitit-capture.sh\");",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "    let settings_path = claude_dir.join(\"settings.json\");",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "    let claude_dir_exists = claude_dir.exists();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "    let hook_script_installed = hook_path.exists();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "    let hook_script_executable = if hook_script_installed {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "        #[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "        {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "            fs::metadata(&hook_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "                .map(|m| m.permissions().mode() & 0o111 != 0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "                .unwrap_or(false)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "        #[cfg(not(unix))]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "        {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "            true // Windows doesn't need execute permission",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "        false",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "    let settings_configured = if settings_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "        fs::read_to_string(&settings_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "            .ok()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "            .and_then(|content| serde_json::from_str::<Value>(&content).ok())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "            .map(|settings| has_whogitit_hooks(&settings))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "            .unwrap_or(false)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "        false",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "    SetupStatus {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "        hook_script_installed,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "        hook_script_executable,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "        settings_configured,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "        claude_dir_exists,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "/// Install the capture hook script",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "fn install_hook_script() -> Result<bool> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "    let hooks_dir =",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 225,
          "content": "        claude_hooks_dir().ok_or_else(|| anyhow::anyhow!(\"Could not determine home directory\"))?;",
          "source": {
            "type": "AIModified",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
            "similarity": 0.797752808988764
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 0.797752808988764
        },
        {
          "line_number": 226,
          "content": "    let hook_path = hooks_dir.join(\"whogitit-capture.sh\");",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "    // Create hooks directory if needed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "    if !hooks_dir.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "        fs::create_dir_all(&hooks_dir).context(\"Failed to create ~/.claude/hooks directory\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "    // Check if already installed with same content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "    if hook_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "        let existing = fs::read_to_string(&hook_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "        if existing == CAPTURE_HOOK_SCRIPT {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "            return Ok(false); // Already up to date",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "    // Write the hook script",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "    fs::write(&hook_path, CAPTURE_HOOK_SCRIPT).context(\"Failed to write capture hook script\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "    // Make executable on Unix",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "    #[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "        let mut perms = fs::metadata(&hook_path)?.permissions();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "        perms.set_mode(0o755);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "        fs::set_permissions(&hook_path, perms)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "    Ok(true)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "/// Configure Claude Code settings.json",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "fn configure_settings() -> Result<bool> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "    let claude_dir =",
          "source": {
            "type": "Human"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 0.9
        },
        {
          "line_number": 258,
          "content": "        claude_config_dir().ok_or_else(|| anyhow::anyhow!(\"Could not determine home directory\"))?;",
          "source": {
            "type": "AIModified",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
            "similarity": 0.7888888888888889
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 0.7888888888888889
        },
        {
          "line_number": 259,
          "content": "    let settings_path = claude_dir.join(\"settings.json\");",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "    // Create .claude directory if needed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "    if !claude_dir.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "        fs::create_dir_all(&claude_dir).context(\"Failed to create ~/.claude directory\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "    // Load existing settings or create new",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "    let settings: Value = if settings_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "        let content = fs::read_to_string(&settings_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "        serde_json::from_str(&content).unwrap_or_else(|_| json!({}))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "        json!({})",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "    // Check if already configured",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "    if has_whogitit_hooks(&settings) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "        return Ok(false); // Already configured",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "    // Backup existing settings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "    if settings_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "        let backup_path = claude_dir.join(\"settings.json.backup\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "        fs::copy(&settings_path, &backup_path).context(\"Failed to backup settings.json\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "    // Merge and write new settings",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "    let new_settings = merge_hooks_into_settings(settings);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "    let formatted = serde_json::to_string_pretty(&new_settings)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "    fs::write(&settings_path, formatted).context(\"Failed to write settings.json\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "    Ok(true)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "/// Run the setup command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "pub fn run_setup() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "    println!(\"Setting up whogitit for Claude Code...\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "    // Install hook script",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "    match install_hook_script() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "        Ok(true) => println!(\"  Installed capture hook to ~/.claude/hooks/whogitit-capture.sh\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "        Ok(false) => println!(\"  Capture hook already installed and up to date.\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "        Err(e) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            return Err(e.context(\"Failed to install capture hook\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "    // Configure settings.json",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "    match configure_settings() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "        Ok(true) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "            println!(\"  Configured Claude Code hooks in ~/.claude/settings.json\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "            println!(\"    (Previous settings backed up to settings.json.backup)\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "        Ok(false) => println!(\"  Claude Code hooks already configured.\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "        Err(e) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "            return Err(e.context(\"Failed to configure Claude Code settings\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "    println!(\"\\nGlobal setup complete!\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "    println!(\"\\nNext steps:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "    println!(\"  1. Run 'whogitit init' in each repository you want to track\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "    println!(\"  2. Use Claude Code normally - AI attribution will be captured automatically\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "    println!(\"\\nRun 'whogitit doctor' to verify your configuration at any time.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "/// Result of a single doctor check",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "#[derive(Debug)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "pub struct DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "    pub name: &'static str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "    pub passed: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "    pub message: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "    pub fix_hint: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "/// Run the doctor command",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "pub fn run_doctor() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "    println!(\"Checking whogitit configuration...\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "    let mut checks: Vec<DoctorCheck> = Vec::new();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "    let mut all_passed = true;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "    // Check 1: whogitit binary",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "    checks.push(check_binary());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "    // Check 2: Capture hook installed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "    checks.push(check_hook_installed());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "    // Check 3: Capture hook executable",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "    checks.push(check_hook_executable());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "    // Check 4: Claude settings configured",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "    checks.push(check_settings_configured());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "    // Check 5: Required tools (jq)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "    checks.push(check_required_tools());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "    // Check 6: Git repo (if in one)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "    if let Some(repo_check) = check_git_repo() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "        checks.push(repo_check);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "    // Display results",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "    for check in &checks {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "        let status = if check.passed { \"[OK]\" } else { \"[FAIL]\" };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "        println!(\"{} {}: {}\", status, check.name, check.message);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        if !check.passed {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "            all_passed = false;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "            if let Some(hint) = &check.fix_hint {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "                println!(\"   Fix: {}\", hint);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "    println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "    if all_passed {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "        println!(\"All checks passed! whogitit is properly configured.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "        println!(\"Some checks failed. Run 'whogitit setup' to fix configuration issues.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "fn check_binary() -> DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "    // The binary is obviously available if we're running",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "    DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "        name: \"whogitit binary\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "        passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "        message: \"Installed and running\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "        fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "fn check_hook_installed() -> DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 397,
          "content": "    let hook_path = match capture_hook_path() {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "        Some(p) => p,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "        None => {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "            return DoctorCheck {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "                name: \"Capture hook\",",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "                passed: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "                message: \"Cannot determine home directory\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "                fix_hint: Some(\"Set HOME environment variable\".to_string()),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "    };",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "    if hook_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "        // Also check if it's the current version",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "        let is_current = fs::read_to_string(&hook_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "            .map(|content| content == CAPTURE_HOOK_SCRIPT)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "            .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": "        if is_current {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "            DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "                name: \"Capture hook\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "                passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "                message: format!(\"Installed at {}\", hook_path.display()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "                fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "            DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "                name: \"Capture hook\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "                passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "                message: \"Installed but outdated\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "                fix_hint: Some(\"Run 'whogitit setup' to update\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "            name: \"Capture hook\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "            message: \"Not installed\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "            fix_hint: Some(\"Run 'whogitit setup' to install\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "fn check_hook_executable() -> DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "    let hook_path = match capture_hook_path() {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "        Some(p) => p,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "        None => {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "            return DoctorCheck {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "                name: \"Hook permissions\",",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "                passed: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "                message: \"Cannot determine home directory\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "                fix_hint: Some(\"Set HOME environment variable\".to_string()),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "    };",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "    if !hook_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "        return DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "            name: \"Hook permissions\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 457,
          "content": "            message: \"Hook not installed\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 458,
          "content": "            fix_hint: Some(\"Run 'whogitit setup'\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 459,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 460,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 461,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 462,
          "content": "    #[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 463,
          "content": "    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 464,
          "content": "        let executable = fs::metadata(&hook_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 465,
          "content": "            .map(|m| m.permissions().mode() & 0o111 != 0)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 466,
          "content": "            .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 467,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 468,
          "content": "        if executable {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 469,
          "content": "            DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 470,
          "content": "                name: \"Hook permissions\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 471,
          "content": "                passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 472,
          "content": "                message: \"Executable\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 473,
          "content": "                fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 474,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 475,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 476,
          "content": "            DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 477,
          "content": "                name: \"Hook permissions\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 478,
          "content": "                passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 479,
          "content": "                message: \"Not executable\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 480,
          "content": "                fix_hint: Some(format!(\"Run 'chmod +x {}'\", hook_path.display())),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 481,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 482,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 483,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 484,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 485,
          "content": "    #[cfg(not(unix))]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 486,
          "content": "    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 487,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 488,
          "content": "            name: \"Hook permissions\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 489,
          "content": "            passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 490,
          "content": "            message: \"OK (Windows)\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 491,
          "content": "            fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 492,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 493,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 494,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 495,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 496,
          "content": "fn check_settings_configured() -> DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 497,
          "content": "    let settings_path = match claude_settings_path() {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 498,
          "content": "        Some(p) => p,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 499,
          "content": "        None => {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 500,
          "content": "            return DoctorCheck {",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 501,
          "content": "                name: \"Claude Code settings\",",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 502,
          "content": "                passed: false,",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 503,
          "content": "                message: \"Cannot determine home directory\".to_string(),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 504,
          "content": "                fix_hint: Some(\"Set HOME environment variable\".to_string()),",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 505,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 506,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 507,
          "content": "    };",
          "source": {
            "type": "AI",
            "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b"
          },
          "edit_id": "8ce0743a-a2b9-498d-a0a2-c219d18bbb7b",
          "prompt_index": 25,
          "confidence": 1.0
        },
        {
          "line_number": 508,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 509,
          "content": "    if !settings_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 510,
          "content": "        return DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 511,
          "content": "            name: \"Claude Code settings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 512,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 513,
          "content": "            message: \"settings.json not found\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 514,
          "content": "            fix_hint: Some(\"Run 'whogitit setup' to configure\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 515,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 516,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 517,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 518,
          "content": "    let content = match fs::read_to_string(&settings_path) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 519,
          "content": "        Ok(c) => c,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 520,
          "content": "        Err(_) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 521,
          "content": "            return DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 522,
          "content": "                name: \"Claude Code settings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 523,
          "content": "                passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 524,
          "content": "                message: \"Cannot read settings.json\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 525,
          "content": "                fix_hint: Some(\"Check file permissions\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 526,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 527,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 528,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 529,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 530,
          "content": "    let settings: Value = match serde_json::from_str(&content) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 531,
          "content": "        Ok(v) => v,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 532,
          "content": "        Err(_) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 533,
          "content": "            return DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 534,
          "content": "                name: \"Claude Code settings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 535,
          "content": "                passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 536,
          "content": "                message: \"Invalid JSON in settings.json\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 537,
          "content": "                fix_hint: Some(\"Check settings.json syntax\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 538,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 539,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 540,
          "content": "    };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 541,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 542,
          "content": "    if has_whogitit_hooks(&settings) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 543,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 544,
          "content": "            name: \"Claude Code settings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 545,
          "content": "            passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 546,
          "content": "            message: \"Hooks configured\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 547,
          "content": "            fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 548,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 549,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 550,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 551,
          "content": "            name: \"Claude Code settings\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 552,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 553,
          "content": "            message: \"whogitit hooks not configured\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 554,
          "content": "            fix_hint: Some(\"Run 'whogitit setup' to configure\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 555,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 556,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 557,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 558,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 559,
          "content": "fn check_required_tools() -> DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 560,
          "content": "    // Check for jq which is required by the hook script",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 561,
          "content": "    let jq_available = std::process::Command::new(\"jq\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 562,
          "content": "        .arg(\"--version\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 563,
          "content": "        .output()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 564,
          "content": "        .map(|o| o.status.success())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 565,
          "content": "        .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 566,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 567,
          "content": "    if jq_available {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 568,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 569,
          "content": "            name: \"Required tools (jq)\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 570,
          "content": "            passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 571,
          "content": "            message: \"Available\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 572,
          "content": "            fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 573,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 574,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 575,
          "content": "        DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 576,
          "content": "            name: \"Required tools (jq)\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 577,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 578,
          "content": "            message: \"jq not found\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 579,
          "content": "            fix_hint: Some(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 580,
          "content": "                \"Install jq: brew install jq (macOS) or apt install jq (Linux)\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 581,
          "content": "            ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 582,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 583,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 584,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 585,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 586,
          "content": "fn check_git_repo() -> Option<DoctorCheck> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 587,
          "content": "    // Only check if we're in a git repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 588,
          "content": "    let repo = git2::Repository::discover(\".\").ok()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 589,
          "content": "    let repo_root = repo.workdir()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 590,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 591,
          "content": "    let hooks_dir = repo_root.join(\".git/hooks\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 592,
          "content": "    let post_commit = hooks_dir.join(\"post-commit\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 593,
          "content": "    let pre_push = hooks_dir.join(\"pre-push\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 594,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 595,
          "content": "    let post_commit_ok = post_commit.exists()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 596,
          "content": "        && fs::read_to_string(&post_commit)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 597,
          "content": "            .map(|c| c.contains(\"whogitit\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 598,
          "content": "            .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 599,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 600,
          "content": "    let pre_push_ok = pre_push.exists()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 601,
          "content": "        && fs::read_to_string(&pre_push)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 602,
          "content": "            .map(|c| c.contains(\"whogitit\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 603,
          "content": "            .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 604,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 605,
          "content": "    if post_commit_ok && pre_push_ok {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 606,
          "content": "        Some(DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 607,
          "content": "            name: \"Repository hooks\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 608,
          "content": "            passed: true,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 609,
          "content": "            message: \"Initialized in current repo\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 610,
          "content": "            fix_hint: None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 611,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 612,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 613,
          "content": "        Some(DoctorCheck {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 614,
          "content": "            name: \"Repository hooks\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 615,
          "content": "            passed: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 616,
          "content": "            message: \"Not initialized in current repo\".to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 617,
          "content": "            fix_hint: Some(\"Run 'whogitit init' in this repository\".to_string()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 618,
          "content": "        })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 619,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 620,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 621,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 622,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 623,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 624,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 625,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 626,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 627,
          "content": "    fn test_has_whogitit_hooks_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 628,
          "content": "        let settings = json!({});",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 629,
          "content": "        assert!(!has_whogitit_hooks(&settings));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 630,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 631,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 632,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 633,
          "content": "    fn test_has_whogitit_hooks_other_hooks() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 634,
          "content": "        let settings = json!({",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 635,
          "content": "            \"hooks\": {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 636,
          "content": "                \"PreToolUse\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 637,
          "content": "                    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 638,
          "content": "                        \"matcher\": \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 639,
          "content": "                        \"hooks\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 640,
          "content": "                            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 641,
          "content": "                                \"type\": \"command\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 642,
          "content": "                                \"command\": \"some-other-hook\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 643,
          "content": "                            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 644,
          "content": "                        ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 645,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 646,
          "content": "                ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 647,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 648,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 649,
          "content": "        assert!(!has_whogitit_hooks(&settings));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 650,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 651,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 652,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 653,
          "content": "    fn test_has_whogitit_hooks_configured() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 654,
          "content": "        let settings = json!({",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 655,
          "content": "            \"hooks\": {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 656,
          "content": "                \"PreToolUse\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 657,
          "content": "                    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 658,
          "content": "                        \"matcher\": \"Edit|Write|Bash\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 659,
          "content": "                        \"hooks\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 660,
          "content": "                            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 661,
          "content": "                                \"type\": \"command\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 662,
          "content": "                                \"command\": \"WHOGITIT_HOOK_PHASE=pre ~/.claude/hooks/whogitit-capture.sh\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 663,
          "content": "                            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 664,
          "content": "                        ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 665,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 666,
          "content": "                ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 667,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 668,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 669,
          "content": "        assert!(has_whogitit_hooks(&settings));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 670,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 671,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 672,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 673,
          "content": "    fn test_merge_hooks_empty_settings() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 674,
          "content": "        let settings = json!({});",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 675,
          "content": "        let merged = merge_hooks_into_settings(settings);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 676,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 677,
          "content": "        assert!(merged.get(\"hooks\").is_some());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 678,
          "content": "        assert!(merged[\"hooks\"].get(\"PreToolUse\").is_some());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 679,
          "content": "        assert!(merged[\"hooks\"].get(\"PostToolUse\").is_some());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 680,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 681,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 682,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 683,
          "content": "    fn test_merge_hooks_preserves_existing() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 684,
          "content": "        let settings = json!({",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 685,
          "content": "            \"other_setting\": \"value\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 686,
          "content": "            \"hooks\": {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 687,
          "content": "                \"PreToolUse\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 688,
          "content": "                    {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 689,
          "content": "                        \"matcher\": \"Read\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 690,
          "content": "                        \"hooks\": [",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 691,
          "content": "                            {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 692,
          "content": "                                \"type\": \"command\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 693,
          "content": "                                \"command\": \"existing-hook\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 694,
          "content": "                            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 695,
          "content": "                        ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 696,
          "content": "                    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 697,
          "content": "                ]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 698,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 699,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 700,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 701,
          "content": "        let merged = merge_hooks_into_settings(settings);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 702,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 703,
          "content": "        // Original setting preserved",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 704,
          "content": "        assert_eq!(merged[\"other_setting\"], \"value\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 705,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 706,
          "content": "        // Existing hook preserved",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 707,
          "content": "        let pre_hooks = merged[\"hooks\"][\"PreToolUse\"].as_array().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 708,
          "content": "        assert!(pre_hooks.len() >= 2); // Original + new",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 709,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 710,
          "content": "        // Has both old and new hooks",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 711,
          "content": "        let has_existing = pre_hooks",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 712,
          "content": "            .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 713,
          "content": "            .any(|h| h[\"hooks\"][0][\"command\"].as_str() == Some(\"existing-hook\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 714,
          "content": "        let has_whogitit = pre_hooks.iter().any(|h| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 715,
          "content": "            h[\"hooks\"][0][\"command\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 716,
          "content": "                .as_str()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 717,
          "content": "                .unwrap_or(\"\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 718,
          "content": "                .contains(\"whogitit\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 719,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 720,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 721,
          "content": "        assert!(has_existing, \"Should preserve existing hook\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 722,
          "content": "        assert!(has_whogitit, \"Should add whogitit hook\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 723,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 724,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 725,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 726,
          "content": "    fn test_hook_configuration_structure() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 727,
          "content": "        let config = hook_configuration();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 728,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 729,
          "content": "        // Check PreToolUse structure",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 730,
          "content": "        let pre = &config[\"PreToolUse\"][0];",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 731,
          "content": "        assert_eq!(pre[\"matcher\"], \"Edit|Write|Bash\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 732,
          "content": "        assert!(pre[\"hooks\"][0][\"command\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 733,
          "content": "            .as_str()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 734,
          "content": "            .unwrap()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 735,
          "content": "            .contains(\"WHOGITIT_HOOK_PHASE=pre\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 736,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 737,
          "content": "        // Check PostToolUse structure",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 738,
          "content": "        let post = &config[\"PostToolUse\"][0];",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 739,
          "content": "        assert_eq!(post[\"matcher\"], \"Edit|Write|Bash\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 740,
          "content": "        assert!(post[\"hooks\"][0][\"command\"]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 741,
          "content": "            .as_str()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 742,
          "content": "            .unwrap()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 743,
          "content": "            .contains(\"WHOGITIT_HOOK_PHASE=post\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 744,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 745,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 745,
        "ai_lines": 70,
        "ai_modified_lines": 2,
        "human_lines": 2,
        "original_lines": 671,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/capture/pending.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "use std::collections::HashMap;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "use std::fs::{self, File};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "use std::io::Write;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "use std::path::{Path, PathBuf};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "use std::os::unix::fs::PermissionsExt;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "use std::os::unix::io::AsRawFd;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "extern crate libc;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "use chrono::{DateTime, Duration, Utc};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "use serde::{Deserialize, Serialize};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "use uuid::Uuid;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "use crate::capture::snapshot::{AIEdit, EditContext, FileEditHistory};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "use crate::core::attribution::ModelInfo;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "use crate::privacy::redaction::{RedactionEvent, Redactor};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "/// Pending change buffer filename (v2 format with full snapshots)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "const PENDING_FILE: &str = \".whogitit-pending.json\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "/// Default maximum age in hours before a pending buffer is considered stale",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "/// This can be overridden via config (analysis.max_pending_age_hours)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "pub const DEFAULT_MAX_PENDING_AGE_HOURS: i64 = 24;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "/// Session metadata for the current AI session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "pub struct SessionInfo {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    /// Unique session identifier (UUID)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "    pub session_id: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "    /// Model information",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "    pub model: ModelInfo,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "    /// When the session started (ISO 8601)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    pub started_at: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "    /// Total number of prompts in this session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "    pub prompt_count: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    /// List of all prompts in order (for reference)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    pub prompts: Vec<PromptRecord>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "/// Record of a prompt in the session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "pub struct PromptRecord {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    /// Prompt index",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "    pub index: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    /// The prompt text (potentially redacted)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    pub text: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "    /// Timestamp when prompt was processed",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "    pub timestamp: String,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "    /// Files affected by this prompt",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "    pub affected_files: Vec<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    /// Redaction audit events (if audit logging enabled)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    #[serde(default, skip_serializing_if = \"Vec::is_empty\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "    pub redaction_events: Vec<RedactionEvent>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "/// Buffer of pending changes with full content snapshots (v3)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "/// This version stores complete file histories to enable accurate",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "/// three-way diff analysis at commit time, plus redaction audit trail.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "#[derive(Debug, Clone, Serialize, Deserialize)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "pub struct PendingBuffer {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "    /// Schema version (3 = with redaction audit)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "    pub version: u8,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    /// Session information",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "    pub session: SessionInfo,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    /// Per-file edit histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    pub file_histories: HashMap<String, FileEditHistory>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "    /// Current prompt index counter",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    pub prompt_counter: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "    /// Whether redaction audit logging is enabled for this session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "    pub audit_logging_enabled: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "    /// Total redaction count across all prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "    #[serde(default)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "    pub total_redactions: u32,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "impl PendingBuffer {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "    /// Create a new pending buffer for a session",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "    pub fn new(session_id: &str, model_id: &str) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "        Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "            version: 3,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "            session: SessionInfo {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "                session_id: session_id.to_string(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "                model: ModelInfo::claude(model_id),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "                started_at: Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "                prompt_count: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "                prompts: Vec::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "            },",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "            file_histories: HashMap::new(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "            prompt_counter: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "            audit_logging_enabled: false,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "            total_redactions: 0,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    /// Create a new pending buffer with audit logging enabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    pub fn new_with_audit(session_id: &str, model_id: &str) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "        let mut buffer = Self::new(session_id, model_id);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "        buffer.audit_logging_enabled = true;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "        buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "    /// Create with a new random session ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "    pub fn new_session(model_id: &str) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "        let session_id = Uuid::new_v4().to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "        Self::new(&session_id, model_id)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "    /// Record an AI edit with full content snapshots",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "    ///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "    /// This stores:",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "    /// - The original file content (if first edit to this file)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "    /// - The content before this specific edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "    /// - The content after this edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "    /// - The prompt that triggered the edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "    /// - Redaction audit events (if audit logging enabled)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "    pub fn record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "        &mut self,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        path: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "        old_content: Option<&str>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "        new_content: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "        tool: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "        prompt: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "        redactor: Option<&Redactor>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "    ) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "        // Redact prompt if redactor provided, with audit if enabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "        let (redacted_prompt, redaction_events) = match redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "            Some(r) if self.audit_logging_enabled => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "                let result = r.redact_with_audit(prompt);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "                self.total_redactions += result.redaction_count as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "                (result.text, result.events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "            Some(r) => (r.redact(prompt), Vec::new()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "            None => (prompt.to_string(), Vec::new()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "        let prompt_index = self.prompt_counter;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        self.prompt_counter += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "        self.session.prompt_count = self.prompt_counter;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "        // Record the prompt with optional redaction events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "        self.session.prompts.push(PromptRecord {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "            index: prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "            text: redacted_prompt.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "            timestamp: Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "            affected_files: vec![path.to_string()],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "            redaction_events,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "        // Get or create file history",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "        let history = self",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "            .file_histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "            .entry(path.to_string())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "            .or_insert_with(|| FileEditHistory::new(path, old_content));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "        // Determine before content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "        let before_content = if history.edits.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "            // First edit - use original or provided old_content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "            old_content.unwrap_or(\"\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "            // Subsequent edit - use the after content from last edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "            &history.latest_ai_content().content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "        // Create the edit record",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "        let edit = AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "            &redacted_prompt,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "            prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "            tool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "            before_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "            new_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "        history.add_edit(edit);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "    /// Record an AI edit with context (plan mode, subagent, etc.)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "    #[allow(clippy::too_many_arguments)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "    pub fn record_edit_with_context(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "        &mut self,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "        path: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "        old_content: Option<&str>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "        new_content: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "        tool: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "        prompt: &str,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "        redactor: Option<&Redactor>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "        context: Option<EditContext>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "    ) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "        // Redact prompt if redactor provided, with audit if enabled",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "        let (redacted_prompt, redaction_events) = match redactor {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "            Some(r) if self.audit_logging_enabled => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "                let result = r.redact_with_audit(prompt);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "                self.total_redactions += result.redaction_count as u32;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "                (result.text, result.events)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "            Some(r) => (r.redact(prompt), Vec::new()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "            None => (prompt.to_string(), Vec::new()),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "        let prompt_index = self.prompt_counter;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "        self.prompt_counter += 1;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "        self.session.prompt_count = self.prompt_counter;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "        // Record the prompt with optional redaction events",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "        self.session.prompts.push(PromptRecord {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "            index: prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "            text: redacted_prompt.clone(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "            timestamp: Utc::now().to_rfc3339(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "            affected_files: vec![path.to_string()],",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "            redaction_events,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "        });",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "        // Get or create file history",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "        let history = self",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "            .file_histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "            .entry(path.to_string())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "            .or_insert_with(|| FileEditHistory::new(path, old_content));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "        // Determine before content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "        let before_content = if history.edits.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "            old_content.unwrap_or(\"\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "            &history.latest_ai_content().content",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "        // Create the edit record with context",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "        let edit = match context {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "            Some(ctx) => AIEdit::with_context(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "                &redacted_prompt,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "                prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "                tool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "                before_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "                new_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "                ctx,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "            ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "            None => AIEdit::new(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "                &redacted_prompt,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "                prompt_index,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "                tool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "                before_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "                new_content,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "            ),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "        };",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "        history.add_edit(edit);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "    /// Get file history for a path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "    pub fn get_file_history(&self, path: &str) -> Option<&FileEditHistory> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "        self.file_histories.get(path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "    /// Get all file paths with pending changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "    pub fn files(&self) -> Vec<&str> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "        self.file_histories.keys().map(|s| s.as_str()).collect()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "    /// Check if there are pending changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "    pub fn has_changes(&self) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "        !self.file_histories.is_empty()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "    /// Get total number of AI edits across all files",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "    pub fn total_edits(&self) -> usize {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "        self.file_histories.values().map(|h| h.edits.len()).sum()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "    /// Get total number of files with changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "    pub fn file_count(&self) -> usize {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "        self.file_histories.len()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "    /// Estimate total AI-generated lines (rough count)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "    pub fn total_lines(&self) -> u32 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "        self.file_histories",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "            .values()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "            .map(|h| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "                h.edits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "                    .iter()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "                    .map(|e| {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "                        // Count lines added in each edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "                        let before_lines = e.before.line_count;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "                        let after_lines = e.after.line_count;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "                        after_lines.saturating_sub(before_lines) as u32",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "                    })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "                    .sum::<u32>()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "            })",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "            .sum()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "    /// Clear all pending changes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "    pub fn clear(&mut self) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "        self.file_histories.clear();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "        self.session.prompts.clear();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "    /// Get a prompt by index",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "    pub fn get_prompt(&self, index: u32) -> Option<&PromptRecord> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "        self.session.prompts.iter().find(|p| p.index == index)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "    /// Check if this buffer is stale (older than specified hours)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "    pub fn is_stale(&self) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "        self.is_stale_hours(DEFAULT_MAX_PENDING_AGE_HOURS)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "    /// Check if this buffer is stale with a custom hour threshold",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "    pub fn is_stale_hours(&self, max_hours: i64) -> bool {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "        if let Ok(started) = DateTime::parse_from_rfc3339(&self.session.started_at) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "            let age = Utc::now().signed_duration_since(started);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "            age > Duration::hours(max_hours)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "            // If we can't parse the timestamp, consider it stale",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "            true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "    /// Get the age of this buffer in human-readable format",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "    pub fn age_string(&self) -> String {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "        if let Ok(started) = DateTime::parse_from_rfc3339(&self.session.started_at) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "            let age = Utc::now().signed_duration_since(started);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "            if age.num_hours() > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "                format!(\"{} hours ago\", age.num_hours())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "            } else if age.num_minutes() > 0 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "                format!(\"{} minutes ago\", age.num_minutes())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "            } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "                \"just now\".to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "            \"unknown\".to_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "    /// Validate buffer integrity",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "    pub fn validate(&self) -> Result<(), String> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "        // Check version (accept v2 for backwards compatibility, v3 for new features)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "        if self.version != 2 && self.version != 3 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "            return Err(format!(\"Unsupported buffer version: {}\", self.version));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "        // Check session ID is valid UUID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "        if Uuid::parse_str(&self.session.session_id).is_err() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "            return Err(\"Invalid session ID format\".to_string());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "        // Check prompt count matches prompts",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "        if self.session.prompt_count != self.session.prompts.len() as u32 {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "            return Err(format!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "                \"Prompt count mismatch: {} vs {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "                self.session.prompt_count,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "                self.session.prompts.len()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "            ));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "        // Check each file history has at least one edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "        for (path, history) in &self.file_histories {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "            if history.edits.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "                return Err(format!(\"File '{}' has no edits\", path));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "/// Lock file name for concurrent access protection",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "const LOCK_FILE: &str = \".whogitit-pending.lock\";",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "/// Acquire an exclusive file lock (Unix only)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "/// Returns a guard that releases the lock when dropped",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "fn acquire_lock(lock_path: &Path) -> Result<File> {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 380,
          "content": "    use std::io::ErrorKind;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 381,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 382,
          "content": "    // Create or open lock file",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 383,
          "content": "    let lock_file = File::create(lock_path).context(\"Failed to create lock file\")?;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 384,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 385,
          "content": "    // Try to acquire exclusive lock with timeout",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 386,
          "content": "    // Use non-blocking first to detect contention",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 387,
          "content": "    let fd = lock_file.as_raw_fd();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 388,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 389,
          "content": "    // First try non-blocking",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 390,
          "content": "    let result = unsafe { libc::flock(fd, libc::LOCK_EX | libc::LOCK_NB) };",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 391,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 392,
          "content": "    if result != 0 {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 393,
          "content": "        let err = std::io::Error::last_os_error();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 394,
          "content": "        if err.kind() == ErrorKind::WouldBlock {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 395,
          "content": "            eprintln!(",
          "source": {
            "type": "AIModified",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
            "similarity": 1.0
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 396,
          "content": "                \"whogitit: Warning - another process is accessing the pending buffer, waiting...\"",
          "source": {
            "type": "AIModified",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
            "similarity": 0.8709677419354839
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 0.8709677419354839
        },
        {
          "line_number": 397,
          "content": "            );",
          "source": {
            "type": "AIModified",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
            "similarity": 1.0
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 398,
          "content": "            // Now do a blocking lock",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 399,
          "content": "            let result = unsafe { libc::flock(fd, libc::LOCK_EX) };",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 400,
          "content": "            if result != 0 {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 401,
          "content": "                return Err(std::io::Error::last_os_error())",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 402,
          "content": "                    .context(\"Failed to acquire lock on pending buffer\");",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 403,
          "content": "            }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 404,
          "content": "        } else {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 405,
          "content": "            return Err(err).context(\"Failed to acquire lock on pending buffer\");",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 406,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 407,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 408,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 409,
          "content": "    Ok(lock_file)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 410,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 411,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 412,
          "content": "/// No-op lock acquisition for non-Unix platforms",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 413,
          "content": "#[cfg(not(unix))]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 414,
          "content": "fn acquire_lock(_lock_path: &Path) -> Result<File> {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 415,
          "content": "    // On non-Unix platforms, create a marker file but don't actually lock",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 416,
          "content": "    // This provides some protection via file existence check",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 417,
          "content": "    File::create(_lock_path).context(\"Failed to create lock file\")",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 418,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 419,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 420,
          "content": "/// Release a file lock",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 421,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 422,
          "content": "fn release_lock(lock_file: &File) {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 423,
          "content": "    let fd = lock_file.as_raw_fd();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 424,
          "content": "    unsafe {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 425,
          "content": "        libc::flock(fd, libc::LOCK_UN);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 426,
          "content": "    }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 427,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 428,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 429,
          "content": "/// No-op lock release for non-Unix platforms",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 430,
          "content": "#[cfg(not(unix))]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 431,
          "content": "fn release_lock(_lock_file: &File) {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 432,
          "content": "    // No-op on non-Unix",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 433,
          "content": "}",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 434,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 435,
          "content": "/// Manager for persisting pending buffer to disk",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 436,
          "content": "pub struct PendingStore {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 437,
          "content": "    /// Path to the pending file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 438,
          "content": "    file_path: PathBuf,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 439,
          "content": "    /// Path to the repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 440,
          "content": "    repo_root: PathBuf,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 441,
          "content": "    /// Path to the lock file",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 442,
          "content": "    lock_path: PathBuf,",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 443,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 444,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 445,
          "content": "impl PendingStore {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 446,
          "content": "    /// Create a store for the given repo root",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 447,
          "content": "    pub fn new(repo_root: &Path) -> Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 448,
          "content": "        Self {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 449,
          "content": "            file_path: repo_root.join(PENDING_FILE),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 450,
          "content": "            repo_root: repo_root.to_path_buf(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 451,
          "content": "            lock_path: repo_root.join(LOCK_FILE),",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 452,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 453,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 454,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 455,
          "content": "    /// Load pending buffer from disk, with stale detection",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 456,
          "content": "    pub fn load(&self) -> Result<Option<PendingBuffer>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 457,
          "content": "        if !self.file_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 458,
          "content": "            return Ok(None);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 459,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 460,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 461,
          "content": "        // Acquire lock for concurrent access protection",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 462,
          "content": "        let lock_file = acquire_lock(&self.lock_path)?;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 463,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 464,
          "content": "        let content =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 465,
          "content": "            fs::read_to_string(&self.file_path).context(\"Failed to read pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 466,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 467,
          "content": "        // Release lock before returning",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 468,
          "content": "        release_lock(&lock_file);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 469,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 470,
          "content": "        // Try to parse as v2 format",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 471,
          "content": "        match serde_json::from_str::<PendingBuffer>(&content) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 472,
          "content": "            Ok(buffer) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 473,
          "content": "                // Validate buffer integrity",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 474,
          "content": "                if let Err(e) = buffer.validate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 475,
          "content": "                    eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 476,
          "content": "                        \"whogitit: Warning - pending buffer validation failed: {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 477,
          "content": "                        e",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 478,
          "content": "                    );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 479,
          "content": "                    eprintln!(\"whogitit: The pending buffer may be corrupted. Run 'whogitit clear' to reset.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 480,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 481,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 482,
          "content": "                // Warn if buffer is stale",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 483,
          "content": "                if buffer.is_stale() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 484,
          "content": "                    eprintln!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 485,
          "content": "                        \"whogitit: Warning - pending buffer is stale (started {})\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 486,
          "content": "                        buffer.age_string()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 487,
          "content": "                    );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 488,
          "content": "                    eprintln!(\"whogitit: Consider running 'whogitit clear' if these changes are no longer relevant.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 489,
          "content": "                }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 490,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 491,
          "content": "                Ok(Some(buffer))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 492,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 493,
          "content": "            Err(e) => {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 494,
          "content": "                eprintln!(\"whogitit: Warning - failed to parse pending buffer: {}\", e);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 495,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 496,
          "content": "                // Create a backup of the corrupted file for recovery",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 497,
          "content": "                let backup_name = format!(",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 498,
          "content": "                    \".whogitit-pending.corrupted.{}\",",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 499,
          "content": "                    chrono::Utc::now().format(\"%Y%m%d-%H%M%S\")",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 500,
          "content": "                );",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 501,
          "content": "                let backup_path = self.repo_root.join(&backup_name);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 502,
          "content": "                if let Err(backup_err) = fs::copy(&self.file_path, &backup_path) {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 503,
          "content": "                    eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 504,
          "content": "                        \"whogitit: Warning - failed to backup corrupted file: {}\",",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 505,
          "content": "                        backup_err",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 506,
          "content": "                    );",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 507,
          "content": "                } else {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 508,
          "content": "                    eprintln!(",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 509,
          "content": "                        \"whogitit: Corrupted file backed up to: {}\",",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 510,
          "content": "                        backup_path.display()",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 511,
          "content": "                    );",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 512,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 513,
          "content": "                    // Set restrictive permissions on backup",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 514,
          "content": "                    #[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 515,
          "content": "                    {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 516,
          "content": "                        if let Ok(metadata) = fs::metadata(&backup_path) {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 517,
          "content": "                            let mut perms = metadata.permissions();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 518,
          "content": "                            perms.set_mode(0o600);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 519,
          "content": "                            let _ = fs::set_permissions(&backup_path, perms);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 520,
          "content": "                        }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 521,
          "content": "                    }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 522,
          "content": "                }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 523,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 524,
          "content": "                eprintln!(\"whogitit: Run 'whogitit clear' to reset and start fresh.\");",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 525,
          "content": "                // Return None to allow fresh start",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 526,
          "content": "                Ok(None)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 527,
          "content": "            }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 528,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 529,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 530,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 531,
          "content": "    /// Load buffer without warnings (for status checks)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 532,
          "content": "    pub fn load_quiet(&self) -> Result<Option<PendingBuffer>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 533,
          "content": "        if !self.file_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 534,
          "content": "            return Ok(None);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 535,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 536,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 537,
          "content": "        let content =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 538,
          "content": "            fs::read_to_string(&self.file_path).context(\"Failed to read pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 539,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 540,
          "content": "        match serde_json::from_str::<PendingBuffer>(&content) {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 541,
          "content": "            Ok(buffer) => Ok(Some(buffer)),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 542,
          "content": "            Err(_) => Ok(None),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 543,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 544,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 545,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 546,
          "content": "    /// Save pending buffer to disk atomically",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 547,
          "content": "    ///",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 548,
          "content": "    /// Uses write-to-temp-then-rename pattern to prevent corruption",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 549,
          "content": "    /// if the process is interrupted during write.",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 550,
          "content": "    /// Also uses file locking for concurrent access protection.",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 551,
          "content": "    pub fn save(&self, buffer: &PendingBuffer) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 552,
          "content": "        // Validate before saving",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 553,
          "content": "        if let Err(e) = buffer.validate() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 554,
          "content": "            anyhow::bail!(\"Cannot save invalid buffer: {}\", e);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 555,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 556,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 557,
          "content": "        // Acquire lock for concurrent access protection",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 558,
          "content": "        let lock_file = acquire_lock(&self.lock_path)?;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 559,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 560,
          "content": "        let content =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 561,
          "content": "            serde_json::to_string_pretty(buffer).context(\"Failed to serialize pending buffer\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 562,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 563,
          "content": "        // Write to temporary file first",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 564,
          "content": "        let temp_path = self.repo_root.join(\".whogitit-pending.tmp\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 565,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 566,
          "content": "        let mut temp_file =",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 567,
          "content": "            File::create(&temp_path).context(\"Failed to create temporary pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 568,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 569,
          "content": "        temp_file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 570,
          "content": "            .write_all(content.as_bytes())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 571,
          "content": "            .context(\"Failed to write to temporary pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 572,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 573,
          "content": "        temp_file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 574,
          "content": "            .sync_all()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 575,
          "content": "            .context(\"Failed to sync temporary pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 576,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 577,
          "content": "        drop(temp_file);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 578,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 579,
          "content": "        // Atomically rename temp file to final path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 580,
          "content": "        fs::rename(&temp_path, &self.file_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 581,
          "content": "            .context(\"Failed to rename temporary pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 582,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 583,
          "content": "        // Set restrictive permissions (0600) - pending buffer contains sensitive data",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 584,
          "content": "        #[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 585,
          "content": "        {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 586,
          "content": "            let mut perms = fs::metadata(&self.file_path)?.permissions();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 587,
          "content": "            perms.set_mode(0o600);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 588,
          "content": "            fs::set_permissions(&self.file_path, perms)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 589,
          "content": "                .context(\"Failed to set permissions on pending buffer file\")?;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 590,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 591,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 592,
          "content": "        // Release lock",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 593,
          "content": "        release_lock(&lock_file);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 594,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 595,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 596,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 597,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 598,
          "content": "    /// Delete the pending buffer file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 599,
          "content": "    pub fn delete(&self) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 600,
          "content": "        // Also clean up any leftover temp file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 601,
          "content": "        let temp_path = self.repo_root.join(\".whogitit-pending.tmp\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 602,
          "content": "        if temp_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 603,
          "content": "            let _ = fs::remove_file(&temp_path);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 604,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 605,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 606,
          "content": "        if self.file_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 607,
          "content": "            fs::remove_file(&self.file_path).context(\"Failed to delete pending buffer file\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 608,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 609,
          "content": "        Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 610,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 611,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 612,
          "content": "    /// Check if pending file exists",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 613,
          "content": "    pub fn exists(&self) -> bool {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 614,
          "content": "        self.file_path.exists()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 615,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 616,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 617,
          "content": "    /// Get the file path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 618,
          "content": "    pub fn path(&self) -> &Path {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 619,
          "content": "        &self.file_path",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 620,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 621,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 622,
          "content": "    /// Create a backup of the current pending buffer",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 623,
          "content": "    pub fn backup(&self) -> Result<Option<PathBuf>> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 624,
          "content": "        if !self.file_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 625,
          "content": "            return Ok(None);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 626,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 627,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 628,
          "content": "        let backup_name = format!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 629,
          "content": "            \".whogitit-pending.backup.{}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 630,
          "content": "            Utc::now().format(\"%Y%m%d-%H%M%S\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 631,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 632,
          "content": "        let backup_path = self.repo_root.join(backup_name);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 633,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 634,
          "content": "        fs::copy(&self.file_path, &backup_path)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 635,
          "content": "            .context(\"Failed to create backup of pending buffer\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 636,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 637,
          "content": "        // Set restrictive permissions (0600) on backup - contains sensitive data",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 638,
          "content": "        #[cfg(unix)]",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 639,
          "content": "        {",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 640,
          "content": "            let mut perms = fs::metadata(&backup_path)?.permissions();",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 641,
          "content": "            perms.set_mode(0o600);",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 642,
          "content": "            fs::set_permissions(&backup_path, perms)",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 643,
          "content": "                .context(\"Failed to set permissions on backup file\")?;",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 644,
          "content": "        }",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 645,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa"
          },
          "edit_id": "ac5699eb-2dad-4cb5-894d-b58dd19ae5aa",
          "prompt_index": 46,
          "confidence": 1.0
        },
        {
          "line_number": 646,
          "content": "        Ok(Some(backup_path))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 647,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 648,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 649,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 650,
          "content": "#[cfg(test)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 651,
          "content": "mod tests {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 652,
          "content": "    use super::*;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 653,
          "content": "    use tempfile::TempDir;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 654,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 655,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 656,
          "content": "    fn test_record_edit_new_file() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 657,
          "content": "        let mut buffer = PendingBuffer::new(\"test-session\", \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 658,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 659,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 660,
          "content": "            \"src/new.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 661,
          "content": "            None, // New file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 662,
          "content": "            \"fn new_function() {}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 663,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 664,
          "content": "            \"Create new file\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 665,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 666,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 667,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 668,
          "content": "        assert!(buffer.has_changes());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 669,
          "content": "        assert_eq!(buffer.file_count(), 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 670,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 671,
          "content": "        let history = buffer.get_file_history(\"src/new.rs\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 672,
          "content": "        assert!(history.was_new_file);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 673,
          "content": "        assert_eq!(history.edits.len(), 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 674,
          "content": "        assert_eq!(history.edits[0].prompt, \"Create new file\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 675,
          "content": "        assert_eq!(history.edits[0].after.content, \"fn new_function() {}\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 676,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 677,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 678,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 679,
          "content": "    fn test_record_edit_existing_file() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 680,
          "content": "        let mut buffer = PendingBuffer::new(\"test-session\", \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 681,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 682,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 683,
          "content": "            \"src/main.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 684,
          "content": "            Some(\"fn main() {}\\n\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 685,
          "content": "            \"fn main() {\\n    println!(\\\"Hello\\\");\\n}\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 686,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 687,
          "content": "            \"Add println statement\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 688,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 689,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 690,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 691,
          "content": "        let history = buffer.get_file_history(\"src/main.rs\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 692,
          "content": "        assert!(!history.was_new_file);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 693,
          "content": "        assert_eq!(history.original.content, \"fn main() {}\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 694,
          "content": "        assert_eq!(history.edits[0].before.content, \"fn main() {}\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 695,
          "content": "        assert!(history.edits[0].after.content.contains(\"println\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 696,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 697,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 698,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 699,
          "content": "    fn test_multiple_edits_same_file() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 700,
          "content": "        let mut buffer = PendingBuffer::new(\"test-session\", \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 701,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 702,
          "content": "        // First edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 703,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 704,
          "content": "            \"test.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 705,
          "content": "            Some(\"line1\\n\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 706,
          "content": "            \"line1\\nline2\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 707,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 708,
          "content": "            \"Add line2\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 709,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 710,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 711,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 712,
          "content": "        // Second edit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 713,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 714,
          "content": "            \"test.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 715,
          "content": "            None, // Not needed for subsequent edits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 716,
          "content": "            \"line1\\nline2\\nline3\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 717,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 718,
          "content": "            \"Add line3\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 719,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 720,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 721,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 722,
          "content": "        let history = buffer.get_file_history(\"test.rs\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 723,
          "content": "        assert_eq!(history.edits.len(), 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 724,
          "content": "        assert_eq!(history.original.content, \"line1\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 725,
          "content": "        assert_eq!(history.edits[0].prompt_index, 0);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 726,
          "content": "        assert_eq!(history.edits[1].prompt_index, 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 727,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 728,
          "content": "        // Second edit's before should be first edit's after",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 729,
          "content": "        assert_eq!(history.edits[1].before.content, \"line1\\nline2\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 730,
          "content": "        assert_eq!(history.edits[1].after.content, \"line1\\nline2\\nline3\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 731,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 732,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 733,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 734,
          "content": "    fn test_prompt_tracking() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 735,
          "content": "        let mut buffer = PendingBuffer::new(\"test-session\", \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 736,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 737,
          "content": "        buffer.record_edit(\"a.rs\", None, \"a\\n\", \"Write\", \"prompt 1\", None);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 738,
          "content": "        buffer.record_edit(\"b.rs\", None, \"b\\n\", \"Write\", \"prompt 2\", None);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 739,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 740,
          "content": "        assert_eq!(buffer.session.prompt_count, 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 741,
          "content": "        assert_eq!(buffer.session.prompts.len(), 2);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 742,
          "content": "        assert_eq!(buffer.session.prompts[0].text, \"prompt 1\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 743,
          "content": "        assert_eq!(buffer.session.prompts[1].text, \"prompt 2\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 744,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 745,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 746,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 747,
          "content": "    fn test_store_roundtrip() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 748,
          "content": "        let dir = TempDir::new().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 749,
          "content": "        let store = PendingStore::new(dir.path());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 750,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 751,
          "content": "        // Use a valid UUID for session ID",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 752,
          "content": "        let session_id = Uuid::new_v4().to_string();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 753,
          "content": "        let mut buffer = PendingBuffer::new(&session_id, \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 754,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 755,
          "content": "            \"test.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 756,
          "content": "            Some(\"before\\n\"),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 757,
          "content": "            \"after\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 758,
          "content": "            \"Edit\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 759,
          "content": "            \"test prompt\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 760,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 761,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 762,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 763,
          "content": "        store.save(&buffer).unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 764,
          "content": "        assert!(store.exists());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 765,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 766,
          "content": "        let loaded = store.load_quiet().unwrap().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 767,
          "content": "        assert_eq!(loaded.session.session_id, session_id);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 768,
          "content": "        assert_eq!(loaded.file_count(), 1);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 769,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 770,
          "content": "        let history = loaded.get_file_history(\"test.rs\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 771,
          "content": "        assert_eq!(history.original.content, \"before\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 772,
          "content": "        assert_eq!(history.edits[0].after.content, \"after\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 773,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 774,
          "content": "        store.delete().unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 775,
          "content": "        assert!(!store.exists());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 776,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 777,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 778,
          "content": "    #[test]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 779,
          "content": "    fn test_redaction() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 780,
          "content": "        use crate::privacy::Redactor;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 781,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 782,
          "content": "        let mut buffer = PendingBuffer::new(\"test-session\", \"claude-opus-4-5-20251101\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 783,
          "content": "        let redactor = Redactor::default_patterns();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 784,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 785,
          "content": "        buffer.record_edit(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 786,
          "content": "            \"config.rs\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 787,
          "content": "            None,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 788,
          "content": "            \"api_key = \\\"secret\\\"\\n\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 789,
          "content": "            \"Write\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 790,
          "content": "            \"Set api_key = sk-12345 for auth\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 791,
          "content": "            Some(&redactor),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 792,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 793,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 794,
          "content": "        let history = buffer.get_file_history(\"config.rs\").unwrap();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 795,
          "content": "        assert!(!history.edits[0].prompt.contains(\"sk-12345\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 796,
          "content": "        assert!(history.edits[0].prompt.contains(\"[REDACTED]\"));",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 797,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 798,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 798,
        "ai_lines": 143,
        "ai_modified_lines": 3,
        "human_lines": 0,
        "original_lines": 652,
        "unknown_lines": 0
      }
    },
    {
      "path": "src/cli/mod.rs",
      "lines": [
        {
          "line_number": 1,
          "content": "pub mod audit;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 2,
          "content": "pub mod blame;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 3,
          "content": "pub mod export;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 4,
          "content": "pub mod output;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 5,
          "content": "pub mod prompt;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 6,
          "content": "pub mod redact;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 7,
          "content": "pub mod retention;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 8,
          "content": "pub mod setup;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 9,
          "content": "pub mod show;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 10,
          "content": "pub mod summary;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 11,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 12,
          "content": "use std::fs;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 13,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 14,
          "content": "use anyhow::{Context, Result};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 15,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 16,
          "content": "use clap::{Parser, Subcommand};",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 17,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 18,
          "content": "use std::os::unix::fs::PermissionsExt;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 19,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 20,
          "content": "use crate::capture::hook;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 21,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 22,
          "content": "/// AI-aware git blame tool for tracking AI-generated code",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 23,
          "content": "#[derive(Debug, Parser)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 24,
          "content": "#[command(name = \"whogitit\")]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 25,
          "content": "#[command(author, version, about, long_about = None)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 26,
          "content": "pub struct Cli {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 27,
          "content": "    #[command(subcommand)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 28,
          "content": "    pub command: Commands,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 29,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 30,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 31,
          "content": "#[derive(Debug, Subcommand)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 32,
          "content": "pub enum Commands {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 33,
          "content": "    /// Show AI attribution for each line of a file",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 34,
          "content": "    Blame(blame::BlameArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 35,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 36,
          "content": "    /// View the prompt that generated specific lines",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 37,
          "content": "    Prompt(prompt::PromptArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 38,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 39,
          "content": "    /// Show AI attribution summary for a commit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 40,
          "content": "    Show(show::ShowArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 41,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 42,
          "content": "    /// Generate summary for a range of commits (useful for PRs)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 43,
          "content": "    Summary(summary::SummaryArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 44,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 45,
          "content": "    /// Test redaction patterns against text or files",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 46,
          "content": "    RedactTest(redact::RedactArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 47,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 48,
          "content": "    /// Export attribution data for multiple commits",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 49,
          "content": "    Export(export::ExportArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 50,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 51,
          "content": "    /// Manage data retention policies",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 52,
          "content": "    Retention(retention::RetentionArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 53,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 54,
          "content": "    /// View the audit log",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 55,
          "content": "    Audit(audit::AuditArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 56,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 57,
          "content": "    /// Capture a file change (called by Claude Code hook)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 58,
          "content": "    Capture(CaptureArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 59,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 60,
          "content": "    /// Finalize attribution after a commit (post-commit hook)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 61,
          "content": "    PostCommit,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 62,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 63,
          "content": "    /// Show pending changes status",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 64,
          "content": "    Status,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 65,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 66,
          "content": "    /// Clear pending changes without committing",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 67,
          "content": "    Clear,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 68,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 69,
          "content": "    /// Initialize whogitit in a git repository (installs post-commit hook)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 70,
          "content": "    Init(InitArgs),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 71,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 72,
          "content": "    /// Set up whogitit globally (install capture hook and configure Claude Code)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 73,
          "content": "    Setup,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 74,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 75,
          "content": "    /// Check whogitit configuration and diagnose issues",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 76,
          "content": "    Doctor,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 77,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 78,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 79,
          "content": "/// Init command arguments",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 80,
          "content": "#[derive(Debug, clap::Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 81,
          "content": "pub struct InitArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 82,
          "content": "    /// Skip global setup check",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 83,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 84,
          "content": "    pub force: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 85,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 86,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 87,
          "content": "/// Capture command arguments",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 88,
          "content": "#[derive(Debug, clap::Args)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 89,
          "content": "pub struct CaptureArgs {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 90,
          "content": "    /// Read hook input from stdin",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 91,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 92,
          "content": "    pub stdin: bool,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 93,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 94,
          "content": "    /// File path (if not using stdin)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 95,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 96,
          "content": "    pub file: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 97,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 98,
          "content": "    /// Tool name",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 99,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 100,
          "content": "    pub tool: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 101,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 102,
          "content": "    /// Prompt text",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 103,
          "content": "    #[arg(long)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 104,
          "content": "    pub prompt: Option<String>,",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 105,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 106,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 107,
          "content": "/// Run the CLI",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 108,
          "content": "pub fn run() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 109,
          "content": "    let cli = Cli::parse();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 110,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 111,
          "content": "    match cli.command {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 112,
          "content": "        Commands::Blame(args) => blame::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 113,
          "content": "        Commands::Prompt(args) => prompt::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 114,
          "content": "        Commands::Show(args) => show::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 115,
          "content": "        Commands::Summary(args) => summary::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 116,
          "content": "        Commands::RedactTest(args) => redact::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 117,
          "content": "        Commands::Export(args) => export::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 118,
          "content": "        Commands::Retention(args) => retention::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 119,
          "content": "        Commands::Audit(args) => audit::run(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 120,
          "content": "        Commands::Capture(args) => run_capture(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 121,
          "content": "        Commands::PostCommit => run_post_commit(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 122,
          "content": "        Commands::Status => run_status(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 123,
          "content": "        Commands::Clear => run_clear(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 124,
          "content": "        Commands::Init(args) => run_init(args),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 125,
          "content": "        Commands::Setup => setup::run_setup(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 126,
          "content": "        Commands::Doctor => setup::run_doctor(),",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 127,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 128,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 129,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 130,
          "content": "fn run_capture(args: CaptureArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 131,
          "content": "    if args.stdin {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 132,
          "content": "        hook::run_capture_hook()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 133,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 134,
          "content": "        anyhow::bail!(\"Capture requires --stdin flag for hook input\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 135,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 136,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 137,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 138,
          "content": "fn run_post_commit() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 139,
          "content": "    hook::run_post_commit_hook()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 140,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 141,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 142,
          "content": "fn run_status() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 143,
          "content": "    let repo = git2::Repository::discover(\".\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 144,
          "content": "    let repo_root = repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 145,
          "content": "        .workdir()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 146,
          "content": "        .ok_or_else(|| anyhow::anyhow!(\"No working directory\"))?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 147,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 148,
          "content": "    let hook_handler = crate::capture::CaptureHook::new(repo_root)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 149,
          "content": "    let status = hook_handler.status()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 150,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 151,
          "content": "    if status.has_pending {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 152,
          "content": "        println!(\"Pending AI attribution:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 153,
          "content": "        println!(",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 154,
          "content": "            \"  Session: {}\",",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 155,
          "content": "            status.session_id.as_deref().unwrap_or(\"unknown\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 156,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 157,
          "content": "        println!(\"  Files: {}\", status.file_count);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 158,
          "content": "        println!(\"  Edits: {}\", status.edit_count);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 159,
          "content": "        println!(\"  Lines: {}\", status.line_count);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 160,
          "content": "        if !status.age.is_empty() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 161,
          "content": "            println!(\"  Age: {}\", status.age);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 162,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 163,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 164,
          "content": "        if status.is_stale {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 165,
          "content": "            println!(\"\\n  Warning: This pending buffer is stale (> 24 hours old).\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 166,
          "content": "            println!(\"   Run 'whogitit clear' if these changes are no longer relevant.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 167,
          "content": "        } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 168,
          "content": "            println!(\"\\nRun 'git commit' to finalize attribution.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 169,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 170,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 171,
          "content": "        println!(\"No pending AI attribution.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 172,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 173,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 174,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 175,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 176,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 177,
          "content": "fn run_clear() -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 178,
          "content": "    let repo = git2::Repository::discover(\".\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 179,
          "content": "    let repo_root = repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 180,
          "content": "        .workdir()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 181,
          "content": "        .ok_or_else(|| anyhow::anyhow!(\"No working directory\"))?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 182,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 183,
          "content": "    let hook_handler = crate::capture::CaptureHook::new(repo_root)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 184,
          "content": "    hook_handler.clear_pending()?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 185,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 186,
          "content": "    println!(\"Cleared pending AI attribution.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 187,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 188,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 189,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 190,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 191,
          "content": "fn run_init(args: InitArgs) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 192,
          "content": "    // Check global setup status first (unless --force is used)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 193,
          "content": "    let status = setup::check_setup_status();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 194,
          "content": "    if !status.is_complete() && !args.force {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 195,
          "content": "        println!(\"Global setup incomplete:\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 196,
          "content": "        if !status.hook_script_installed {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 197,
          "content": "            println!(\"  - Capture hook not installed\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 198,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 199,
          "content": "        if !status.hook_script_executable {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 200,
          "content": "            println!(\"  - Capture hook not executable\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 201,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 202,
          "content": "        if !status.settings_configured {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 203,
          "content": "            println!(\"  - Claude Code hooks not configured\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 204,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 205,
          "content": "        println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 206,
          "content": "        println!(\"Run 'whogitit setup' first to configure Claude Code integration.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 207,
          "content": "        println!(\"Then run 'whogitit init' again to initialize this repository.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 208,
          "content": "        println!();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 209,
          "content": "        println!(\"Or run 'whogitit init --force' to skip this check and proceed anyway.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 210,
          "content": "        return Ok(());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 211,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 212,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 213,
          "content": "    if !status.is_complete() && args.force {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 214,
          "content": "        println!(\"Warning: Global setup is incomplete. Proceeding with --force.\\n\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 215,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 216,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 217,
          "content": "    let repo = git2::Repository::discover(\".\").context(\"Not in a git repository\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 218,
          "content": "    let repo_root = repo",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 219,
          "content": "        .workdir()",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 220,
          "content": "        .ok_or_else(|| anyhow::anyhow!(\"No working directory\"))?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 221,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 222,
          "content": "    let hooks_dir = repo_root.join(\".git/hooks\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 223,
          "content": "    fs::create_dir_all(&hooks_dir).context(\"Failed to create hooks directory\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 224,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 225,
          "content": "    // Install post-commit hook (attaches attribution to commits)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 226,
          "content": "    install_post_commit_hook(&hooks_dir)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 227,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 228,
          "content": "    // Install pre-push hook (auto-pushes notes with regular git push)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 229,
          "content": "    install_pre_push_hook(&hooks_dir)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 230,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 231,
          "content": "    // Configure git to auto-fetch notes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 232,
          "content": "    configure_git_fetch(&repo)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 233,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 234,
          "content": "    println!(\"\\nRepository initialized! AI attribution will be tracked for commits in this repo.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 235,
          "content": "    println!(\"Notes will be automatically pushed with 'git push' and fetched with 'git fetch'.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 236,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 237,
          "content": "    if !status.is_complete() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 238,
          "content": "        println!(\"\\nReminder: Run 'whogitit setup' to complete Claude Code integration.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 239,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 240,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 241,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 242,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 243,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 244,
          "content": "/// Marker comment to identify whogitit hook sections",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 245,
          "content": "const WHOGITIT_MARKER_START: &str = \"# >>> whogitit hook start >>>\";",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 246,
          "content": "const WHOGITIT_MARKER_END: &str = \"# <<< whogitit hook end <<<\";",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 247,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 248,
          "content": "fn install_post_commit_hook(hooks_dir: &std::path::Path) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 249,
          "content": "    let hook_path = hooks_dir.join(\"post-commit\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 250,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 251,
          "content": "    if hook_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 252,
          "content": "        let content = fs::read_to_string(&hook_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 253,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 254,
          "content": "        // Check for marker-based or legacy whogitit hook",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 255,
          "content": "        if content.contains(WHOGITIT_MARKER_START) || content.contains(\"whogitit post-commit\") {",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 256,
          "content": "            println!(\" whogitit post-commit hook already installed.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 257,
          "content": "            return Ok(());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 258,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 259,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 260,
          "content": "        // Append to existing hook with markers for idempotency",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 261,
          "content": "        let whogitit_section = format!(",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 262,
          "content": "            \"\\n\\n{}\\n# whogitit post-commit hook - Attaches AI attribution notes\\nif command -v whogitit &> /dev/null; then\\n    whogitit post-commit 2>/dev/null || true\\nfi\\n{}\\n\",",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 263,
          "content": "            WHOGITIT_MARKER_START,",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 264,
          "content": "            WHOGITIT_MARKER_END",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 265,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 266,
          "content": "        let new_content = format!(\"{}{}\", content.trim_end(), whogitit_section);",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 267,
          "content": "        fs::write(&hook_path, new_content)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 268,
          "content": "        println!(\" Added whogitit to existing post-commit hook.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 269,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 270,
          "content": "        let hook_content = format!(",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 271,
          "content": "            r#\"#!/bin/bash",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 272,
          "content": "{}",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 273,
          "content": "# whogitit post-commit hook",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 274,
          "content": "# Attaches AI attribution notes to the commit",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 275,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 276,
          "content": "if command -v whogitit &> /dev/null; then",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 277,
          "content": "    whogitit post-commit 2>/dev/null || true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 278,
          "content": "elif [[ -x \"$HOME/.cargo/bin/whogitit\" ]]; then",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 279,
          "content": "    \"$HOME/.cargo/bin/whogitit\" post-commit 2>/dev/null || true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 280,
          "content": "fi",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 281,
          "content": "{}",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 282,
          "content": "\"#,",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 283,
          "content": "            WHOGITIT_MARKER_START, WHOGITIT_MARKER_END",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 284,
          "content": "        );",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 285,
          "content": "        fs::write(&hook_path, hook_content)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 286,
          "content": "        make_executable(&hook_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 287,
          "content": "        println!(\" Installed whogitit post-commit hook.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 288,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 289,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 290,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 291,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 292,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 293,
          "content": "fn install_pre_push_hook(hooks_dir: &std::path::Path) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 294,
          "content": "    let hook_path = hooks_dir.join(\"pre-push\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 295,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 296,
          "content": "    if hook_path.exists() {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 297,
          "content": "        let content = fs::read_to_string(&hook_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 298,
          "content": "",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 299,
          "content": "        // Check for marker-based or legacy whogitit hook",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 300,
          "content": "        if content.contains(WHOGITIT_MARKER_START) || content.contains(\"WHOGITIT_PUSHING_NOTES\") {",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 301,
          "content": "            println!(\" whogitit pre-push hook already installed.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 302,
          "content": "            return Ok(());",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 303,
          "content": "        }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 304,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 305,
          "content": "        // Append to existing hook with markers for idempotency",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 306,
          "content": "        let whogitit_section = format!(",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 307,
          "content": "            \"\\n\\n{}\\n# whogitit pre-push hook - automatically push notes\\n# Skip if already pushing notes (prevent recursion)\\n[[ \\\"$WHOGITIT_PUSHING_NOTES\\\" == \\\"1\\\" ]] && exit 0\\nremote=\\\"$1\\\"\\nif git notes --ref=whogitit list &>/dev/null; then\\n    WHOGITIT_PUSHING_NOTES=1 git push \\\"$remote\\\" refs/notes/whogitit 2>/dev/null || true\\nfi\\n{}\\n\",",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 308,
          "content": "            WHOGITIT_MARKER_START,",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 309,
          "content": "            WHOGITIT_MARKER_END",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 310,
          "content": "        );",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 311,
          "content": "        let new_content = format!(\"{}{}\", content.trim_end(), whogitit_section);",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 312,
          "content": "        fs::write(&hook_path, new_content)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 313,
          "content": "        println!(\" Added whogitit to existing pre-push hook.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 314,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 315,
          "content": "        let hook_content = format!(",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 316,
          "content": "            r#\"#!/bin/bash",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 317,
          "content": "{}",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 318,
          "content": "# whogitit pre-push hook",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 319,
          "content": "# Automatically pushes whogitit notes alongside regular pushes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 320,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 321,
          "content": "# Prevent recursion - skip if we're already pushing notes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 322,
          "content": "[[ \"$WHOGITIT_PUSHING_NOTES\" == \"1\" ]] && exit 0",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 323,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 324,
          "content": "remote=\"$1\"",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 325,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 326,
          "content": "# Only push notes if they exist",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 327,
          "content": "if git notes --ref=whogitit list &>/dev/null; then",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 328,
          "content": "    WHOGITIT_PUSHING_NOTES=1 git push \"$remote\" refs/notes/whogitit 2>/dev/null || true",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 329,
          "content": "fi",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 330,
          "content": "{}",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 331,
          "content": "\"#,",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 332,
          "content": "            WHOGITIT_MARKER_START, WHOGITIT_MARKER_END",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 333,
          "content": "        );",
          "source": {
            "type": "AI",
            "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33"
          },
          "edit_id": "3f9472a9-f046-4c20-8b90-28144124fc33",
          "prompt_index": 29,
          "confidence": 1.0
        },
        {
          "line_number": 334,
          "content": "        fs::write(&hook_path, hook_content)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 335,
          "content": "        make_executable(&hook_path)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 336,
          "content": "        println!(\" Installed whogitit pre-push hook.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 337,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 338,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 339,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 340,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 341,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 342,
          "content": "/// Make a file executable (Unix only - no-op on Windows)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 343,
          "content": "#[cfg(unix)]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 344,
          "content": "fn make_executable(path: &std::path::Path) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 345,
          "content": "    let mut perms = fs::metadata(path)?.permissions();",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 346,
          "content": "    perms.set_mode(0o755);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 347,
          "content": "    fs::set_permissions(path, perms)?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 348,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 349,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 350,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 351,
          "content": "/// Make a file executable (no-op on Windows - scripts are executable by default)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 352,
          "content": "#[cfg(not(unix))]",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 353,
          "content": "fn make_executable(_path: &std::path::Path) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 354,
          "content": "    // On Windows, scripts don't need execute permission",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 355,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 356,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 357,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 358,
          "content": "/// Configure git to automatically fetch whogitit notes",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 359,
          "content": "fn configure_git_fetch(repo: &git2::Repository) -> Result<()> {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 360,
          "content": "    let mut config = repo.config().context(\"Failed to open git config\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 361,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 362,
          "content": "    let fetch_refspec = \"+refs/notes/whogitit:refs/notes/whogitit\";",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 363,
          "content": "    let fetch_configured = config",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 364,
          "content": "        .get_string(\"remote.origin.fetch\")",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 365,
          "content": "        .map(|v| v.contains(\"whogitit\"))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 366,
          "content": "        .unwrap_or(false);",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 367,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 368,
          "content": "    if !fetch_configured {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 369,
          "content": "        config",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 370,
          "content": "            .set_multivar(\"remote.origin.fetch\", \"^$\", fetch_refspec)",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 371,
          "content": "            .or_else(|_| config.set_str(\"remote.origin.fetch\", fetch_refspec))",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 372,
          "content": "            .context(\"Failed to configure fetch refspec\")?;",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 373,
          "content": "        println!(\" Configured git to fetch whogitit notes automatically.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 374,
          "content": "    } else {",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 375,
          "content": "        println!(\" Git already configured to fetch whogitit notes.\");",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 376,
          "content": "    }",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 377,
          "content": "",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 378,
          "content": "    Ok(())",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        },
        {
          "line_number": 379,
          "content": "}",
          "source": {
            "type": "Original"
          },
          "edit_id": null,
          "prompt_index": null,
          "confidence": 1.0
        }
      ],
      "summary": {
        "total_lines": 379,
        "ai_lines": 36,
        "ai_modified_lines": 0,
        "human_lines": 0,
        "original_lines": 343,
        "unknown_lines": 0
      }
    }
  ]
}